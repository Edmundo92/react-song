!function(e){var t={};function i(n){if(t[n])return t[n].exports;var s=t[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)i.d(n,s,function(t){return e[t]}.bind(null,s));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=1)}([function(e,t,i){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var n=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},i=0;i<10;i++)t["_"+String.fromCharCode(i)]=i;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach(function(e){n[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var i,r,a=function(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(e),c=1;c<arguments.length;c++){for(var u in i=Object(arguments[c]))s.call(i,u)&&(a[u]=i[u]);if(n){r=n(i);for(var l=0;l<r.length;l++)o.call(i,r[l])&&(a[r[l]]=i[r[l]])}}return a}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.render=t.Midi=t.Track=t.Note=t.Song=void 0;var n=function(e){return e&&e.__esModule?e:{default:e}}(i(2));t.Song="Song",t.Note="Note",t.Track="Track",t.Midi="Midi",t.render=n.default.render;t.default=n.default},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){return e&&e.__esModule?e:{default:e}}(i(3)),s=i(7);var o=(0,n.default)({appendInitialChild:function(e,t){var i=t.type;"notes"===i&&e.addSequence(t.notes),"midi"===i&&e.setMIDI(t.midi)},createInstance:function(e,t,i,n,o){return(0,s.createElement)(e,t,i,o)},createTextInstance:function(e,t,i){return e},finalizeInitialChildren:function(e,t,i){"Song"===t&&window.sequencer.ready(function(){e.render()})},getPublicInstance:function(e){return e},prepareForCommit:function(e){},prepareUpdate:function(e,t,i,n,s){},resetAfterCommit:function(e){},resetTextContent:function(e){},getRootHostContext:function(e){},getChildHostContext:function(){return{}},scheduleAnimationCallback:function(){},scheduleDeferredCallback:function(){},useSyncScheduling:!1,now:Date.now,mutation:{appendChild:function(e,t){},appendChildToContainer:function(e,t){},removeChild:function(e,t){},removeChildFromContainer:function(e,t){},insertBefore:function(e,t,i){},commitUpdate:function(e,t,i,n,s){},commitMount:function(e,t,i,n,s){},commitTextUpdate:function(e,t,i){}},shouldSetTextContent:function(e){return"string"==typeof e.children||"number"==typeof e.children}}),r={},a="function"==typeof WeakMap?new WeakMap:new Map,c={render:function(e,t,i){var n=null==t?r:t,s=a.get(n);return s||(s=o.createContainer(n),a.set(t,s)),o.updateContainer(e,s,null,i),o.injectIntoDevTools({bundleType:1,version:"1.0.0",rendererPackageName:"React Song",findHostInstanceByFiber:o.findHostInstance}),o.getPublicRootInstance(s)}};t.default=c},function(e,t,i){"use strict";e.exports=i(4)},function(e,t,i){
/** @license React v16.5.2
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
e.exports=function t(n){"use strict";var s=i(0),o=i(5);function r(e){for(var t=arguments.length-1,i="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=0;n<t;n++)i+="&args[]="+encodeURIComponent(arguments[n+1]);!function(e,t,i,n,s,o,r,a){if(!e){if(e=void 0,void 0===t)e=Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[i,n,s,o,r,a],u=0;(e=Error(t.replace(/%s/g,function(){return c[u++]}))).name="Invariant Violation"}throw e.framesToPop=1,e}}(!1,"Minified React error #"+e+"; visit %s for the full message or use the non-minified dev environment for full errors and additional helpful warnings. ",i)}var a=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,c="function"==typeof Symbol&&Symbol.for,u=c?Symbol.for("react.element"):60103,l=c?Symbol.for("react.portal"):60106,d=c?Symbol.for("react.fragment"):60107,p=c?Symbol.for("react.strict_mode"):60108,h=c?Symbol.for("react.profiler"):60114,f=c?Symbol.for("react.provider"):60109,m=c?Symbol.for("react.context"):60110,v=c?Symbol.for("react.async_mode"):60111,g=c?Symbol.for("react.forward_ref"):60112,y=c?Symbol.for("react.placeholder"):60113,b="function"==typeof Symbol&&Symbol.iterator;function k(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=b&&e[b]||e["@@iterator"])?e:null}function N(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case v:return"AsyncMode";case d:return"Fragment";case l:return"Portal";case h:return"Profiler";case p:return"StrictMode";case y:return"Placeholder"}if("object"==typeof e){switch(e.$$typeof){case m:return"Context.Consumer";case f:return"Context.Provider";case g:var t=e.render;return t=t.displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef")}if("function"==typeof e.then&&(e=1===e._reactStatus?e._reactResult:null))return N(e)}return null}function w(e){var t=e;if(e.alternate)for(;t.return;)t=t.return;else{if(0!=(2&t.effectTag))return 1;for(;t.return;)if(0!=(2&(t=t.return).effectTag))return 1}return 5===t.tag?2:3}function S(e){2!==w(e)&&r("188")}function E(e){var t=e.alternate;if(!t)return 3===(t=w(e))&&r("188"),1===t?null:e;for(var i=e,n=t;;){var s=i.return,o=s?s.alternate:null;if(!s||!o)break;if(s.child===o.child){for(var a=s.child;a;){if(a===i)return S(s),e;if(a===n)return S(s),t;a=a.sibling}r("188")}if(i.return!==n.return)i=s,n=o;else{a=!1;for(var c=s.child;c;){if(c===i){a=!0,i=s,n=o;break}if(c===n){a=!0,n=s,i=o;break}c=c.sibling}if(!a){for(c=o.child;c;){if(c===i){a=!0,i=o,n=s;break}if(c===n){a=!0,n=o,i=s;break}c=c.sibling}a||r("189")}}i.alternate!==n&&r("190")}return 5!==i.tag&&r("188"),i.stateNode.current===i?e:t}function P(e){if(!(e=E(e)))return null;for(var t=e;;){if(7===t.tag||8===t.tag)return t;if(t.child)t.child.return=t,t=t.child;else{if(t===e)break;for(;!t.sibling;){if(!t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}}return null}var T=n.getPublicInstance,A=n.getRootHostContext,I=n.getChildHostContext,x=n.prepareForCommit,O=n.resetAfterCommit,M=n.createInstance,C=n.appendInitialChild,B=n.finalizeInitialChildren,R=n.prepareUpdate,_=n.shouldSetTextContent,V=n.shouldDeprioritizeSubtree,q=n.createTextInstance,L=n.scheduleDeferredCallback,U=n.cancelDeferredCallback,D=n.noTimeout,F=n.now,z=n.isPrimaryRenderer,j=n.supportsMutation,W=n.supportsPersistence,Q=n.supportsHydration,H=n.appendChild,K=n.appendChildToContainer,G=n.commitTextUpdate,X=n.commitMount,Z=n.commitUpdate,Y=n.insertBefore,J=n.insertInContainerBefore,$=n.removeChild,ee=n.removeChildFromContainer,te=n.resetTextContent,ie=n.cloneInstance,ne=n.createContainerChildSet,se=n.appendChildToContainerChildSet,oe=n.finalizeContainerChildren,re=n.replaceContainerChildren,ae=n.canHydrateInstance,ce=n.canHydrateTextInstance,ue=n.getNextHydratableSibling,le=n.getFirstHydratableChild,de=n.hydrateInstance,pe=n.hydrateTextInstance,he=/^(.*)[\\\/]/;function fe(e){var t="";do{e:switch(e.tag){case 4:case 0:case 1:case 2:case 3:case 7:case 10:var i=e._debugOwner,n=e._debugSource,s=N(e.type),o=null;i&&(o=N(i.type)),i=s,s="",n?s=" (at "+n.fileName.replace(he,"")+":"+n.lineNumber+")":o&&(s=" (created by "+o+")"),o="\n    in "+(i||"Unknown")+s;break e;default:o=""}t+=o,e=e.return}while(e);return t}new Set;var me=[],ve=-1;function ge(e){0>ve||(e.current=me[ve],me[ve]=null,ve--)}function ye(e,t){me[++ve]=e.current,e.current=t}var be={},ke={current:be},Ne={current:!1},we=be;function Se(e,t){var i=e.type.contextTypes;if(!i)return be;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var s,o={};for(s in i)o[s]=t[s];return n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function Ee(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Pe(e){ge(Ne),ge(ke)}function Te(e){ge(Ne),ge(ke)}function Ae(e,t,i){ke.current!==be&&r("168"),ye(ke,t),ye(Ne,i)}function Ie(e,t,i){var n=e.stateNode;if(e=t.childContextTypes,"function"!=typeof n.getChildContext)return i;for(var o in n=n.getChildContext())o in e||r("108",N(t)||"Unknown",o);return s({},i,n)}function xe(e){var t=e.stateNode;return t=t&&t.__reactInternalMemoizedMergedChildContext||be,we=ke.current,ye(ke,t),ye(Ne,Ne.current),!0}function Oe(e,t,i){var n=e.stateNode;n||r("169"),i?(t=Ie(e,t,we),n.__reactInternalMemoizedMergedChildContext=t,ge(Ne),ge(ke),ye(ke,t)):ge(Ne),ye(Ne,i)}var Me=null,Ce=null;function Be(e){return function(t){try{return e(t)}catch(e){}}}function Re(e,t,i,n){this.tag=e,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=null,this.index=0,this.ref=null,this.pendingProps=t,this.firstContextDependency=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.effectTag=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childExpirationTime=this.expirationTime=0,this.alternate=null}function _e(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Ve(e,t,i){var n=e.alternate;return null===n?((n=new Re(e.tag,t,e.key,e.mode)).type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.effectTag=0,n.nextEffect=null,n.firstEffect=null,n.lastEffect=null),n.childExpirationTime=e.childExpirationTime,n.expirationTime=t!==e.pendingProps?i:e.expirationTime,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,n.firstContextDependency=e.firstContextDependency,n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function qe(e,t,i){var n=e.type,s=e.key;e=e.props;var o=void 0;if("function"==typeof n)o=_e(n)?2:4;else if("string"==typeof n)o=7;else e:switch(n){case d:return Le(e.children,t,i,s);case v:o=10,t|=3;break;case p:o=10,t|=2;break;case h:return(n=new Re(15,e,s,4|t)).type=h,n.expirationTime=i,n;case y:o=16;break;default:if("object"==typeof n&&null!==n)switch(n.$$typeof){case f:o=12;break e;case m:o=11;break e;case g:o=13;break e;default:if("function"==typeof n.then){o=4;break e}}r("130",null==n?n:typeof n,"")}return(t=new Re(o,e,s,t)).type=n,t.expirationTime=i,t}function Le(e,t,i,n){return(e=new Re(9,e,n,t)).expirationTime=i,e}function Ue(e,t,i){return(e=new Re(8,e,null,t)).expirationTime=i,e}function De(e,t,i){return(t=new Re(6,null!==e.children?e.children:[],e.key,t)).expirationTime=i,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Fe(e,t){e.didError=!1;var i=e.earliestPendingTime;0===i?e.earliestPendingTime=e.latestPendingTime=t:i>t?e.earliestPendingTime=t:e.latestPendingTime<t&&(e.latestPendingTime=t),ze(t,e)}function ze(e,t){var i=t.earliestSuspendedTime,n=t.latestSuspendedTime,s=t.earliestPendingTime,o=t.latestPingedTime;0===(s=0!==s?s:o)&&(0===e||n>e)&&(s=n),0!==(e=s)&&0!==i&&i<e&&(e=i),t.nextExpirationTimeToWorkOn=s,t.expirationTime=e}var je=!1;function We(e){return{baseState:e,firstUpdate:null,lastUpdate:null,firstCapturedUpdate:null,lastCapturedUpdate:null,firstEffect:null,lastEffect:null,firstCapturedEffect:null,lastCapturedEffect:null}}function Qe(e){return{baseState:e.baseState,firstUpdate:e.firstUpdate,lastUpdate:e.lastUpdate,firstCapturedUpdate:null,lastCapturedUpdate:null,firstEffect:null,lastEffect:null,firstCapturedEffect:null,lastCapturedEffect:null}}function He(e){return{expirationTime:e,tag:0,payload:null,callback:null,next:null,nextEffect:null}}function Ke(e,t){null===e.lastUpdate?e.firstUpdate=e.lastUpdate=t:(e.lastUpdate.next=t,e.lastUpdate=t)}function Ge(e,t){var i=e.alternate;if(null===i){var n=e.updateQueue,s=null;null===n&&(n=e.updateQueue=We(e.memoizedState))}else n=e.updateQueue,s=i.updateQueue,null===n?null===s?(n=e.updateQueue=We(e.memoizedState),s=i.updateQueue=We(i.memoizedState)):n=e.updateQueue=Qe(s):null===s&&(s=i.updateQueue=Qe(n));null===s||n===s?Ke(n,t):null===n.lastUpdate||null===s.lastUpdate?(Ke(n,t),Ke(s,t)):(Ke(n,t),s.lastUpdate=t)}function Xe(e,t){var i=e.updateQueue;null===(i=null===i?e.updateQueue=We(e.memoizedState):Ze(e,i)).lastCapturedUpdate?i.firstCapturedUpdate=i.lastCapturedUpdate=t:(i.lastCapturedUpdate.next=t,i.lastCapturedUpdate=t)}function Ze(e,t){var i=e.alternate;return null!==i&&t===i.updateQueue&&(t=e.updateQueue=Qe(t)),t}function Ye(e,t,i,n,o,r){switch(i.tag){case 1:return"function"==typeof(e=i.payload)?e.call(r,n,o):e;case 3:e.effectTag=-1025&e.effectTag|64;case 0:if(null===(o="function"==typeof(e=i.payload)?e.call(r,n,o):e)||void 0===o)break;return s({},n,o);case 2:je=!0}return n}function Je(e,t,i,n,s){je=!1;for(var o=(t=Ze(e,t)).baseState,r=null,a=0,c=t.firstUpdate,u=o;null!==c;){var l=c.expirationTime;l>s?(null===r&&(r=c,o=u),(0===a||a>l)&&(a=l)):(u=Ye(e,0,c,u,i,n),null!==c.callback&&(e.effectTag|=32,c.nextEffect=null,null===t.lastEffect?t.firstEffect=t.lastEffect=c:(t.lastEffect.nextEffect=c,t.lastEffect=c))),c=c.next}for(l=null,c=t.firstCapturedUpdate;null!==c;){var d=c.expirationTime;d>s?(null===l&&(l=c,null===r&&(o=u)),(0===a||a>d)&&(a=d)):(u=Ye(e,0,c,u,i,n),null!==c.callback&&(e.effectTag|=32,c.nextEffect=null,null===t.lastCapturedEffect?t.firstCapturedEffect=t.lastCapturedEffect=c:(t.lastCapturedEffect.nextEffect=c,t.lastCapturedEffect=c))),c=c.next}null===r&&(t.lastUpdate=null),null===l?t.lastCapturedUpdate=null:e.effectTag|=32,null===r&&null===l&&(o=u),t.baseState=o,t.firstUpdate=r,t.firstCapturedUpdate=l,e.expirationTime=a,e.memoizedState=u}function $e(e,t,i){null!==t.firstCapturedUpdate&&(null!==t.lastUpdate&&(t.lastUpdate.next=t.firstCapturedUpdate,t.lastUpdate=t.lastCapturedUpdate),t.firstCapturedUpdate=t.lastCapturedUpdate=null),et(t.firstEffect,i),t.firstEffect=t.lastEffect=null,et(t.firstCapturedEffect,i),t.firstCapturedEffect=t.lastCapturedEffect=null}function et(e,t){for(;null!==e;){var i=e.callback;if(null!==i){e.callback=null;var n=t;"function"!=typeof i&&r("191",i),i.call(n)}e=e.nextEffect}}function tt(e,t){return{value:e,source:t,stack:fe(t)}}var it={current:null},nt=null,st=null,ot=null;function rt(e,t){var i=e.type._context;z?(ye(it,i._currentValue),i._currentValue=t):(ye(it,i._currentValue2),i._currentValue2=t)}function at(e){var t=it.current;ge(it),e=e.type._context,z?e._currentValue=t:e._currentValue2=t}function ct(e){nt=e,ot=st=null,e.firstContextDependency=null}function ut(e,t){return ot!==e&&!1!==t&&0!==t&&("number"==typeof t&&1073741823!==t||(ot=e,t=1073741823),t={context:e,observedBits:t,next:null},null===st?(null===nt&&r("277"),nt.firstContextDependency=st=t):st=st.next=t),z?e._currentValue:e._currentValue2}var lt={},dt={current:lt},pt={current:lt},ht={current:lt};function ft(e){return e===lt&&r("174"),e}function mt(e,t){ye(ht,t),ye(pt,e),ye(dt,lt),t=A(t),ge(dt),ye(dt,t)}function vt(e){ge(dt),ge(pt),ge(ht)}function gt(e){var t=ft(ht.current),i=ft(dt.current);i!==(t=I(i,e.type,t))&&(ye(pt,e),ye(dt,t))}function yt(e){pt.current===e&&(ge(dt),ge(pt))}var bt=Object.prototype.hasOwnProperty;function kt(e,t){return e===t?0!==e||0!==t||1/e==1/t:e!=e&&t!=t}function Nt(e,t){if(kt(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var i=Object.keys(e),n=Object.keys(t);if(i.length!==n.length)return!1;for(n=0;n<i.length;n++)if(!bt.call(t,i[n])||!kt(e[i[n]],t[i[n]]))return!1;return!0}var wt=(new o.Component).refs;function St(e,t,i,n){i=null===(i=i(n,t=e.memoizedState))||void 0===i?t:s({},t,i),e.memoizedState=i,null!==(n=e.updateQueue)&&0===e.expirationTime&&(n.baseState=i)}var Et={isMounted:function(e){return!!(e=e._reactInternalFiber)&&2===w(e)},enqueueSetState:function(e,t,i){e=e._reactInternalFiber;var n=cn(),s=He(n=Bi(n,e));s.payload=t,void 0!==i&&null!==i&&(s.callback=i),Ge(e,s),Ri(e,n)},enqueueReplaceState:function(e,t,i){e=e._reactInternalFiber;var n=cn(),s=He(n=Bi(n,e));s.tag=1,s.payload=t,void 0!==i&&null!==i&&(s.callback=i),Ge(e,s),Ri(e,n)},enqueueForceUpdate:function(e,t){e=e._reactInternalFiber;var i=cn(),n=He(i=Bi(i,e));n.tag=2,void 0!==t&&null!==t&&(n.callback=t),Ge(e,n),Ri(e,i)}};function Pt(e,t,i,n,s,o,r){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(n,o,r):!t.prototype||!t.prototype.isPureReactComponent||(!Nt(i,n)||!Nt(s,o))}function Tt(e,t,i,n){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(i,n),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(i,n),t.state!==e&&Et.enqueueReplaceState(t,t.state,null)}function At(e,t,i,n){var s=e.stateNode,o=Ee(t)?we:ke.current;s.props=i,s.state=e.memoizedState,s.refs=wt,s.context=Se(e,o),null!==(o=e.updateQueue)&&(Je(e,o,i,s,n),s.state=e.memoizedState),"function"==typeof(o=t.getDerivedStateFromProps)&&(St(e,t,o,i),s.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof s.getSnapshotBeforeUpdate||"function"!=typeof s.UNSAFE_componentWillMount&&"function"!=typeof s.componentWillMount||(t=s.state,"function"==typeof s.componentWillMount&&s.componentWillMount(),"function"==typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount(),t!==s.state&&Et.enqueueReplaceState(s,s.state,null),null!==(o=e.updateQueue)&&(Je(e,o,i,s,n),s.state=e.memoizedState)),"function"==typeof s.componentDidMount&&(e.effectTag|=4)}var It=Array.isArray;function xt(e,t,i){if(null!==(e=i.ref)&&"function"!=typeof e&&"object"!=typeof e){if(i._owner){var n=void 0;(i=i._owner)&&(2!==i.tag&&3!==i.tag&&r("110"),n=i.stateNode),n||r("147",e);var s=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===s?t.ref:((t=function(e){var t=n.refs;t===wt&&(t=n.refs={}),null===e?delete t[s]:t[s]=e})._stringRef=s,t)}"string"!=typeof e&&r("284"),i._owner||r("254",e)}return e}function Ot(e,t){"textarea"!==e.type&&r("31","[object Object]"===Object.prototype.toString.call(t)?"object with keys {"+Object.keys(t).join(", ")+"}":t,"")}function Mt(e){function t(t,i){if(e){var n=t.lastEffect;null!==n?(n.nextEffect=i,t.lastEffect=i):t.firstEffect=t.lastEffect=i,i.nextEffect=null,i.effectTag=8}}function i(i,n){if(!e)return null;for(;null!==n;)t(i,n),n=n.sibling;return null}function n(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function s(e,t,i){return(e=Ve(e,t,i)).index=0,e.sibling=null,e}function o(t,i,n){return t.index=n,e?null!==(n=t.alternate)?(n=n.index)<i?(t.effectTag=2,i):n:(t.effectTag=2,i):i}function a(t){return e&&null===t.alternate&&(t.effectTag=2),t}function c(e,t,i,n){return null===t||8!==t.tag?((t=Ue(i,e.mode,n)).return=e,t):((t=s(t,i,n)).return=e,t)}function p(e,t,i,n){return null!==t&&t.type===i.type?((n=s(t,i.props,n)).ref=xt(e,t,i),n.return=e,n):((n=qe(i,e.mode,n)).ref=xt(e,t,i),n.return=e,n)}function h(e,t,i,n){return null===t||6!==t.tag||t.stateNode.containerInfo!==i.containerInfo||t.stateNode.implementation!==i.implementation?((t=De(i,e.mode,n)).return=e,t):((t=s(t,i.children||[],n)).return=e,t)}function f(e,t,i,n,o){return null===t||9!==t.tag?((t=Le(i,e.mode,n,o)).return=e,t):((t=s(t,i,n)).return=e,t)}function m(e,t,i){if("string"==typeof t||"number"==typeof t)return(t=Ue(""+t,e.mode,i)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case u:return(i=qe(t,e.mode,i)).ref=xt(e,null,t),i.return=e,i;case l:return(t=De(t,e.mode,i)).return=e,t}if(It(t)||k(t))return(t=Le(t,e.mode,i,null)).return=e,t;Ot(e,t)}return null}function v(e,t,i,n){var s=null!==t?t.key:null;if("string"==typeof i||"number"==typeof i)return null!==s?null:c(e,t,""+i,n);if("object"==typeof i&&null!==i){switch(i.$$typeof){case u:return i.key===s?i.type===d?f(e,t,i.props.children,n,s):p(e,t,i,n):null;case l:return i.key===s?h(e,t,i,n):null}if(It(i)||k(i))return null!==s?null:f(e,t,i,n,null);Ot(e,i)}return null}function g(e,t,i,n,s){if("string"==typeof n||"number"==typeof n)return c(t,e=e.get(i)||null,""+n,s);if("object"==typeof n&&null!==n){switch(n.$$typeof){case u:return e=e.get(null===n.key?i:n.key)||null,n.type===d?f(t,e,n.props.children,s,n.key):p(t,e,n,s);case l:return h(t,e=e.get(null===n.key?i:n.key)||null,n,s)}if(It(n)||k(n))return f(t,e=e.get(i)||null,n,s,null);Ot(t,n)}return null}function y(s,r,a,c){for(var u=null,l=null,d=r,p=r=0,h=null;null!==d&&p<a.length;p++){d.index>p?(h=d,d=null):h=d.sibling;var f=v(s,d,a[p],c);if(null===f){null===d&&(d=h);break}e&&d&&null===f.alternate&&t(s,d),r=o(f,r,p),null===l?u=f:l.sibling=f,l=f,d=h}if(p===a.length)return i(s,d),u;if(null===d){for(;p<a.length;p++)(d=m(s,a[p],c))&&(r=o(d,r,p),null===l?u=d:l.sibling=d,l=d);return u}for(d=n(s,d);p<a.length;p++)(h=g(d,s,p,a[p],c))&&(e&&null!==h.alternate&&d.delete(null===h.key?p:h.key),r=o(h,r,p),null===l?u=h:l.sibling=h,l=h);return e&&d.forEach(function(e){return t(s,e)}),u}function b(s,a,c,u){var l=k(c);"function"!=typeof l&&r("150"),null==(c=l.call(c))&&r("151");for(var d=l=null,p=a,h=a=0,f=null,y=c.next();null!==p&&!y.done;h++,y=c.next()){p.index>h?(f=p,p=null):f=p.sibling;var b=v(s,p,y.value,u);if(null===b){p||(p=f);break}e&&p&&null===b.alternate&&t(s,p),a=o(b,a,h),null===d?l=b:d.sibling=b,d=b,p=f}if(y.done)return i(s,p),l;if(null===p){for(;!y.done;h++,y=c.next())null!==(y=m(s,y.value,u))&&(a=o(y,a,h),null===d?l=y:d.sibling=y,d=y);return l}for(p=n(s,p);!y.done;h++,y=c.next())null!==(y=g(p,s,h,y.value,u))&&(e&&null!==y.alternate&&p.delete(null===y.key?h:y.key),a=o(y,a,h),null===d?l=y:d.sibling=y,d=y);return e&&p.forEach(function(e){return t(s,e)}),l}return function(e,n,o,c){var p="object"==typeof o&&null!==o&&o.type===d&&null===o.key;p&&(o=o.props.children);var h="object"==typeof o&&null!==o;if(h)switch(o.$$typeof){case u:e:{for(h=o.key,p=n;null!==p;){if(p.key===h){if(9===p.tag?o.type===d:p.type===o.type){i(e,p.sibling),(n=s(p,o.type===d?o.props.children:o.props,c)).ref=xt(e,p,o),n.return=e,e=n;break e}i(e,p);break}t(e,p),p=p.sibling}o.type===d?((n=Le(o.props.children,e.mode,c,o.key)).return=e,e=n):((c=qe(o,e.mode,c)).ref=xt(e,n,o),c.return=e,e=c)}return a(e);case l:e:{for(p=o.key;null!==n;){if(n.key===p){if(6===n.tag&&n.stateNode.containerInfo===o.containerInfo&&n.stateNode.implementation===o.implementation){i(e,n.sibling),(n=s(n,o.children||[],c)).return=e,e=n;break e}i(e,n);break}t(e,n),n=n.sibling}(n=De(o,e.mode,c)).return=e,e=n}return a(e)}if("string"==typeof o||"number"==typeof o)return o=""+o,null!==n&&8===n.tag?(i(e,n.sibling),(n=s(n,o,c)).return=e,e=n):(i(e,n),(n=Ue(o,e.mode,c)).return=e,e=n),a(e);if(It(o))return y(e,n,o,c);if(k(o))return b(e,n,o,c);if(h&&Ot(e,o),void 0===o&&!p)switch(e.tag){case 2:case 3:case 0:r("152",(c=e.type).displayName||c.name||"Component")}return i(e,n)}}var Ct=Mt(!0),Bt=Mt(!1),Rt=null,_t=null,Vt=!1;function qt(e,t){var i=new Re(7,null,null,0);i.type="DELETED",i.stateNode=t,i.return=e,i.effectTag=8,null!==e.lastEffect?(e.lastEffect.nextEffect=i,e.lastEffect=i):e.firstEffect=e.lastEffect=i}function Lt(e,t){switch(e.tag){case 7:return null!==(t=ae(t,e.type,e.pendingProps))&&(e.stateNode=t,!0);case 8:return null!==(t=ce(t,e.pendingProps))&&(e.stateNode=t,!0);default:return!1}}function Ut(e){if(Vt){var t=_t;if(t){var i=t;if(!Lt(e,t)){if(!(t=ue(i))||!Lt(e,t))return e.effectTag|=2,Vt=!1,void(Rt=e);qt(Rt,i)}Rt=e,_t=le(t)}else e.effectTag|=2,Vt=!1,Rt=e}}function Dt(e){for(e=e.return;null!==e&&7!==e.tag&&5!==e.tag;)e=e.return;Rt=e}function Ft(e){if(!Q||e!==Rt)return!1;if(!Vt)return Dt(e),Vt=!0,!1;var t=e.type;if(7!==e.tag||"head"!==t&&"body"!==t&&!_(t,e.memoizedProps))for(t=_t;t;)qt(e,t),t=ue(t);return Dt(e),_t=Rt?ue(e.stateNode):null,!0}function zt(){Q&&(_t=Rt=null,Vt=!1)}var jt=a.ReactCurrentOwner;function Wt(e,t,i,n){t.child=null===e?Bt(t,null,i,n):Ct(t,e.child,i,n)}function Qt(e,t,i,n,s){i=i.render;var o=t.ref;return Ne.current||t.memoizedProps!==n||o!==(null!==e?e.ref:null)?(Wt(e,t,i=i(n,o),s),t.memoizedProps=n,t.child):Jt(e,t,s)}function Ht(e,t){var i=t.ref;(null===e&&null!==i||null!==e&&e.ref!==i)&&(t.effectTag|=128)}function Kt(e,t,i,n,s){var o=Ee(i)?we:ke.current;return o=Se(t,o),ct(t),i=i(n,o),t.effectTag|=1,Wt(e,t,i,s),t.memoizedProps=n,t.child}function Gt(e,t,i,n,s){if(Ee(i)){var o=!0;xe(t)}else o=!1;if(ct(t),null===e)if(null===t.stateNode){var r=Ee(i)?we:ke.current,a=i.contextTypes,c=null!==a&&void 0!==a,u=new i(n,a=c?Se(t,r):be);t.memoizedState=null!==u.state&&void 0!==u.state?u.state:null,u.updater=Et,t.stateNode=u,u._reactInternalFiber=t,c&&((c=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,c.__reactInternalMemoizedMaskedChildContext=a),At(t,i,n,s),n=!0}else{r=t.stateNode,a=t.memoizedProps,r.props=a;var l=r.context;c=Se(t,c=Ee(i)?we:ke.current);var d=i.getDerivedStateFromProps;(u="function"==typeof d||"function"==typeof r.getSnapshotBeforeUpdate)||"function"!=typeof r.UNSAFE_componentWillReceiveProps&&"function"!=typeof r.componentWillReceiveProps||(a!==n||l!==c)&&Tt(t,r,n,c),je=!1;var p=t.memoizedState;l=r.state=p;var h=t.updateQueue;null!==h&&(Je(t,h,n,r,s),l=t.memoizedState),a!==n||p!==l||Ne.current||je?("function"==typeof d&&(St(t,i,d,n),l=t.memoizedState),(a=je||Pt(t,i,a,n,p,l,c))?(u||"function"!=typeof r.UNSAFE_componentWillMount&&"function"!=typeof r.componentWillMount||("function"==typeof r.componentWillMount&&r.componentWillMount(),"function"==typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount()),"function"==typeof r.componentDidMount&&(t.effectTag|=4)):("function"==typeof r.componentDidMount&&(t.effectTag|=4),t.memoizedProps=n,t.memoizedState=l),r.props=n,r.state=l,r.context=c,n=a):("function"==typeof r.componentDidMount&&(t.effectTag|=4),n=!1)}else r=t.stateNode,a=t.memoizedProps,r.props=a,l=r.context,c=Se(t,c=Ee(i)?we:ke.current),(u="function"==typeof(d=i.getDerivedStateFromProps)||"function"==typeof r.getSnapshotBeforeUpdate)||"function"!=typeof r.UNSAFE_componentWillReceiveProps&&"function"!=typeof r.componentWillReceiveProps||(a!==n||l!==c)&&Tt(t,r,n,c),je=!1,l=t.memoizedState,p=r.state=l,null!==(h=t.updateQueue)&&(Je(t,h,n,r,s),p=t.memoizedState),a!==n||l!==p||Ne.current||je?("function"==typeof d&&(St(t,i,d,n),p=t.memoizedState),(d=je||Pt(t,i,a,n,l,p,c))?(u||"function"!=typeof r.UNSAFE_componentWillUpdate&&"function"!=typeof r.componentWillUpdate||("function"==typeof r.componentWillUpdate&&r.componentWillUpdate(n,p,c),"function"==typeof r.UNSAFE_componentWillUpdate&&r.UNSAFE_componentWillUpdate(n,p,c)),"function"==typeof r.componentDidUpdate&&(t.effectTag|=4),"function"==typeof r.getSnapshotBeforeUpdate&&(t.effectTag|=256)):("function"!=typeof r.componentDidUpdate||a===e.memoizedProps&&l===e.memoizedState||(t.effectTag|=4),"function"!=typeof r.getSnapshotBeforeUpdate||a===e.memoizedProps&&l===e.memoizedState||(t.effectTag|=256),t.memoizedProps=n,t.memoizedState=p),r.props=n,r.state=p,r.context=c,n=d):("function"!=typeof r.componentDidUpdate||a===e.memoizedProps&&l===e.memoizedState||(t.effectTag|=4),"function"!=typeof r.getSnapshotBeforeUpdate||a===e.memoizedProps&&l===e.memoizedState||(t.effectTag|=256),n=!1);return Xt(e,t,i,n,o,s)}function Xt(e,t,i,n,s,o){Ht(e,t);var r=0!=(64&t.effectTag);if(!n&&!r)return s&&Oe(t,i,!1),Jt(e,t,o);n=t.stateNode,jt.current=t;var a=r?null:n.render();return t.effectTag|=1,null!==e&&r&&(Wt(e,t,null,o),t.child=null),Wt(e,t,a,o),t.memoizedState=n.state,t.memoizedProps=n.props,s&&Oe(t,i,!0),t.child}function Zt(e){var t=e.stateNode;t.pendingContext?Ae(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Ae(0,t.context,!1),mt(e,t.containerInfo)}function Yt(e,t){if(e&&e.defaultProps)for(var i in t=s({},t),e=e.defaultProps)void 0===t[i]&&(t[i]=e[i]);return t}function Jt(e,t,i){null!==e&&(t.firstContextDependency=e.firstContextDependency);var n=t.childExpirationTime;if(0===n||n>i)return null;if(null!==e&&t.child!==e.child&&r("153"),null!==t.child){for(i=Ve(e=t.child,e.pendingProps,e.expirationTime),t.child=i,i.return=t;null!==e.sibling;)e=e.sibling,(i=i.sibling=Ve(e,e.pendingProps,e.expirationTime)).return=t;i.sibling=null}return t.child}function $t(e,t,i){var n=t.expirationTime;if(!Ne.current&&(0===n||n>i)){switch(t.tag){case 5:Zt(t),zt();break;case 7:gt(t);break;case 2:Ee(t.type)&&xe(t);break;case 3:Ee(t.type._reactResult)&&xe(t);break;case 6:mt(t,t.stateNode.containerInfo);break;case 12:rt(t,t.memoizedProps.value)}return Jt(e,t,i)}switch(t.expirationTime=0,t.tag){case 4:return function(e,t,i,n){null!==e&&r("155");var s=t.pendingProps;if("object"==typeof i&&null!==i&&"function"==typeof i.then){var o=i=function(e){switch(e._reactStatus){case 1:return e._reactResult;case 2:throw e._reactResult;case 0:throw e;default:throw e._reactStatus=0,e.then(function(t){if(0===e._reactStatus){if(e._reactStatus=1,"object"==typeof t&&null!==t){var i=t.default;t=void 0!==i&&null!==i?i:t}e._reactResult=t}},function(t){0===e._reactStatus&&(e._reactStatus=2,e._reactResult=t)}),e}}(i);o="function"==typeof o?_e(o)?3:1:void 0!==o&&null!==o&&o.$$typeof?14:4,o=t.tag=o;var a=Yt(i,s);switch(o){case 1:return Kt(e,t,i,a,n);case 3:return Gt(e,t,i,a,n);case 14:return Qt(e,t,i,a,n);default:r("283",i)}}if(o=Se(t,ke.current),ct(t),o=i(s,o),t.effectTag|=1,"object"==typeof o&&null!==o&&"function"==typeof o.render&&void 0===o.$$typeof){t.tag=2,Ee(i)?(a=!0,xe(t)):a=!1,t.memoizedState=null!==o.state&&void 0!==o.state?o.state:null;var c=i.getDerivedStateFromProps;return"function"==typeof c&&St(t,i,c,s),o.updater=Et,t.stateNode=o,o._reactInternalFiber=t,At(t,i,s,n),Xt(e,t,i,!0,a,n)}return t.tag=0,Wt(e,t,o,n),t.memoizedProps=s,t.child}(e,t,t.type,i);case 0:return Kt(e,t,t.type,t.pendingProps,i);case 1:var s=t.type._reactResult;return e=Kt(e,t,s,Yt(s,n=t.pendingProps),i),t.memoizedProps=n,e;case 2:return Gt(e,t,t.type,t.pendingProps,i);case 3:return e=Gt(e,t,s=t.type._reactResult,Yt(s,n=t.pendingProps),i),t.memoizedProps=n,e;case 5:return Zt(t),null===(n=t.updateQueue)&&r("282"),s=null!==(s=t.memoizedState)?s.element:null,Je(t,n,t.pendingProps,null,i),(n=t.memoizedState.element)===s?(zt(),t=Jt(e,t,i)):(s=t.stateNode,(s=(null===e||null===e.child)&&s.hydrate)&&(Q?(_t=le(t.stateNode.containerInfo),Rt=t,s=Vt=!0):s=!1),s?(t.effectTag|=2,t.child=Bt(t,null,n,i)):(Wt(e,t,n,i),zt()),t=t.child),t;case 7:gt(t),null===e&&Ut(t),n=t.type,s=t.pendingProps;var o=null!==e?e.memoizedProps:null,a=s.children;return _(n,s)?a=null:null!==o&&_(n,o)&&(t.effectTag|=16),Ht(e,t),1073741823!==i&&1&t.mode&&V(n,s)?(t.expirationTime=1073741823,t.memoizedProps=s,t=null):(Wt(e,t,a,i),t.memoizedProps=s,t=t.child),t;case 8:return null===e&&Ut(t),t.memoizedProps=t.pendingProps,null;case 16:return null;case 6:return mt(t,t.stateNode.containerInfo),n=t.pendingProps,null===e?t.child=Ct(t,null,n,i):Wt(e,t,n,i),t.memoizedProps=n,t.child;case 13:return Qt(e,t,t.type,t.pendingProps,i);case 14:return e=Qt(e,t,s=t.type._reactResult,Yt(s,n=t.pendingProps),i),t.memoizedProps=n,e;case 9:return Wt(e,t,n=t.pendingProps,i),t.memoizedProps=n,t.child;case 10:return Wt(e,t,n=t.pendingProps.children,i),t.memoizedProps=n,t.child;case 15:return Wt(e,t,(n=t.pendingProps).children,i),t.memoizedProps=n,t.child;case 12:e:{if(n=t.type._context,s=t.pendingProps,a=t.memoizedProps,o=s.value,t.memoizedProps=s,rt(t,o),null!==a){var c=a.value;if(0===(o=c===o&&(0!==c||1/c==1/o)||c!=c&&o!=o?0:0|("function"==typeof n._calculateChangedBits?n._calculateChangedBits(c,o):1073741823))){if(a.children===s.children&&!Ne.current){t=Jt(e,t,i);break e}}else for(null!==(a=t.child)&&(a.return=t);null!==a;){if(null!==(c=a.firstContextDependency))do{if(c.context===n&&0!=(c.observedBits&o)){if(2===a.tag||3===a.tag){var u=He(i);u.tag=2,Ge(a,u)}(0===a.expirationTime||a.expirationTime>i)&&(a.expirationTime=i),null!==(u=a.alternate)&&(0===u.expirationTime||u.expirationTime>i)&&(u.expirationTime=i);for(var l=a.return;null!==l;){if(u=l.alternate,0===l.childExpirationTime||l.childExpirationTime>i)l.childExpirationTime=i,null!==u&&(0===u.childExpirationTime||u.childExpirationTime>i)&&(u.childExpirationTime=i);else{if(null===u||!(0===u.childExpirationTime||u.childExpirationTime>i))break;u.childExpirationTime=i}l=l.return}}u=a.child,c=c.next}while(null!==c);else u=12===a.tag&&a.type===t.type?null:a.child;if(null!==u)u.return=a;else for(u=a;null!==u;){if(u===t){u=null;break}if(null!==(a=u.sibling)){a.return=u.return,u=a;break}u=u.return}a=u}}Wt(e,t,s.children,i),t=t.child}return t;case 11:return o=t.type,s=(n=t.pendingProps).children,ct(t),s=s(o=ut(o,n.unstable_observedBits)),t.effectTag|=1,Wt(e,t,s,i),t.memoizedProps=n,t.child;default:r("156")}}function ei(e){e.effectTag|=4}function ti(e,t){for(var i=t.child;null!==i;){if(7===i.tag||8===i.tag)C(e,i.stateNode);else if(6!==i.tag&&null!==i.child){i.child.return=i,i=i.child;continue}if(i===t)break;for(;null===i.sibling;){if(null===i.return||i.return===t)return;i=i.return}i.sibling.return=i.return,i=i.sibling}}var ii=void 0,ni=void 0,si=void 0;function oi(e,t){var i=t.source,n=t.stack;null===n&&null!==i&&(n=fe(i)),null!==i&&N(i.type),t=t.value,null!==e&&2===e.tag&&N(e.type);try{console.error(t)}catch(e){setTimeout(function(){throw e})}}function ri(e){var t=e.ref;if(null!==t)if("function"==typeof t)try{t(null)}catch(t){Ci(e,t)}else t.current=null}function ai(e){switch("function"==typeof Ce&&Ce(e),e.tag){case 2:case 3:ri(e);var t=e.stateNode;if("function"==typeof t.componentWillUnmount)try{t.props=e.memoizedProps,t.state=e.memoizedState,t.componentWillUnmount()}catch(t){Ci(e,t)}break;case 7:ri(e);break;case 6:j?di(e):W&&W&&(e=e.stateNode.containerInfo,t=ne(e),re(e,t))}}function ci(e){for(var t=e;;)if(ai(t),null===t.child||j&&6===t.tag){if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}else t.child.return=t,t=t.child}function ui(e){return 7===e.tag||5===e.tag||6===e.tag}function li(e){if(j){e:{for(var t=e.return;null!==t;){if(ui(t)){var i=t;break e}t=t.return}r("160"),i=void 0}var n=t=void 0;switch(i.tag){case 7:t=i.stateNode,n=!1;break;case 5:case 6:t=i.stateNode.containerInfo,n=!0;break;default:r("161")}16&i.effectTag&&(te(t),i.effectTag&=-17);e:t:for(i=e;;){for(;null===i.sibling;){if(null===i.return||ui(i.return)){i=null;break e}i=i.return}for(i.sibling.return=i.return,i=i.sibling;7!==i.tag&&8!==i.tag;){if(2&i.effectTag)continue t;if(null===i.child||6===i.tag)continue t;i.child.return=i,i=i.child}if(!(2&i.effectTag)){i=i.stateNode;break e}}for(var s=e;;){if(7===s.tag||8===s.tag)i?n?J(t,s.stateNode,i):Y(t,s.stateNode,i):n?K(t,s.stateNode):H(t,s.stateNode);else if(6!==s.tag&&null!==s.child){s.child.return=s,s=s.child;continue}if(s===e)break;for(;null===s.sibling;){if(null===s.return||s.return===e)return;s=s.return}s.sibling.return=s.return,s=s.sibling}}}function di(e){for(var t=e,i=!1,n=void 0,s=void 0;;){if(!i){i=t.return;e:for(;;){switch(null===i&&r("160"),i.tag){case 7:n=i.stateNode,s=!1;break e;case 5:case 6:n=i.stateNode.containerInfo,s=!0;break e}i=i.return}i=!0}if(7===t.tag||8===t.tag)ci(t),s?ee(n,t.stateNode):$(n,t.stateNode);else if(6===t.tag?(n=t.stateNode.containerInfo,s=!0):ai(t),null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return;6===(t=t.return).tag&&(i=!1)}t.sibling.return=t.return,t=t.sibling}}function pi(e,t){if(j)switch(t.tag){case 2:case 3:break;case 7:var i=t.stateNode;if(null!=i){var n=t.memoizedProps;e=null!==e?e.memoizedProps:n;var s=t.type,o=t.updateQueue;t.updateQueue=null,null!==o&&Z(i,o,s,e,n,t)}break;case 8:null===t.stateNode&&r("162"),i=t.memoizedProps,G(t.stateNode,null!==e?e.memoizedProps:i,i);break;case 5:case 15:case 16:break;default:r("163")}else if(W)switch(t.tag){case 2:case 3:case 7:case 8:break;case 5:case 6:t=t.stateNode,re(t.containerInfo,t.pendingChildren);break;default:r("163")}}function hi(e,t,i){(i=He(i)).tag=3,i.payload={element:null};var n=t.value;return i.callback=function(){vn(n),oi(e,t)},i}function fi(e,t,i){(i=He(i)).tag=3;var n=e.stateNode;return null!==n&&"function"==typeof n.componentDidCatch&&(i.callback=function(){null===Ai?Ai=new Set([this]):Ai.add(this);var i=t.value,n=t.stack;oi(e,t),this.componentDidCatch(i,{componentStack:null!==n?n:""})}),i}function mi(e){switch(e.tag){case 2:Ee(e.type)&&Pe();var t=e.effectTag;return 1024&t?(e.effectTag=-1025&t|64,e):null;case 3:return Ee(e.type._reactResult)&&Pe(),1024&(t=e.effectTag)?(e.effectTag=-1025&t|64,e):null;case 5:return vt(),Te(),0!=(64&(t=e.effectTag))&&r("285"),e.effectTag=-1025&t|64,e;case 7:return yt(e),null;case 16:return 1024&(t=e.effectTag)?(e.effectTag=-1025&t|64,e):null;case 6:return vt(),null;case 12:return at(e),null;default:return null}}j?(ii=function(){},ni=function(e,t,i,n,s){if((e=e.memoizedProps)!==n){var o=t.stateNode,r=ft(dt.current);i=R(o,i,e,n,s,r),(t.updateQueue=i)&&ei(t)}},si=function(e,t,i,n){i!==n&&ei(t)}):W?(ii=function(e){var t=e.stateNode;if(null!==e.firstEffect){var i=t.containerInfo,n=ne(i);e:for(var s=e.child;null!==s;){if(7===s.tag||8===s.tag)se(n,s.stateNode);else if(6!==s.tag&&null!==s.child){s.child.return=s,s=s.child;continue}if(s===e)break e;for(;null===s.sibling;){if(null===s.return||s.return===e)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}t.pendingChildren=n,ei(e),oe(i,n)}},ni=function(e,t,i,n,s){var o=e.stateNode,r=e.memoizedProps;if((e=null===t.firstEffect)&&r===n)t.stateNode=o;else{var a=t.stateNode,c=ft(dt.current),u=null;r!==n&&(u=R(a,i,r,n,s,c)),e&&null===u?t.stateNode=o:(o=ie(o,u,i,r,n,t,e,a),B(o,i,n,s,c)&&ei(t),t.stateNode=o,e?ei(t):ti(o,t))}},si=function(e,t,i,n){i!==n&&(e=ft(ht.current),i=ft(dt.current),t.stateNode=q(n,e,i,t),ei(t))}):(ii=function(){},ni=function(){},si=function(){});var vi={readContext:ut},gi=a.ReactCurrentOwner,yi=0,bi=0,ki=!1,Ni=null,wi=null,Si=0,Ei=!1,Pi=null,Ti=!1,Ai=null;function Ii(){if(null!==Ni)for(var e=Ni.return;null!==e;){var t=e;switch(t.tag){case 2:var i=t.type.childContextTypes;null!==i&&void 0!==i&&Pe();break;case 3:null!==(i=t.type._reactResult.childContextTypes)&&void 0!==i&&Pe();break;case 5:vt(),Te();break;case 7:yt(t);break;case 6:vt();break;case 12:at(t)}e=e.return}wi=null,Si=0,Ei=!1,Ni=null}function xi(e){for(;;){var t=e.alternate,i=e.return,n=e.sibling;if(0==(512&e.effectTag)){var s=t,o=(t=e).pendingProps;switch(t.tag){case 0:case 1:break;case 2:Ee(t.type)&&Pe();break;case 3:Ee(t.type._reactResult)&&Pe();break;case 5:vt(),Te(),(o=t.stateNode).pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),null!==s&&null!==s.child||(Ft(t),t.effectTag&=-3),ii(t);break;case 7:yt(t);var a=ft(ht.current),c=t.type;if(null!==s&&null!=t.stateNode)ni(s,t,c,o,a),s.ref!==t.ref&&(t.effectTag|=128);else if(o){if(s=ft(dt.current),Ft(t))o=t,Q||r("175"),a=de(o.stateNode,o.type,o.memoizedProps,a,s,o),o.updateQueue=a,(o=null!==a)&&ei(t);else{var u=M(c,o,a,s,t);ti(u,t),B(u,c,o,a,s)&&ei(t),t.stateNode=u}null!==t.ref&&(t.effectTag|=128)}else null===t.stateNode&&r("166");break;case 8:s&&null!=t.stateNode?si(s,t,s.memoizedProps,o):("string"!=typeof o&&(null===t.stateNode&&r("166")),a=ft(ht.current),c=ft(dt.current),Ft(t)?(o=t,Q||r("176"),(o=pe(o.stateNode,o.memoizedProps,o))&&ei(t)):t.stateNode=q(o,a,c,t));break;case 13:case 14:case 16:case 9:case 10:case 15:break;case 6:vt(),ii(t);break;case 12:at(t);break;case 11:break;case 4:r("167");default:r("156")}if(t=Ni=null,o=e,1073741823===Si||1073741823!==o.childExpirationTime){for(a=0,c=o.child;null!==c;)s=c.expirationTime,u=c.childExpirationTime,(0===a||0!==s&&s<a)&&(a=s),(0===a||0!==u&&u<a)&&(a=u),c=c.sibling;o.childExpirationTime=a}if(null!==t)return t;null!==i&&0==(512&i.effectTag)&&(null===i.firstEffect&&(i.firstEffect=e.firstEffect),null!==e.lastEffect&&(null!==i.lastEffect&&(i.lastEffect.nextEffect=e.firstEffect),i.lastEffect=e.lastEffect),1<e.effectTag&&(null!==i.lastEffect?i.lastEffect.nextEffect=e:i.firstEffect=e,i.lastEffect=e))}else{if(null!==(e=mi(e)))return e.effectTag&=511,e;null!==i&&(i.firstEffect=i.lastEffect=null,i.effectTag|=512)}if(null!==n)return n;if(null===i)break;e=i}return null}function Oi(e){var t=$t(e.alternate,e,Si);return null===t&&(t=xi(e)),gi.current=null,t}function Mi(e,t,i){ki&&r("243"),ki=!0,gi.currentDispatcher=vi;var n=e.nextExpirationTimeToWorkOn;n===Si&&e===wi&&null!==Ni||(Ii(),Si=n,Ni=Ve((wi=e).current,null,Si),e.pendingCommitExpirationTime=0);for(var s=!1;;){try{if(t)for(;null!==Ni&&!mn();)Ni=Oi(Ni);else for(;null!==Ni;)Ni=Oi(Ni)}catch(e){if(null===Ni)s=!0,vn(e);else{null===Ni&&r("271");var o=Ni,a=o.return;if(null!==a){e:{var c=a,u=o,l=e;a=Si,u.effectTag|=512,u.firstEffect=u.lastEffect=null,Ei=!0,l=tt(l,u);do{switch(c.tag){case 5:c.effectTag|=1024,c.expirationTime=a,Xe(c,a=hi(c,l,a));break e;case 2:case 3:u=l;var d=c.stateNode;if(0==(64&c.effectTag)&&null!==d&&"function"==typeof d.componentDidCatch&&(null===Ai||!Ai.has(d))){c.effectTag|=1024,c.expirationTime=a,Xe(c,a=fi(c,u,a));break e}}c=c.return}while(null!==c)}Ni=xi(o);continue}s=!0,vn(e)}}break}if(ki=!1,ot=st=nt=gi.currentDispatcher=null,s)wi=null,e.finishedWork=null;else if(null!==Ni)e.finishedWork=null;else{if(null===(t=e.current.alternate)&&r("281"),wi=null,Ei){if(s=e.latestPendingTime,o=e.latestSuspendedTime,a=e.latestPingedTime,0!==s&&s>n||0!==o&&o>n||0!==a&&a>n)return e.didError=!1,0!==(i=e.latestPingedTime)&&i<=n&&(e.latestPingedTime=0),i=e.earliestPendingTime,t=e.latestPendingTime,i===n?e.earliestPendingTime=t===n?e.latestPendingTime=0:t:t===n&&(e.latestPendingTime=i),i=e.earliestSuspendedTime,t=e.latestSuspendedTime,0===i?e.earliestSuspendedTime=e.latestSuspendedTime=n:i>n?e.earliestSuspendedTime=n:t<n&&(e.latestSuspendedTime=n),ze(n,e),void(e.expirationTime=e.expirationTime);if(!e.didError&&!i)return e.didError=!0,e.nextExpirationTimeToWorkOn=n,void(e.expirationTime=1)}e.pendingCommitExpirationTime=n,e.finishedWork=t}}function Ci(e,t){var i;e:{for(ki&&!Ti&&r("263"),i=e.return;null!==i;){switch(i.tag){case 2:case 3:var n=i.stateNode;if("function"==typeof i.type.getDerivedStateFromCatch||"function"==typeof n.componentDidCatch&&(null===Ai||!Ai.has(n))){Ge(i,e=fi(i,e=tt(t,e),1)),Ri(i,1),i=void 0;break e}break;case 5:Ge(i,e=hi(i,e=tt(t,e),1)),Ri(i,1),i=void 0;break e}i=i.return}5===e.tag&&(Ge(e,i=hi(e,i=tt(t,e),1)),Ri(e,1)),i=void 0}return i}function Bi(e,t){return 0!==bi?e=bi:ki?e=Ti?1:Si:1&t.mode?(e=Zi?2+10*(1+((e-2+15)/10|0)):2+25*(1+((e-2+500)/25|0)),null!==wi&&e===Si&&(e+=1)):e=1,Zi&&(0===ji||e>ji)&&(ji=e),e}function Ri(e,t){e:{(0===e.expirationTime||e.expirationTime>t)&&(e.expirationTime=t);var i=e.alternate;null!==i&&(0===i.expirationTime||i.expirationTime>t)&&(i.expirationTime=t);var n=e.return;if(null===n&&5===e.tag)e=e.stateNode;else{for(;null!==n;){if(i=n.alternate,(0===n.childExpirationTime||n.childExpirationTime>t)&&(n.childExpirationTime=t),null!==i&&(0===i.childExpirationTime||i.childExpirationTime>t)&&(i.childExpirationTime=t),null===n.return&&5===n.tag){e=n.stateNode;break e}n=n.return}e=null}}null!==e&&(!ki&&0!==Si&&t<Si&&Ii(),Fe(e,t),ki&&!Ti&&wi===e||un(e,e.expirationTime),nn>tn&&(nn=0,r("185")))}function _i(e,t,i,n,s){var o=bi;bi=1;try{return e(t,i,n,s)}finally{bi=o}}var Vi=null,qi=null,Li=0,Ui=void 0,Di=!1,Fi=null,zi=0,ji=0,Wi=!1,Qi=!1,Hi=null,Ki=null,Gi=!1,Xi=!1,Zi=!1,Yi=null,Ji=F(),$i=2+(Ji/10|0),en=$i,tn=50,nn=0,sn=null,on=1;function rn(){$i=2+((F()-Ji)/10|0)}function an(e,t){if(0!==Li){if(t>Li)return;null!==Ui&&U(Ui)}Li=t,e=F()-Ji,Ui=L(dn,{timeout:10*(t-2)-e})}function cn(){return Di?en:(ln(),0!==zi&&1073741823!==zi||(rn(),en=$i),en)}function un(e,t){if(null===e.nextScheduledRoot)e.expirationTime=t,null===qi?(Vi=qi=e,e.nextScheduledRoot=e):(qi=qi.nextScheduledRoot=e).nextScheduledRoot=Vi;else{var i=e.expirationTime;(0===i||t<i)&&(e.expirationTime=t)}Di||(Gi?Xi&&(Fi=e,zi=1,hn(e,1,!0)):1===t?pn(1,null):an(e,t))}function ln(){var e=0,t=null;if(null!==qi)for(var i=qi,n=Vi;null!==n;){var s=n.expirationTime;if(0===s){if((null===i||null===qi)&&r("244"),n===n.nextScheduledRoot){Vi=qi=n.nextScheduledRoot=null;break}if(n===Vi)Vi=s=n.nextScheduledRoot,qi.nextScheduledRoot=s,n.nextScheduledRoot=null;else{if(n===qi){(qi=i).nextScheduledRoot=Vi,n.nextScheduledRoot=null;break}i.nextScheduledRoot=n.nextScheduledRoot,n.nextScheduledRoot=null}n=i.nextScheduledRoot}else{if((0===e||s<e)&&(e=s,t=n),n===qi)break;if(1===e)break;i=n,n=n.nextScheduledRoot}}Fi=t,zi=e}function dn(e){if(e.didTimeout&&null!==Vi){rn();var t=Vi;do{var i=t.expirationTime;0!==i&&$i>=i&&(t.nextExpirationTimeToWorkOn=$i),t=t.nextScheduledRoot}while(t!==Vi)}pn(0,e)}function pn(e,t){if(Ki=t,ln(),null!==Ki)for(rn(),en=$i;null!==Fi&&0!==zi&&(0===e||e>=zi)&&(!Wi||$i>=zi);)hn(Fi,zi,$i>=zi),ln(),rn(),en=$i;else for(;null!==Fi&&0!==zi&&(0===e||e>=zi);)hn(Fi,zi,!0),ln();if(null!==Ki&&(Li=0,Ui=null),0!==zi&&an(Fi,zi),Ki=null,Wi=!1,nn=0,sn=null,null!==Yi)for(e=Yi,Yi=null,t=0;t<e.length;t++){var i=e[t];try{i._onComplete()}catch(e){Qi||(Qi=!0,Hi=e)}}if(Qi)throw e=Hi,Hi=null,Qi=!1,e}function hn(e,t,i){if(Di&&r("245"),Di=!0,null===Ki||i){var n=e.finishedWork;null!==n?fn(e,n,t):(e.finishedWork=null,Mi(e,!1,i),null!==(n=e.finishedWork)&&fn(e,n,t))}else null!==(n=e.finishedWork)?fn(e,n,t):(e.finishedWork=null,Mi(e,!0,i),null!==(n=e.finishedWork)&&(mn()?e.finishedWork=n:fn(e,n,t)));Di=!1}function fn(e,t,i){var n=e.firstBatch;if(null!==n&&n._expirationTime<=i&&(null===Yi?Yi=[n]:Yi.push(n),n._defer))return e.finishedWork=t,void(e.expirationTime=0);e.finishedWork=null,e===sn?nn++:(sn=e,nn=0),Ti=ki=!0,e.current===t&&r("177"),0===(i=e.pendingCommitExpirationTime)&&r("261"),e.pendingCommitExpirationTime=0,n=t.expirationTime;var s=t.childExpirationTime;for(n=0===n||0!==s&&s<n?s:n,e.didError=!1,0===n?(e.earliestPendingTime=0,e.latestPendingTime=0,e.earliestSuspendedTime=0,e.latestSuspendedTime=0,e.latestPingedTime=0):(0!==(s=e.latestPendingTime)&&(s<n?e.earliestPendingTime=e.latestPendingTime=0:e.earliestPendingTime<n&&(e.earliestPendingTime=e.latestPendingTime)),0===(s=e.earliestSuspendedTime)?Fe(e,n):n>e.latestSuspendedTime?(e.earliestSuspendedTime=0,e.latestSuspendedTime=0,e.latestPingedTime=0,Fe(e,n)):n<s&&Fe(e,n)),ze(0,e),gi.current=null,1<t.effectTag?null!==t.lastEffect?(t.lastEffect.nextEffect=t,n=t.firstEffect):n=t:n=t.firstEffect,x(e.containerInfo),Pi=n;null!==Pi;){s=!1;var o=void 0;try{for(;null!==Pi;){if(256&Pi.effectTag){var a=Pi.alternate;e:{var c=Pi;switch(c.tag){case 2:case 3:if(256&c.effectTag&&null!==a){var u=a.memoizedProps,l=a.memoizedState,d=c.stateNode;d.props=c.memoizedProps,d.state=c.memoizedState;var p=d.getSnapshotBeforeUpdate(u,l);d.__reactInternalSnapshotBeforeUpdate=p}break e;case 5:case 7:case 8:case 6:break e;default:r("163")}}}Pi=Pi.nextEffect}}catch(e){s=!0,o=e}s&&(null===Pi&&r("178"),Ci(Pi,o),null!==Pi&&(Pi=Pi.nextEffect))}for(Pi=n;null!==Pi;){a=!1,u=void 0;try{for(;null!==Pi;){var h=Pi.effectTag;if(16&h&&j&&te(Pi.stateNode),128&h){var f=Pi.alternate;if(null!==f){var m=f.ref;null!==m&&("function"==typeof m?m(null):m.current=null)}}switch(14&h){case 2:li(Pi),Pi.effectTag&=-3;break;case 6:li(Pi),Pi.effectTag&=-3,pi(Pi.alternate,Pi);break;case 4:pi(Pi.alternate,Pi);break;case 8:l=Pi,j?di(l):ci(l),l.return=null,l.child=null,l.alternate&&(l.alternate.child=null,l.alternate.return=null)}Pi=Pi.nextEffect}}catch(e){a=!0,u=e}a&&(null===Pi&&r("178"),Ci(Pi,u),null!==Pi&&(Pi=Pi.nextEffect))}for(O(e.containerInfo),e.current=t,Pi=n;null!==Pi;){h=!1,f=void 0;try{for(m=i;null!==Pi;){var v=Pi.effectTag;if(36&v){var g=Pi.alternate;switch(u=m,(a=Pi).tag){case 2:case 3:var y=a.stateNode;if(4&a.effectTag)if(null===g)y.props=a.memoizedProps,y.state=a.memoizedState,y.componentDidMount();else{var b=g.memoizedProps,k=g.memoizedState;y.props=a.memoizedProps,y.state=a.memoizedState,y.componentDidUpdate(b,k,y.__reactInternalSnapshotBeforeUpdate)}var N=a.updateQueue;null!==N&&(y.props=a.memoizedProps,y.state=a.memoizedState,$e(0,N,y));break;case 5:var w=a.updateQueue;if(null!==w){if(l=null,null!==a.child)switch(a.child.tag){case 7:l=T(a.child.stateNode);break;case 2:case 3:l=a.child.stateNode}$e(0,w,l)}break;case 7:var S=a.stateNode;null===g&&4&a.effectTag&&X(S,a.type,a.memoizedProps,a);break;case 8:case 6:case 15:case 16:break;default:r("163")}}if(128&v){var E=Pi.ref;if(null!==E){var P=Pi.stateNode;switch(Pi.tag){case 7:var A=T(P);break;default:A=P}"function"==typeof E?E(A):E.current=A}}var I=Pi.nextEffect;Pi.nextEffect=null,Pi=I}}catch(e){h=!0,f=e}h&&(null===Pi&&r("178"),Ci(Pi,f),null!==Pi&&(Pi=Pi.nextEffect))}ki=Ti=!1,"function"==typeof Me&&Me(t.stateNode),v=t.expirationTime,t=t.childExpirationTime,0===(t=0===v||0!==t&&t<v?t:v)&&(Ai=null),e.expirationTime=t,e.finishedWork=null}function mn(){return!!Wi||!(null===Ki||Ki.timeRemaining()>on)&&(Wi=!0)}function vn(e){null===Fi&&r("246"),Fi.expirationTime=0,Qi||(Qi=!0,Hi=e)}function gn(e,t,i,n,s){var o=t.current;return i=function(e){if(!e)return be;e=e._reactInternalFiber;e:{(2!==w(e)||2!==e.tag&&3!==e.tag)&&r("170");var t=e;do{switch(t.tag){case 5:t=t.stateNode.context;break e;case 2:if(Ee(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}break;case 3:if(Ee(t.type._reactResult)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);r("171"),t=void 0}if(2===e.tag){var i=e.type;if(Ee(i))return Ie(e,i,t)}else if(3===e.tag&&Ee(i=e.type._reactResult))return Ie(e,i,t);return t}(i),null===t.context?t.context=i:t.pendingContext=i,t=s,(s=He(n)).payload={element:e},null!==(t=void 0===t?null:t)&&(s.callback=t),Ge(o,s),Ri(o,n),n}var yn={updateContainerAtExpirationTime:gn,createContainer:function(e,t,i){return e={current:t=new Re(5,null,null,t?3:0),containerInfo:e,pendingChildren:null,earliestPendingTime:0,latestPendingTime:0,earliestSuspendedTime:0,latestSuspendedTime:0,latestPingedTime:0,didError:!1,pendingCommitExpirationTime:0,finishedWork:null,timeoutHandle:D,context:null,pendingContext:null,hydrate:i,nextExpirationTimeToWorkOn:0,expirationTime:0,firstBatch:null,nextScheduledRoot:null},t.stateNode=e},updateContainer:function(e,t,i,n){var s=t.current;return gn(e,t,i,s=Bi(cn(),s),n)},flushRoot:function(e,t){Di&&r("253"),Fi=e,zi=t,hn(e,t,!0),pn(1,null)},requestWork:un,computeUniqueAsyncExpiration:function(){var e=2+25*(1+((cn()-2+500)/25|0));return e<=yi&&(e=yi+1),yi=e},batchedUpdates:function(e,t){var i=Gi;Gi=!0;try{return e(t)}finally{(Gi=i)||Di||pn(1,null)}},unbatchedUpdates:function(e,t){if(Gi&&!Xi){Xi=!0;try{return e(t)}finally{Xi=!1}}return e(t)},deferredUpdates:function(e){var t=cn(),i=bi,n=Zi;bi=2+25*(1+((t-2+500)/25|0)),Zi=!1;try{return e()}finally{bi=i,Zi=n}},syncUpdates:_i,interactiveUpdates:function(e,t,i){if(Zi)return e(t,i);Gi||Di||0===ji||(pn(ji,null),ji=0);var n=Zi,s=Gi;Gi=Zi=!0;try{return e(t,i)}finally{Zi=n,(Gi=s)||Di||pn(1,null)}},flushInteractiveUpdates:function(){Di||0===ji||(pn(ji,null),ji=0)},flushControlled:function(e){var t=Gi;Gi=!0;try{_i(e)}finally{(Gi=t)||Di||pn(1,null)}},flushSync:function(e,t){Di&&r("187");var i=Gi;Gi=!0;try{return _i(e,t)}finally{Gi=i,pn(1,null)}},getPublicRootInstance:function(e){if(!(e=e.current).child)return null;switch(e.child.tag){case 7:return T(e.child.stateNode);default:return e.child.stateNode}},findHostInstance:function(e){var t=e._reactInternalFiber;return void 0===t&&("function"==typeof e.render?r("188"):r("268",Object.keys(e))),null===(e=P(t))?null:e.stateNode},findHostInstanceWithNoPortals:function(e){return null===(e=function(e){if(!(e=E(e)))return null;for(var t=e;;){if(7===t.tag||8===t.tag)return t;if(t.child&&6!==t.tag)t.child.return=t,t=t.child;else{if(t===e)break;for(;!t.sibling;){if(!t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}}return null}(e))?null:e.stateNode},injectIntoDevTools:function(e){var t=e.findFiberByHostInstance;return function(e){if("undefined"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)return!1;var t=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(t.isDisabled||!t.supportsFiber)return!0;try{var i=t.inject(e);Me=Be(function(e){return t.onCommitFiberRoot(i,e)}),Ce=Be(function(e){return t.onCommitFiberUnmount(i,e)})}catch(e){}return!0}(s({},e,{findHostInstanceByFiber:function(e){return null===(e=P(e))?null:e.stateNode},findFiberByHostInstance:function(e){return t?t(e):null}}))}};e.exports=yn.default||yn;var bn=e.exports;return e.exports=t,bn}},function(e,t,i){"use strict";e.exports=i(6)},function(e,t,i){"use strict";
/** @license React v16.6.0
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n=i(0),s="function"==typeof Symbol&&Symbol.for,o=s?Symbol.for("react.element"):60103,r=s?Symbol.for("react.portal"):60106,a=s?Symbol.for("react.fragment"):60107,c=s?Symbol.for("react.strict_mode"):60108,u=s?Symbol.for("react.profiler"):60114,l=s?Symbol.for("react.provider"):60109,d=s?Symbol.for("react.context"):60110,p=s?Symbol.for("react.concurrent_mode"):60111,h=s?Symbol.for("react.forward_ref"):60112,f=s?Symbol.for("react.suspense"):60113,m=s?Symbol.for("react.memo"):60115,v=s?Symbol.for("react.lazy"):60116,g="function"==typeof Symbol&&Symbol.iterator;function y(e){for(var t=arguments.length-1,i="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=0;n<t;n++)i+="&args[]="+encodeURIComponent(arguments[n+1]);!function(e,t,i,n,s,o,r,a){if(!e){if(e=void 0,void 0===t)e=Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[i,n,s,o,r,a],u=0;(e=Error(t.replace(/%s/g,function(){return c[u++]}))).name="Invariant Violation"}throw e.framesToPop=1,e}}(!1,"Minified React error #"+e+"; visit %s for the full message or use the non-minified dev environment for full errors and additional helpful warnings. ",i)}var b={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},k={};function N(e,t,i){this.props=e,this.context=t,this.refs=k,this.updater=i||b}function w(){}function S(e,t,i){this.props=e,this.context=t,this.refs=k,this.updater=i||b}N.prototype.isReactComponent={},N.prototype.setState=function(e,t){"object"!=typeof e&&"function"!=typeof e&&null!=e&&y("85"),this.updater.enqueueSetState(this,e,t,"setState")},N.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},w.prototype=N.prototype;var E=S.prototype=new w;E.constructor=S,n(E,N.prototype),E.isPureReactComponent=!0;var P={current:null,currentDispatcher:null},T=Object.prototype.hasOwnProperty,A={key:!0,ref:!0,__self:!0,__source:!0};function I(e,t,i){var n=void 0,s={},r=null,a=null;if(null!=t)for(n in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(r=""+t.key),t)T.call(t,n)&&!A.hasOwnProperty(n)&&(s[n]=t[n]);var c=arguments.length-2;if(1===c)s.children=i;else if(1<c){for(var u=Array(c),l=0;l<c;l++)u[l]=arguments[l+2];s.children=u}if(e&&e.defaultProps)for(n in c=e.defaultProps)void 0===s[n]&&(s[n]=c[n]);return{$$typeof:o,type:e,key:r,ref:a,props:s,_owner:P.current}}function x(e){return"object"==typeof e&&null!==e&&e.$$typeof===o}var O=/\/+/g,M=[];function C(e,t,i,n){if(M.length){var s=M.pop();return s.result=e,s.keyPrefix=t,s.func=i,s.context=n,s.count=0,s}return{result:e,keyPrefix:t,func:i,context:n,count:0}}function B(e){e.result=null,e.keyPrefix=null,e.func=null,e.context=null,e.count=0,10>M.length&&M.push(e)}function R(e,t,i){return null==e?0:function e(t,i,n,s){var a=typeof t;"undefined"!==a&&"boolean"!==a||(t=null);var c=!1;if(null===t)c=!0;else switch(a){case"string":case"number":c=!0;break;case"object":switch(t.$$typeof){case o:case r:c=!0}}if(c)return n(s,t,""===i?"."+_(t,0):i),1;if(c=0,i=""===i?".":i+":",Array.isArray(t))for(var u=0;u<t.length;u++){var l=i+_(a=t[u],u);c+=e(a,l,n,s)}else if(l=null===t||"object"!=typeof t?null:"function"==typeof(l=g&&t[g]||t["@@iterator"])?l:null,"function"==typeof l)for(t=l.call(t),u=0;!(a=t.next()).done;)c+=e(a=a.value,l=i+_(a,u++),n,s);else"object"===a&&y("31","[object Object]"==(n=""+t)?"object with keys {"+Object.keys(t).join(", ")+"}":n,"");return c}(e,"",t,i)}function _(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+(""+e).replace(/[=:]/g,function(e){return t[e]})}(e.key):t.toString(36)}function V(e,t){e.func.call(e.context,t,e.count++)}function q(e,t,i){var n=e.result,s=e.keyPrefix;e=e.func.call(e.context,t,e.count++),Array.isArray(e)?L(e,n,i,function(e){return e}):null!=e&&(x(e)&&(e=function(e,t){return{$$typeof:o,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(e,s+(!e.key||t&&t.key===e.key?"":(""+e.key).replace(O,"$&/")+"/")+i)),n.push(e))}function L(e,t,i,n,s){var o="";null!=i&&(o=(""+i).replace(O,"$&/")+"/"),R(e,q,t=C(t,o,n,s)),B(t)}var U={Children:{map:function(e,t,i){if(null==e)return e;var n=[];return L(e,n,null,t,i),n},forEach:function(e,t,i){if(null==e)return e;R(e,V,t=C(null,null,t,i)),B(t)},count:function(e){return R(e,function(){return null},null)},toArray:function(e){var t=[];return L(e,t,null,function(e){return e}),t},only:function(e){return x(e)||y("143"),e}},createRef:function(){return{current:null}},Component:N,PureComponent:S,createContext:function(e,t){return void 0===t&&(t=null),(e={$$typeof:d,_calculateChangedBits:t,_currentValue:e,_currentValue2:e,Provider:null,Consumer:null}).Provider={$$typeof:l,_context:e},e.Consumer=e},forwardRef:function(e){return{$$typeof:h,render:e}},lazy:function(e){return{$$typeof:v,_ctor:e,_status:-1,_result:null}},memo:function(e,t){return{$$typeof:m,type:e,compare:void 0===t?null:t}},Fragment:a,StrictMode:c,unstable_ConcurrentMode:p,Suspense:f,unstable_Profiler:u,createElement:I,cloneElement:function(e,t,i){(null===e||void 0===e)&&y("267",e);var s=void 0,r=n({},e.props),a=e.key,c=e.ref,u=e._owner;if(null!=t){void 0!==t.ref&&(c=t.ref,u=P.current),void 0!==t.key&&(a=""+t.key);var l=void 0;for(s in e.type&&e.type.defaultProps&&(l=e.type.defaultProps),t)T.call(t,s)&&!A.hasOwnProperty(s)&&(r[s]=void 0===t[s]&&void 0!==l?l[s]:t[s])}if(1===(s=arguments.length-2))r.children=i;else if(1<s){l=Array(s);for(var d=0;d<s;d++)l[d]=arguments[d+2];r.children=l}return{$$typeof:o,type:e.type,key:a,ref:c,props:r,_owner:u}},createFactory:function(e){var t=I.bind(null,e);return t.type=e,t},isValidElement:x,version:"16.6.0",__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:{ReactCurrentOwner:P,assign:n}},D={default:U},F=D&&U||D;e.exports=F.default||F},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();t.createElement=function(e,t){var i={Song:function(){return new o(t)},Note:function(){return function(e){var t=e.ticks,i=e.number,n=e.duration,o=e.velocity,r=(e.panning,s.createMidiEvent(t,SongModule.NOTE_ON,i||0,o||0)),a=s.createMidiEvent(t+n,SongModule.NOTE_OFF,i||0,0);return{type:"notes",notes:[r,a]}}(t)},Midi:function(){return function(e){var t=e.base64;if(t){var i=s.createMidiFile.bind(this,{base64:t});return{type:"midi",midi:i}}}(t)}};return i[e]?i[e]():console.error(e+" ins't a valid element type")},i(8);var s=window.sequencer,o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.notes=[],this.midi=null,this.config={metronome:t.metronome||!0,bpm:t.bpm||60,bars:t.bars||4}}return n(e,[{key:"setMIDI",value:function(e){this.midi=e}},{key:"addSequence",value:function(e){this.notes=this.notes.concat(e)}},{key:"render",value:function(){var e=this.notes,t=this.midi,i=this.config,n=i.metronome,o=i.bpm,r=i.bars;if(t)return t().then(function(e){var t=s.createSong(e),i=new CustomEvent("songCreated",{bubbles:!0,detail:t});window.document.body.dispatchEvent(i),t.play()},function(e){console.warn(e)});var a=s.createSong({bars:r,bpm:o,events:e,useMetronome:n});window.reactSong=a;var c=new CustomEvent("songCreated",{bubbles:!0,detail:a});window.document.body.dispatchEvent(c),a.play()}}]),e}()},function(e,t,i){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){var e,t,i,n,s,o,r=window.alert,a=(window.console,[]),c=!1,u=0,l=["threshold","knee","ratio","reduction","attack","release"],d=navigator.userAgent;if(d.match(/(iPad|iPhone|iPod)/g)?s="ios":-1!==d.indexOf("Android")?s="android":-1!==d.indexOf("Linux")?s="linux":-1!==d.indexOf("Macintosh")?s="osx":-1!==d.indexOf("Windows")&&(s="windows"),-1!==d.indexOf("Chrome")?(o="chrome",-1!==d.indexOf("OPR")?o="opera":-1!==d.indexOf("Chromium")&&(o="chromium")):-1!==d.indexOf("Safari")?o="safari":-1!==d.indexOf("Firefox")?o="firefox":-1!==d.indexOf("Trident")&&(o="Internet Explorer"),"ios"===s&&-1!==d.indexOf("CriOS")&&(o="chrome"),window.AudioContext)void 0===(t=new window.AudioContext).createGainNode&&(t.createGainNode=t.createGain);else if(window.webkitAudioContext)t=new window.webkitAudioContext;else if(window.oAudioContext)t=new window.oAudioContext;else{if(!window.msAudioContext)return window.sequencer={browser:o,os:s},r("The WebAudio API hasn't been implemented in "+o+", please use any other browser"),void(window.sequencer.ready=function(e){e()});t=new window.msAudioContext}t.createBufferSource().start,navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame,window.Blob=window.Blob||window.webkitBlob||window.mozBlob,(n=t.createDynamicsCompressor()).connect(t.destination),(i=t.createGainNode()).connect(t.destination),i.gain.value=1,e={context:t,masterGainNode:i,masterCompressor:n,useDelta:!1,timedTasks:{},scheduledTasks:{},repetitiveTasks:{},getSampleId:function(){return"S"+u+++(new Date).getTime()},addInitMethod:function(e){a.push(e)},callInitMethods:function(){var e,t=a.length;for(e=0;e<t;e++)a[e]()}},window.sequencer={name:"qambi",protectedScope:e,ui:{},ua:d,os:s,browser:o,legacy:!1,midi:!1,webmidi:!1,webaudio:!0,jazz:!1,ogg:!1,mp3:!1,record_audio:void 0!==navigator.getUserMedia,bitrate_mp3_encoding:128,util:{},debug:4,defaultInstrument:"sinewave",pitch:440,bufferTime:.35,autoAdjustBufferTime:!1,noteNameMode:"sharp",minimalSongLength:6e4,pauseOnBlur:!1,restartOnFocus:!0,defaultPPQ:960,overrulePPQ:!0,precision:3,midiInputs:{},midiOutputs:{},storage:{midi:{id:"midi"},audio:{id:"audio",recordings:{}},instruments:{id:"instruments"},samplepacks:{id:"samplepacks"},assetpacks:{id:"assetpacks"}},getAudioContext:function(){return t},getTime:function(){return t.currentTime},setMasterVolume:function(e){e=e<0?0:e>1?1:e,i.gain.value=e},getMasterVolume:function(){return i.gain.value},getCompressionReduction:function(){return n.reduction.value},enableMasterCompressor:function(e){e?(i.disconnect(0),i.connect(n),n.disconnect(0),n.connect(t.destination)):(n.disconnect(0),i.disconnect(0),i.connect(t.destination))},configureMasterCompressor:function(e){var t,i;for(t=l.length;t>=0;t--)void 0!==e[i=l[t]]&&(n[i].value=e[i])},unlockWebAudio:function(){if(!0!==c){"function"==typeof t.resume&&t.resume();var e=t.createOscillator(),i=t.createGainNode();i.gain.value=0,e.connect(i),i.connect(t.destination),void 0!==e.noteOn&&(e.start=e.noteOn,e.stop=e.noteOff),e.start(0),e.stop(.001),c=!0}}},Object.defineProperty(sequencer,"ERROR",{value:1}),Object.defineProperty(sequencer,"WARN",{value:2}),Object.defineProperty(sequencer,"INFO",{value:3}),Object.defineProperty(sequencer,"LOG",{value:4})}(),function(){var e,t,i,n,s,o,r,a=window.sequencer,c=window.console,u=!1,l=0,d={},p=[],h=[];a.removeMidiFile=function(i){var o,r,a=[];for("MidiFile"===i.className?i=(o=i).localPath:o=e(i,s.midi),"MidiFile"===o.className?a.push(o):n(o,function(e){"MidiFile"===e.className&&a.push(e)}),r=a.length-1;r>=0;r--)o=a[r],t(o.localPath,s.midi)},a.removeInstrument=function(i,r){var a,c,u,l,d,p=[];if("InstrumentConfig"===i.className?i=(a=i).localPath:a=e(i,s.instruments),"InstrumentConfig"===a.className)p.push(a);else for(c in u=a)u.hasOwnProperty(c)&&"InstrumentConfig"===(a=u[c]).className&&p.push(a);for(c=p.length-1;c>=0;c--)l=(a=p[c]).mapping,d=a.sample_path,!0===r&&(n(l,function(e){t(d+"/"+e.n,s.audio)}),t(d,s.samplepacks)),t(a.localPath,s.instruments);o()},a.removeSamplePack=function(i){var r,a,c,u,l,d=[];for("SamplePack"===i.className?i=(r=i).localPath:r=e(i,s.samplepacks),"SamplePack"===r.className?d.push(r):n(r,function(e){"SamplePack"===e.className&&d.push(e)}),a=d.length-1;a>=0;a--){for(l=(c=(r=d[a]).samples).length-1;l>=0;l--)u=c[l],t(u.folder+"/"+u.id,s.audio);r.reset(),t(r.localPath,s.samplepacks)}o()},a.removeAssetPack=function(t){var i;"AssetPack"===t.className?t=(i=t).localPath:i=e(t,s.assetpacks),"AssetPack"===i.className?i.unload():n(i,function(e){"AssetPack"===e.className&&e.unload()})},a.startTaskQueue=function(e){!0!==u&&(u=!0,function e(t,n){var s,o,r,a,f,m,v,g;if(t===p.length){for(a=h.length-1;a>=0;a--)if(!1!==(m=h[a])){var y=m.method;setTimeout(function(){y()},0)}return d={},p=[],h=[],l=0,u=!1,void(n&&(c.log("onTaskQueueDone"),n()))}s=p[t];r=s.scope||null;o=s.params||[];"array"!==i(o)&&(o=[o]);function b(i){for(d[s.id]=!0,a=h.length-1;a>=0;a--)if(!1!==(m=h[a])&&void 0!==(v=m.taskIds)){for(g=!0,f=v.length-1;f>=0;f--)!0!==d[v[f]]&&(g=!1);if(g){var o=m.method;h[a]=!1,setTimeout(function(){o(i)},0)}}e(++t,n)}o.push(function b(e){for(d[s.id]=!0,a=h.length-1;a>=0;a--)if(!1!==(m=h[a])&&void 0!==(v=m.taskIds)){for(g=!0,f=v.length-1;f>=0;f--)!0!==d[v[f]]&&(g=!1);if(g){var o=m.method;h[a]=!1,setTimeout(function(){o(e)},0)}}!function e(t,n){var s,o,r,a,f,m,v,g;if(t===p.length){for(a=h.length-1;a>=0;a--)if(!1!==(m=h[a])){var y=m.method;setTimeout(function(){y()},0)}return d={},p=[],h=[],l=0,u=!1,void(n&&(c.log("onTaskQueueDone"),n()))}s=p[t];r=s.scope||null;o=s.params||[];"array"!==i(o)&&(o=[o]);function b(i){for(d[s.id]=!0,a=h.length-1;a>=0;a--)if(!1!==(m=h[a])&&void 0!==(v=m.taskIds)){for(g=!0,f=v.length-1;f>=0;f--)!0!==d[v[f]]&&(g=!1);if(g){var o=m.method;h[a]=!1,setTimeout(function(){o(i)},0)}}e(++t,n)}o.push(b);s.method.apply(r,o)}(++t,n)});s.method.apply(r,o)}(0,e))},a.addTask=function(e,t,i){return e.id="task"+l++,p.push(e),void 0!==t&&(!0===i?a.addCallbackAfterTask(t):a.addCallbackAfterTask(t,[e.id])),e.id},a.addCallbackAfterTask=function(e,t){h.push({method:e,taskIds:t})},a.getInstrument=function(t,i){return e(t,s.instruments,i)},a.getMidiFile=function(t,i){return e(t,s.midi,i)},a.getSamplePack=function(t,i){return e(t,s.samplepacks,i)},a.getSample=function(t,i){return e(t,s.audio,i)},a.getAssetPack=function(t,i){return e(t,s.assetpacks,i)},a.getSamplePacks=function(e,t){return r(e,s.samplepacks,t)},a.getAssetPacks=function(e,t){return r(e,s.assetpacks,t)},a.getSamples=function(e,t){return r(e,s.audio,t)},a.getInstruments=function(e,t){return r(e,s.instruments,t)},a.getMidiFiles=function(e,t){return r(e,s.midi,t)},a.protectedScope.addInitMethod(function(){s=a.storage,a.protectedScope.loadLoop,e=a.protectedScope.findItem,a.protectedScope.storeItem,t=a.protectedScope.deleteItem,i=a.protectedScope.typeString,a.protectedScope.getArguments,a.protectedScope.isEmptyObject,n=a.protectedScope.objectForEach,o=a.protectedScope.updateInstruments,r=a.protectedScope.findItemsInFolder})}(),function(){var e,t,i,n,s,o,r,a,c,u,l,d,p,h=window.sequencer,f=window.console,m=0;function v(e,n){void 0!==e.url?t({url:e.url,responseType:"json",onError:function(e){!function(e,t){t(!1)}(0,n)},onSuccess:function(t,s){null!==t?(e.loaded=!0,void 0!==t.name&&void 0===e.name&&(e.name=t.name),void 0!==t.folder&&void 0===e.folder&&(e.folder=t.folder),void 0===e.name&&(e.name=i(e.url).name),e.localPath=void 0!==e.folder?e.folder+"/"+e.name:e.name,e.filesize=s,t.instruments&&(e.instruments=e.instruments.concat(t.instruments)),t.samplepacks&&(e.samplepacks=e.samplepacks.concat(t.samplepacks)),t.midifiles&&(e.midifiles=e.midifiles.concat(t.midifiles)),g(e,n)):n(!1)}}):(e.localPath=void 0!==e.folder?e.folder+"/"+e.name:e.name,g(e,n))}function g(e,t){var i,o,r,a=function(e){var t=n(e.localPath,h.storage.assetpacks,!0),i=e.action;return t&&"AssetPack"===t.className&&"overwrite"!==i?(h.debug>=2&&f.warn("there is already an AssetPack at",e.localPath),!0):(s(e,e.localPath,h.storage.assetpacks),!1)}(e),c=e.localPath;if(!0!==a){if(void 0!==e.url){var l,d,p=h.storage.assetpacks,m=null;for(d in p)if("AssetPack"===(l=p[d]).className&&l.id!==e.id&&l.url===e.url){m=l;break}if(null!==m)return c=e.localPath,u(c),e=null,void t(e=n(m.localPath,h.storage.assetpacks,!0))}for(i=(o=e.midifiles).length-1;i>=0;i--)(r=o[i]).pack=e,h.addMidiFile(r);for(i=(o=e.instruments).length-1;i>=0;i--)(r=o[i]).pack=e,h.addInstrument(r);for(i=(o=e.samplepacks).length-1;i>=0;i--)(r=o[i]).pack=e,h.addSamplePack(r);t(e)}else t(e=n(c,h.storage.assetpacks,!0))}(p=function(e){this.id="AP"+m+++(new Date).getTime(),this.name=this.id,this.className="AssetPack",this.loaded=!1,this.midifiles=e.midifiles||[],this.samplepacks=e.samplepacks||[],this.instruments=e.instruments||[],this.url=e.url;var t=this;a(e,function(e,i){t[i]=e})}).prototype.unload=function(){var t,i,n;for(t=(i=this.midifiles).length-1;t>=0;t--)n=i[t],c(n.folder+"/"+n.name);for(t=(i=this.instruments).length-1;t>=0;t--)n=i[t],l(n.folder+"/"+n.name);for(t=(i=this.samplepacks).length-1;t>=0;t--)n=i[t],d(n.folder+"/"+n.name);o(this.localPath,e.assetpacks)},h.addAssetPack=function(e,t){var i,n,s;if("object"!==r(e))return h.debug>=2&&f.warn("can't create an AssetPack with this data",e),!1;if(void 0===t&&(t=function(){}),e.json){if(i=e.json,n=e.name,s=e.folder,"string"===r(i))try{i=JSON.parse(i)}catch(t){return h.debug>=2&&f.warn("can't create an AssetPack with this data",e),!1}if(void 0===i.instruments&&void 0===i.midifiles&&void 0===i.samplepacks)return h.debug>=2&&f.warn("can't create an AssetPack with this data",e),!1;e={midifiles:i.midifiles,instruments:i.instruments,samplepacks:i.samplepacks,name:void 0===n?i.name:n,folder:void 0===s?i.folder:s}}h.addTask({type:"load asset pack",method:v,params:new p(e)},function(i){e=null,t(i)},!0),h.startTaskQueue()},h.protectedScope.addInitMethod(function(){t=h.protectedScope.ajax,h.protectedScope.round,i=h.protectedScope.parseUrl,n=h.protectedScope.findItem,s=h.protectedScope.storeItem,o=h.protectedScope.deleteItem,r=h.protectedScope.typeString,a=h.protectedScope.objectForEach,e=h.storage,c=h.removeMidiFile,l=h.removeInstrument,d=h.removeSamplePack,u=h.removeAssetPack})}(),function(){var e,t,i,n,s,o,r,a,c=window.sequencer,u=window.console;c.encodeAudio=function(r,l,d,p){if("mp3"===l){var h=function(e){if(1===e.numberOfChannels)return e.getChannelData(0);if(2===e.numberOfChannels){var t,i=e.getChannelData(0),n=e.getChannelData(1),s=i.length,o=new Float32Array(s),r=0;for(t=0;t<s;t++)o[r++]=i[t],o[r++]=n[t];return o}}(r);d=d||c.bitrate_mp3_encoding,void 0===a&&((a=function(){var n=new Blob(["(",function(){var n,s;t("https://raw.githubusercontent.com/kobigurk/libmp3lame-js/master/dist/libmp3lame.min.js"),e.onmessage=function(t){switch(t.data.cmd){case"init":t.data.config||(t.data.config={}),n=i.init(),i.set_mode(n,t.data.config.mode||i.JOINT_STEREO),i.set_num_channels(n,t.data.config.channels||2),i.set_num_samples(n,t.data.config.samples||-1),i.set_in_samplerate(n,t.data.config.samplerate||44100),i.set_out_samplerate(n,t.data.config.samplerate||44100),i.set_bitrate(n,t.data.config.bitrate||128),i.init_params(n);break;case"encode":s=i.encode_buffer_ieee_float(n,t.data.buf,t.data.buf),e.postMessage({cmd:"data",buf:s.data});break;case"finish":s=i.encode_flush(n),e.postMessage({cmd:"end",buf:s.data}),i.close(n),n=null}}}.toString(),")()"],{type:"application/javascript"});return new Worker(URL.createObjectURL(n))}()).onmessage=function(e){"data"===e.data.cmd&&p({blob:new Blob([new Uint8Array(e.data.buf)],{type:"audio/mp3"}),base64:s(e.data.buf),dataUrl:"data:audio/mp3;base64,"+n(e.data.buf)})}),a.postMessage({cmd:"init",config:{mode:3,channels:1,samplerate:o.sampleRate,bitrate:d}}),a.postMessage({cmd:"encode",buf:h}),a.postMessage({cmd:"finish"})}else"ogg"===l?(c.debug>=c.WARN&&u.warn("support for ogg is not yet implemented"),p(!1)):(c.debug>=c.WARN&&u.warn("unsupported type",l),p(!1))},c.protectedScope.cleanupAudioEncoder=function(){void 0!==a&&a.terminate(),void 0!==r&&r.terminate()},c.protectedScope.addInitMethod(function(){n=c.util.encode64,s=c.util.base64EncArr,o=c.protectedScope.context})}(),function(){var e,t,i=window.console,n=window.sequencer,s=Array.prototype.slice;(t=function(t){if(void 0!==t)if(void 0===t.ticks?this.ticks=0:this.ticks=t.ticks,this.buffer=t.buffer,this.sampleId=t.sampleId,this.path=t.path,void 0!==this.buffer||void 0!==this.path)if(void 0===this.buffer||"audiobuffer"===e(this.buffer)){if(void 0!==this.path){if("string"!==e(this.path))return void(n.debug>=n.WARN&&i.warn("path has to be a String"));if(this.sampleId=this.path,this.sampleId=this.sampleId.replace(/^\//,""),this.sampleId=this.sampleId.replace(/\/$/,""),this.sampleId=this.sampleId.split("/"),this.sampleId=this.sampleId[this.sampleId.length-1],this.buffer=n.getSample(this.path),!1===this.buffer)return void(n.debug>=n.WARN&&i.warn("no sample found at",this.path));this.buffer=n.getSample(this.path)}this.durationTicks=t.durationTicks,this.durationMillis=t.durationMillis,void 0===this.durationTicks&&void 0===this.durationMillis&&(this.duration=this.buffer.duration,this.durationMillis=1e3*this.duration),this.muted=!1,void 0===t.velocity?this.velocity=127:this.velocity=t.velocity,this.sampleOffsetTicks=t.sampleOffsetTicks,this.sampleOffsetMillis=t.sampleOffsetMillis,void 0===this.sampleOffsetMillis&&void 0===this.sampleOffsetTicks?(this.sampleOffsetTicks=0,this.sampleOffsetMillis=0,this.sampleOffset=0):void 0!==this.sampleOffsetMillis&&(this.sampleOffset=this.sampleOffsetMillis/1e3),this.latencyCompensation=t.latencyCompensation,void 0===this.latencyCompensation&&(this.latencyCompensation=0),this.playheadOffset=0,this.className="AudioEvent",this.time=0,this.type="audio",this.id="A0"+(new Date).getTime()}else n.debug>=n.WARN&&i.warn("buffer has to be an AudioBuffer");else n.debug>=n.WARN&&i.warn("please provide an AudioBuffer or a path to a sample in the sequencer.storage object")}).prototype.update=function(){var e;void 0===this.duration?(e=this.song.getPosition("ticks",this.ticks+this.durationTicks),this.durationMillis=e.millis-this.millis,this.duration=this.durationMillis/1e3):void 0===this.durationTicks&&(e=this.song.getPosition("millis",this.millis+this.durationMillis),this.durationTicks=e.ticks-this.ticks),void 0===this.sampleOffset?(e=this.song.getPosition("ticks",this.ticks+this.sampleOffsetTicks),this.sampleOffsetMillis=e.millis-this.millis,this.sampleOffset=this.sampleOffsetMillis/1e3):void 0===this.sampleOffsetTicks&&(e=this.song.getPosition("millis",this.millis+this.sampleOffsetMillis),this.sampleOffsetTicks=e.ticks-this.ticks),this.endTicks=this.ticks+this.durationTicks,this.endMillis=this.millis+this.durationMillis},t.prototype.stopSample=function(e){this.track.audio.stopSample(this,e)},t.prototype.setSampleOffset=function(e,t){"millis"===e?(this.sampleOffsetMillis=t,this.sampleOffset=t/1e3,this.durationTicks=void 0,void 0!==this.song&&this.update()):"ticks"===e?(this.sampleOffsetTicks=t,this.sampleOffset=void 0,this.sampleOffsetMillis=void 0,void 0!==this.song&&this.update()):n.debug>=n.WARN&&i.warn('you have to provide a type "ticks" or "millis" and a value')},t.prototype.setDuration=function(e,t){"millis"===e?(this.durationMillis=t,this.duration=t/1e3,this.durationTicks=void 0,void 0!==this.song&&this.update()):"ticks"===e?(this.durationTicks=t,this.duration=void 0,this.durationMillis=void 0,void 0!==this.song&&this.update()):n.debug>=n.WARN&&i.warn('you have to provide a type "ticks" or "millis" and a value')},t.prototype.clone=t.prototype.copy=function(){var e,i=new t;for(e in this)this.hasOwnProperty(e)&&("id"!==e&&"eventNumber"!==e&&(i[e]=this[e]),i.song=void 0,i.track=void 0,i.trackId=void 0,i.part=void 0,i.partId=void 0);return i},t.prototype.reset=function(e,t,i){t=void 0===t,i=void 0===i,(e=void 0===e)&&(this.part=void 0,this.partId=void 0),t&&(this.track=void 0,this.trackId=void 0,this.channel=0),i&&(this.song=void 0)},t.prototype.move=function(e){isNaN(e)?n.debug>=1&&i.error("please provide a number"):(this.ticks+=parseInt(e,10),void 0!==this.song&&this.update(),"new"!==this.state&&(this.state="changed"),void 0!==this.part&&(this.part.needsUpdate=!0))},t.prototype.moveTo=function(){var e=s.call(arguments);"ticks"===e[0]&&!1===isNaN(e[1])?this.ticks=parseInt(e[1],10):void 0===this.song?n.debug>=1&&i.error("The audio event has not been added to a song yet; you can only move to ticks values"):!1===(e=this.song.getPosition(e))?n.debug>=1&&i.error("wrong position data"):this.ticks=e.ticks,void 0!==this.song&&this.update(),"new"!==this.state&&(this.state="changed"),void 0!==this.part&&(this.part.needsUpdate=!0)},n.createAudioEvent=function(e){return"AudioEvent"===e.className?e.clone():new t(e)},n.protectedScope.addInitMethod(function(){e=n.protectedScope.typeString})}(),function(){var e,t,i,n,s,o,r=window.sequencer,a=window.console,c=null,u={height:200,width:800,sampleStep:1,color:"#71DE71",bgcolor:"#000"};function l(s){this.track=s,this.song=s.song,this.audioEvents={},this.callback=null,this.worker=i(),this.waveformConfig=s.waveformConfig||u;var o=this;this.worker.onmessage=function(i){!function(i,s,o,c){e.decodeAudioData(s,function(e){var a=t(s),u={id:i.recordId,audioBuffer:e,wavArrayBuffer:s,wav:{blob:new Blob([new Uint8Array(s)],{type:"audio/wav"}),base64:a,dataUrl:"data:audio/wav;base64,"+a},waveform:{}};u.interleavedSamples="new"===c?o:r.storage.audio.recordings[i.recordId].interleavedSamples,n(e,i.waveformConfig,function(e){u.waveform={dataUrls:e},r.storage.audio.recordings[i.recordId]=u,null!==i.callback&&(i.callback(u),i.callback=null)})},function(){r.debug>=r.WARN&&a.warn("no valid audiodata")})}(o,i.data.wavArrayBuffer,i.data.interleavedSamples,i.data.id)}}l.prototype.prepare=function(e,t){var i=this;this.recordId=e,null===c?function(e){navigator.getUserMedia({audio:!0},function(t){c=!0,s=t,e()},function(t){r.debug>=r.WARN&&a.log(t),c=!1,e()})}(function(){t(c),void 0!==s&&i.start()}):(t(c),void 0!==s&&this.start())},l.prototype.start=function(){var t=this,i=this.track.song;t.worker.postMessage({command:"init",sampleRate:e.sampleRate}),this.scriptProcessor=e.createScriptProcessor(8192,1,1),this.scriptProcessor.onaudioprocess=function(e){1===e.inputBuffer.numberOfChannels?t.worker.postMessage({command:"record_mono",buffer:e.inputBuffer.getChannelData(0)}):t.worker.postMessage({command:"record_stereo",buffer:[e.inputBuffer.getChannelData(0),e.inputBuffer.getChannelData(1)]}),!1===i.recording&&!1===i.precounting&&t.createAudio()},this.sourceNode=e.createMediaStreamSource(s),this.sourceNode.connect(this.scriptProcessor),this.scriptProcessor.connect(e.destination)},l.prototype.stop=function(t){this.stopRecordingTimestamp=1e3*e.currentTime,this.timestamp=window.performance.now(),void 0!==this.sourceNode?this.callback=t:t()},l.prototype.createAudio=function(){this.sourceNode.disconnect(this.scriptProcessor),this.scriptProcessor.disconnect(e.destination),this.scriptProcessor.onaudioprocess=null,this.sourceNode=null,this.scriptProcessors=null;var t=parseInt((this.song.metronome.precountDurationInMillis+this.song.audioRecordingLatency)/o);this.worker.postMessage({command:"get_wavfile",bufferIndexStart:t,bufferIndexEnd:-1})},l.prototype.setAudioRecordingLatency=function(e,t,i){var n=parseInt(t/o);this.callback=i,this.worker.postMessage({command:"update_wavfile",samples:r.storage.audio.recordings[e].interleavedSamples,bufferIndexStart:n,bufferIndexEnd:-1})},l.prototype.cleanup=function(){void 0!==s?(this.scriptProcessor.disconnect(),this.scriptProcessor.onaudioprocess=null,this.sourceNode.disconnect(),this.scriptProcessor=null,this.sourceNode=null,this.worker.terminate()):this.worker.terminate()},r.protectedScope.createAudioRecorder=function(e){return!1!==r.record_audio&&new l(e)},r.protectedScope.addInitMethod(function(){t=r.util.encode64,e=r.protectedScope.context,n=r.getWaveformData,i=r.protectedScope.createAudioRecorderWorker,o=1/e.sampleRate*1e3,r.protectedScope.songDispatchEvent,8192*o})}(),function(){var e=window.sequencer;window.console;function t(){var e,t,i,n,s,o,r,a,c,u;function l(e,t){for(var i=new Float32Array(t),n=0,s=0,o=e.length;s<o;s++)i.set(e[s],n),n+=e[s].length;return i}function d(e,t){for(var i=e.length+t.length,n=new Float32Array(i),s=0,o=0;s<i;)n[s++]=e[o],n[s++]=t[o],o++;return n}function p(e,t,i){for(var n=0;n<i.length;n++)e.setUint8(t+n,i.charCodeAt(n))}function h(e){var t=new ArrayBuffer(44+2*e.length),i=new DataView(t);return p(i,0,"RIFF"),i.setUint32(4,36+2*e.length,!0),p(i,8,"WAVE"),p(i,12,"fmt "),i.setUint32(16,16,!0),i.setUint16(20,1,!0),i.setUint16(22,u,!0),i.setUint32(24,c,!0),i.setUint32(28,c*u*2,!0),i.setUint16(32,2*u,!0),i.setUint16(34,16,!0),p(i,36,"data"),i.setUint32(40,2*e.length,!0),function(e,t,i){for(var n=0;n<i.length;n++,t+=2){var s=Math.max(-1,Math.min(1,i[n]));e.setInt16(t,s<0?32768*s:32767*s,!0)}}(i,44,e),i}self.onmessage=function(p){switch(p.data.command){case"init":c=p.data.sampleRate,o=0,r=[],a=[];break;case"record_mono":u=1,r.push(p.data.buffer),o+=p.data.buffer.length;break;case"record_stereo":u=2,r.push(p.data.buffer[0]),a.push(p.data.buffer[1]),o+=p.data.buffer[0].length;break;case"get_wavfile":t=p.data.bufferIndexStart,i=p.data.bufferIndexEnd,e={id:"new",wavArrayBuffer:function(){var e,n,c=0;1===u?s=l(r,o):2===u&&(s=d(l(r,o),l(a,o)));if(i>0||t>0){for(-1===i&&(i=s.length),n=new Float32Array(i-t+1),e=t;e<i;e++)n[c++]=s[e];s=n}return h(s).buffer}(),interleavedSamples:s},self.postMessage(e,[e.wavArrayBuffer,e.interleavedSamples.buffer]);break;case"get_wavfile2":t=p.data.bufferIndexStart,i=p.data.bufferIndexEnd,(e=function(){var e,c,p,f,m,v=0;1===u?f=l(r,o):2===u&&(f=l(r,o),m=l(a,o));if(i>0||t>0)for(-1===i&&(i=f.length),p=new Float32Array(i-t+1),2===u&&new Float32Array(i-t+1),c=t;c<i;c++)p[v]=f[c],2===u&&m[c],v++;if(1===u)for(n=f,s=new Float32Array(o),c=0;c<o;c++)s[c]=n[c];else 2===u&&(n=function(e,t){var i=e.length,n=new Float32Array(2*i),s=0,o=0;for(;s<i;)n[s++]=e[o++];s=0;for(;s<i;)n[s++]=t[o++];return n}(f,m),s=d(f,m));return e=h(s),{planarSamples:n.buffer,interleavedSamples:s.buffer,wavArrayBuffer:e.buffer}}()).id="new",self.postMessage(e,[e.planarSamples,e.interleavedSamples,e.wavArrayBuffer]);break;case"update_wavfile":t=p.data.bufferIndexStart,i=p.data.bufferIndexEnd,s=p.data.samples,e={id:"update",wavArrayBuffer:function(){var e,n,o=0;-1===i&&(i=s.length);for(n=new Float32Array(i-t+1),e=t;e<i;e++)n[o++]=s[e];return h(n).buffer}()},self.postMessage(e,[e.wavArrayBuffer])}}}e.protectedScope.createAudioRecorderWorker=function(){var e=URL.createObjectURL(new Blob(["(",t.toString(),")()"],{type:"application/javascript"}));return new Worker(e)}}(),function(){window.console;var e,t,i,n=window.sequencer;Array.prototype.slice;t=function(e){delete this.scheduledSamples[e.id],e=null},(i=function(t){this.track=t,this.className="AudioTrack",this.scheduledSamples={},this.recorder=e(t)}).prototype.setAudioRecordingLatency=function(e,t,i){this.recorder.setAudioRecordingLatency(e,t,i)},i.prototype.processEvent=function(e){var t=n.createSample({buffer:e.buffer,track:e.track});e.sample=t,e.offset=e.sampleOffset+e.playheadOffset,e.playheadOffset=0,t.start(e),this.scheduledSamples[t.id]=t},i.prototype.stopSample=function(e,i){void 0!==e.sample&&e.sample.stop(i,t.bind(this))},i.prototype.allNotesOff=function(){var e,i,n=this.scheduledSamples;for(e in n)n.hasOwnProperty(e)&&(i=n[e])&&i.unschedule(0,t.bind(this));this.scheduledSamples={}},i.prototype.prepareForRecording=function(e,t){if(!1===this.recorder)return!1;this.recorder.prepare(e,t)},i.prototype.stopRecording=function(e){this.recorder.stop(function(t){e(t)})},n.protectedScope.createAudioTrack=function(e){return new i(e)},n.protectedScope.addInitMethod(function(){n.protectedScope.typeString,e=n.protectedScope.createAudioRecorder})}(),function(){var e,t,i,n,s,o,r,a,c,u=window.sequencer,l=window.console,d=0;function p(t){this.id="FX"+d+++(new Date).getTime(),this.type=t.type,this.buffer=t.buffer,this.config=t,this.bypass=!1,this.amount=0,this.output=e.createGainNode(),this.wetGain=e.createGainNode(),this.dryGain=e.createGainNode(),this.output.gain.value=1,this.wetGain.gain.value=this.amount,this.dryGain.gain.value=1-this.amount}p.prototype.setInput=function(e){e.connect(this.dryGain),this.dryGain.connect(this.output),e.connect(this.node),this.node.connect(this.wetGain),this.wetGain.connect(this.output)},p.prototype.setAmount=function(e){this.amount=e<0?0:e>1?1:e,this.wetGain.gain.value=this.amount,this.dryGain.gain.value=1-this.amount},p.prototype.copy=function(){switch(this.type){case"reverb":return new n(this.config);case"panner":return new s(this.config);case"panner2":return new o(this.config);case"delay":return new r(this.config);case"compressor":return new c(this.config)}},u.createReverb=function(e){var t=i(e);return!1===t?(l.warn("no reverb with id",e,"loaded"),!1):new n({type:"reverb",buffer:t})},u.createPanner=function(e){return(e=e||{}).type="panner",new s(e)},u.createPanner2=function(e){return(e=e||{}).type="panner2",new o(e)},u.createDelay=function(e){return(e=e||{}).type="delay",new r(e)},u.createCompressor=function(e){return(e=e||{}).type="compressor",new c(e)},u.createBiQuadFilter=function(e){return(e=e||{}).type="biquadfilter",new a(e)},u.protectedScope.addInitMethod(function(){e=u.protectedScope.context,t=u.protectedScope.createClass,i=u.getSample,n=t(p,function(t){this.node=e.createConvolver(),this.node.buffer=t.buffer}),s=t(p,function(t){this.node=e.createPanner(),this.node.panningModel="equalpower",this.node.setPosition(1e-17,1e-17,1e-17)}),o=t(p,function(t){this.node=e.createPanner(),this.node.panningModel="HRTF",this.node.setPosition(1e-17,1e-17,1e-17)}),r=t(p,function(t){this.node=e.createDelay(),this.node.delayTime.value=.3}),c=t(p,function(t){this.node=e.createDynamicsCompressor()}),a=t(p,function(t){this.node=e.createBiquadFilter(),this.node.type=0,this.node.Q.value=4,this.node.frequency.value=1600}),s.prototype.setPosition=function(e){var t=e,i=0,n=1-Math.abs(t);t=0===t?1e-17:t,i=0===i?1e-17:i,n=0===n?1e-17:n,this.node.setPosition(t,i,n)},o.prototype.setPosition=function(e){var t,i,n,s=parseInt(e),o=s+90;o>90&&(o=180-o),t=Math.sin(s*(Math.PI/180)),i=0,n=Math.sin(o*(Math.PI/180)),t=0===t?1e-17:t,i=0===i?1e-17:i,n=0===n?1e-17:n,this.node.setPosition(t,i,n)},r.prototype.setTime=function(e){this.node.delayTime.value=e}})}(),function(){var e,t=sequencer.createNote,i=sequencer.findEvent,n=sequencer.protectedScope.round,s=sequencer.protectedScope.getEvents,o=sequencer.protectedScope.typeString;e=function(){var e,r,a,c,u,l,d,p,h,f,m,v=Array.prototype.slice.call(arguments),g=v.length,y=128,b=-1,k=0,N=0,w=!1;if(0===(a=s(v[0])).length)return-1;if(c=v[1],"string"!==o(c))return console.error("please provide a search string like for instance get('velocity max bar >= 1 < 8')"),-1;if(g>2&&console.warn("ignoring invalid arguments, please consult documentation"),u=(c=c.split(" ")).length,e=c[0],r=c[1],-1==="data1 data2 velocity noteNumber noteName frequency".indexOf(e))return console.error("you can't use 'min', 'max' or 'avg'","on the property",e),-1;if(-1==="max min avg all".indexOf(r))return console.error(r,"is not a valid operator"),-1;for(u>2&&(6===u&&console.warn("ignoring cruft found in search string, please consult documentation"),c.shift(),c.shift(),a=i(a,c.join(" "))),"noteName"===e&&(e="noteNumber",w=!0),l=0,d=a.length;l<d;l++)(h=(p=a[l])[e])>b&&(b=h,m=p.noteName),h<y&&(y=h,f=p.noteName),void 0!==h&&(k+=h);return N=k/d,w&&(N=n(N),N=t(N).name,y=f,b=m),"max"===r?b:"min"===r?y:"avg"===r?N:"all"===r?{min:y,max:b,avg:N}:void 0},sequencer.getStats=e,sequencer.protectedScope.addInitMethod(function(){t=sequencer.createNote,i=sequencer.findEvent,n=sequencer.protectedScope.round,s=sequencer.protectedScope.getEvents,o=sequencer.protectedScope.typeString})}(),function(){var e,t,i,n,s,o,r,a,c,u,l,d,p,h,f,m,v,g,y={barsbeats:["bar","beat","sixteenth","tick"],time:["hour","minute","second","millisecond"]},b=new RegExp(" "+"OR AND NOT XOR".replace(/\s+/g," | ")+" "),k={bar:1,beat:1,sixteenth:1,tick:1,ticks:1,barsbeats:1,musical_time:1,hour:1,minute:1,second:1,millisecond:1,millis:1,time:1,linear_time:1,id:1,type:1,data1:1,data2:1,velocity:1,noteNumber:1,frequency:1,noteName:1};r=function(){var e,i,n,r,a,u,d,p,h,f,y,k,N=Array.prototype.slice.call(arguments);if(f=[],0===(h=c(N[0])).length)return console.warn("findEvent: no events"),f;if("string"!==t(N[1]))return console.error("please provide a search string like for instance findEvent('beat = 2 AND velocity > 60 < 100');"),f;for(i=(r=(n=N[1]).split(" ")).length,o=[],e=0;e<i;e++)a=r[e],b.test(" "+a+" ")&&o.push(a);for(i=(r=n.split(b)).length,s=[],e=0;e<i;e++)l(r[e].split(" "));for(i=s.length,d=0,p=-1,e=0;e<i;e++)u=s[d++],"AND"===(a=o[p++])?f=g(f,u):"NOT"===a?f=g(f,u,!0):"XOR"===a?(k=g(h,u),f=m(f,k)):(y=g(h,u),f=f.concat(y)),u,a;return v(f)},m=function(e,t){var i,n,s,o,r,a=e.length,c=t.length,u=[];for(i=0;i<a;i++){for(r=!0,o=(s=e[i]).id,n=0;n<c;n++)if(t[n].id===o){r=!1;break}r&&u.push(s)}for(n=0;n<c;n++){for(r=!0,o=(s=t[n]).id,i=0;i<a;i++)if(e[i].id===o){r=!1;break}r&&u.push(s)}return u},v=function(e){var t,i,n,s,o=e.length,r=[];for(e.sort(function(e,t){return e.eventNumber-t.eventNumber}),t=0;t<o;t++)(n=(i=e[t]).id)!==s&&r.push(i),s=n;return r},g=function(e,t,i){var n,s,o=[],r=t.property,a=t.operator1,c=t.operator2,u=t.value1,l=t.value2,d=e.length;for((i=i||!1)&&(a=f(a),c=f(c)),s=0;s<d;s++)n=e[s],p(r,n[r],a,u,c,l)&&o.push(n);return o},p=function(e,i,s,o,r,a){var c=!1,u=!1;if(void 0===i)return c;switch(e){case"noteName":if("="===s)return 3===o.length&&4===i.length?c=0===i.indexOf(o):4===o.length&&5===i.length&&(c=0===i.indexOf(o)),c;break;case"type":"number"!==t(o)&&isNaN(o)&&(o=n(o))}switch("string"===t(i)?("string"!==t(o)&&(o="'"+o+"'"),a&&"string"!==t(a)&&(a="'"+a+"'"),u=!0):"number"===t(i)&&("number"!==t(o)&&(o=parseInt(o)),a&&"number"!==t(a)&&(a=parseInt(a))),s){case"=":case"==":case"===":c=i===o;break;case"*=":c=-1!==i.indexOf(o);break;case"^=":c=0===i.indexOf(o);break;case"$=":c=i.indexOf(o)===i.length-o.length;break;case"%=":c=!u&&i%o==0;break;case"!*=":c=!(-1!==i.indexOf(o));break;case"!^=":c=!(0===i.indexOf(o));break;case"!$=":c=!(i.indexOf(o)===i.length-o.length);break;case"!%=":c=!!u||!(i%o==0);break;case"!=":case"!==":c=u?-1===i.indexOf(o):i!==o;break;case">":c=r?h(i,s,o,r,a):i>o;break;case">=":c=r?h(i,s,o,r,a):i>=o;break;case"<":c=r?h(i,s,o,r,a):i<o;break;case"<=":c=r?h(i,s,o,r,a):i<=o;break;default:console.warn("eval is evil!")}return c},h=function(e,t,i,n,s){var o=!1;switch(t){case">":switch(n){case"<":o=e>i&&e<s;break;case"<=":o=e>i&&e<=s}break;case">=":switch(n){case"<":o=e>=i&&e<s;break;case"<=":o=e>=i&&e<=s}break;case"<":switch(n){case">":o=e<i||e>s;break;case">=":o=e<i||e>=s}break;case"<=":switch(n){case">":o=e<=i||e>s;break;case">=":o=e<=i||e>=s}}return o},c=function(e){var i=[];return"array"===t(e)?i=e:void 0===e.className?console.warn(e):"Track"===e.className||"Part"===e.className?i=e.events:"Song"===e.className&&(i=e.eventsMidiTime),i},l=function(e){var t,i={property:e[0],operator1:e[1],value1:e[2],operator2:e[3],value2:e[4]},n=e[0],r=e[1],a=e[2],c=e[3],l=e[4];if(1!==k[n])return console.error(n,"is not a supported property"),!1;if(i=d(i),"barsbeats"===n||"time"===n){for(a=u(a,n),t=0;t<4;t++)(i={}).property=y[n][t],i.operator1=r,i.value1=a[t],s.push(i),o.push("AND");if(o.pop(),l){for(l=u(l,n),t=0;t<4;t++)(i={}).property=y[n][t],i.operator2=c,i.value2=l[t],s.push(i),o.push("AND");o.pop()}}else s.push(i)},u=function(e,i){switch(e=e.replace(/(\[|\])/g,""),"array"!==t(e)&&("barsbeats"===i?e=-1===e.indexOf(",")?[e,1,1,0]:e.split(","):"time"===i&&(e=-1===e.indexOf(",")?[0,e,0,0]:e.split(","))),e.length){case 1:"barsbeats"===i?e.push(1,1,0):"time"===i&&e.push(0,0,0);break;case 2:"barsbeats"===i?e.push(1,0):"time"===i&&e.push(0,0);break;case 3:e.push(0)}return e},d=function(t){var i=t.operator1,n=t.operator2,s=function(e){return"<"===e||">"===e||"<="===e||">="===e},o=function(e){return"="===e||"=="===e||"==="===e};return"noteName"===t.property&&(s(i)||o(i))&&(t.property="noteNumber",t.value1=e(t.value1).number),"noteName"===t.property&&(s(n)||o(n))&&(t.property="noteNumber",t.value2=e(t.value2).number),s(i)&&!s(n)&&(delete t.operator2,delete t.value2),t},f=function(e){var t;switch(e){case"=":case"==":case"===":t="!==";break;case"!=":case"!==":t="===";break;case"<":t=">=";break;case">":t="<=";break;case"<=":t=">";break;case">=":t="<";break;case"*=":case"^=":case"&=":case"%=":t="!"+e;break;default:t=e}return t},a=function(){var e,t,n,s,o=r.apply(this,arguments),a=o.length,c={},u=[];for(e=0;e<a;e++)(t=o[e]).type===sequencer.NOTE_ON?(void 0===c[t.noteNumber]&&(c[t.noteNumber]=[]),c[t.noteNumber].push(t)):t.type===sequencer.NOTE_OFF&&((s=c[t.noteNumber])&&(n=s.shift(),u.push(i(n,t))),0===s.length&&delete c[t.noteNumber]);return u.sort(function(e,t){return e.sortIndex-t.sortIndex}),u},sequencer.findEvent=r,sequencer.findNote=a,sequencer.protectedScope.getEvents=c,sequencer.protectedScope.addInitMethod(function(){e=sequencer.createNote,t=sequencer.protectedScope.typeString,i=sequencer.createMidiNote,n=sequencer.midiEventNumberByName})}(),function(){var e,t,i,n,s,o,r,a,c,u,l,d,p,h,f,m=window.sequencer,v=window.console;m.debug;function g(e){null}function y(e){return{getValue:function(e){return Math.sin(2*e*Math.PI)}}}(h=function(e){this.className="Instrument",this.config=e,this.scheduledEvents={},this.scheduledSamples={},this.sustainPedalDown=!1,this.sustainPedalSamples={},this.sampleDataByNoteNumber={},this.sampleData=[],this.info=e.info||e.instrument_info,this.author=e.author||e.instrument_author,this.license=e.license||e.instrument_license,this.pack=e.pack,this.parse()}).prototype.reset=function(){var e=m.getInstrument(this.config.localPath);!1!==m.getSamplePack(this.config.sample_path)&&!1!==e||(this.scheduledEvents={},this.scheduledSamples={},this.sustainPedalSamples={},this.sampleDataByNoteNumber={},this.sampleData=[],this.update&&delete n[this.updateTaskId],!1===e&&this.track.setInstrument())},h.prototype.parse=function(){var e,i,s,r,a,c,u,l,d,p,h,f,g,b,k,N,w,S,E,P,T=this.config,A=void 0===T.notename_mode?m.noteNameMode:T.notename_mode,I=T.mapping,x=this;if(void 0===T.name)return v.error("instruments must have a name",T),!1;if(void 0===I)return v.error("instruments must have a mapping to samples",T),!1;for(this.name=T.name,this.folder=T.folder||"",this.autopan=T.autopan||!1,this.singlePitch=T.single_pitch||!1,this.samplePath=T.sample_path||this.name,this.keyScalingRelease=T.keyscaling_release,this.keyScalingPanning=T.keyscaling_panning,this.keyRange=T.keyrange||T.key_range,h=this.samplePath.split("/"),E=t.samplepacks,e=0,i=h.length;e<i;e++){if(void 0===E)return void(m.debug&&v.log("sample pack not found",h.join("/")));E=E[h[e]]}P=t.audio;try{for(e=0,i=h.length;e<i;e++)P=P[h[e]]}catch(t){return void(m.debug&&v.log('sample pack "'+h[e]+'" is not loaded'))}if(void 0!==P){if("array"===o(I))for(this.keyRange=I,I={},e=this.keyRange[0];e<=this.keyRange[1];e++)I[e]="";for(b in void 0===this.keyRange?(this.lowestNote=128,this.highestNote=-1):(this.lowestNote=this.keyRange[0],this.highestNote=this.keyRange[1],this.numNotes=this.highestNote-this.lowestNote),void 0!==T.release_duration?this.releaseDuration=T.release_duration:this.releaseDuration=0,this.releaseEnvelope=T.release_envelope||"equal power",this.autopan&&(this.autoPanner=y()),this.samplepack=E,I)if(I.hasOwnProperty(b))if(k=I[b],isNaN(b)?(c=b.length,u=b.substring(c-1),l=b.substring(0,c-1),d=b,p=m.getNoteNumber(l,u)):(d=(d=m.getNoteNameFromNoteNumber(b,A)).join(""),p=b),p=parseInt(p,10),void 0===this.keyRange&&(this.lowestNote=p<this.lowestNote?p:this.lowestNote,this.highestNote=p>this.highestNote?p:this.highestNote),"array"===o(k))for(this.multiLayered=!0,e=0,i=k.length;e<i;e++){for(O(N=k[e]),void 0===this.sampleDataByNoteNumber[p]&&(this.sampleDataByNoteNumber[p]=[]),r=N.v[0],a=N.v[1],s=r;s<=a;s++)this.sampleDataByNoteNumber[p][s]=S;this.sampleData.push(S)}else O(k),this.sampleDataByNoteNumber[p]=S,this.sampleData.push(S);if(void 0===this.keyRange&&(this.numNotes=this.highestNote-this.lowestNote,this.keyRange=[this.lowestNote,this.highestNote]),this.config.mapping=I,this.singlePitch)for(e=127;e>=0;e--)this.sampleData[e]=S,this.sampleDataByNoteNumber[e]=S;w&&(this.updateTaskId="update_"+this.name+"_"+(new Date).getTime(),n[this.updateTaskId]=function(){x.autopan?x.update(this.autoPanner.getValue()):x.update()})}else m.debug&&v.log("sample pack not found",h.join("/"));function O(e){var t,i;if(e.n)f=P[e.n];else for(g=[p,d,d.toLowerCase()],i=2;i>=0;i--)if(void 0!==(f=P[g[i]])){I[b]={n:g[i]};break}if(void 0===f)return m.debug&&v.log("no buffer found for "+b+" ("+x.name+")"),void(S=!1);S={noteNumber:p,buffer:f,bufferId:e.n,autopan:x.autopan},!0===T.sustain&&(S.sustain=!0,w=!0),void 0!==e.s?(S.sustain_start=e.s[0],S.sustain_end=e.s[1],S.sustain=!0,w=!0):!0===T.sustain&&(void 0!==(t=E.samplesById[e.n].sustain)?(S.sustain_start=t[0],S.sustain_end=t[1]):S.sustain=!1),void 0!==T.release_duration&&(S.release_duration=T.release_duration,S.release_envelope=T.release_envelope||x.releaseEnvelope,S.release=!0,w=!0),void 0!==e.r&&("array"===o(e.r)?(S.release_duration=e.r[0],S.release_envelope=e.r[1]||x.releaseEnvelope):isNaN(e.r)||(S.release_duration=e.r,S.release_envelope=x.releaseEnvelope),S.release=!0,w=!0),void 0!==e.p&&(S.panPosition=e.p,S.panning=!0)}},h.prototype.getInfoAsHTML=function(){var e="",t="",i="",n=this.samplepack;return void 0!==this.info&&(t+="<tr><td>info</td><td>"+this.info+"</td></tr>"),void 0!==this.author&&(t+="<tr><td>author</td><td>"+this.author+"</td></tr>"),void 0!==this.license&&(t+="<tr><td>license</td><td>"+this.license+"</td></tr>"),t+="<tr><td>keyrange</td><td>"+this.lowestNote+"("+m.getFullNoteName(this.lowestNote)+")",""!==(t+=" - "+this.highestNote+"("+m.getFullNoteName(this.highestNote)+")</td></tr>")&&(e+=t='<table><th colspan="2">instrument</th>'+t+"</table>"),void 0===n?e:(void 0!==n.info&&(i+="<tr><td>info</td><td>"+n.info+"</td></tr>"),void 0!==n.author&&(i+="<tr><td>author</td><td>"+n.author+"</td></tr>"),void 0!==n.license&&(i+="<tr><td>license</td><td>"+n.license+"</td></tr>"),void 0!==n.compression&&(i+="<tr><td>compression</td><td>"+n.compression+"</td></tr>"),void 0!==n.filesize&&(i+="<tr><td>filesize</td><td>"+d(n.filesize/1024/1024,2)+" MiB</td></tr>"),""!==i&&(e+=i='<table><th colspan="2">samplepack</th>'+i+"</table>"),e)},h.prototype.getInfo=function(){var e={instrument:{},samplepack:{}};return void 0!==this.info&&(e.instrument.info=this.info),void 0!==this.author&&(e.instrument.author=this.author),void 0!==this.license&&(e.instrument.license=this.license),void 0!==this.keyrange&&(e.instrument.keyrange=this.keyrange),void 0!==this.info&&(e.samplepack.info=this.info),void 0!==this.author&&(e.samplepack.author=this.author),void 0!==this.license&&(e.samplepack.license=this.license),void 0!==this.compression&&(e.samplepack.compression=this.compression),void 0!==this.filesize&&(e.samplepack.filesize=d(this.samplepack.filesize/1024/1024,2)),e},h.prototype.createSample=function(e){var t=e.noteNumber,i=e.velocity,n=this.sampleDataByNoteNumber[t];return"array"===o(n)&&(n=n[i]),void 0===n||!1===n?{start:function(){v.warn("no audio data loaded for",t)},stop:function(){},update:function(){},addData:function(){},unschedule:function(){}}:(n.track=e.track,c(n))},h.prototype.setKeyScalingPanning=function(e,t){var i,n,s,o,r=this.sampleData.length;if(!1===e)for(i=0;i<r;i++)(n=this.sampleData[i]).panning=!1;if(!1===isNaN(e)&&!1===isNaN(t))for(s=(t-e)/this.numNotes,o=e,i=0;i<r;i++)(n=this.sampleData[i]).panning=!0,n.panPosition=o,o+=s},h.prototype.setRelease=function(e,t){if(void 0!==e){this.releaseEnvelope=t||this.releaseEnvelope,this.keyScalingRelease=void 0;var i,n,s=this.sampleData.length;for(i=0;i<s;i++)(n=this.sampleData[i]).release=!0,n.release_duration=e,n.release_envelope=this.releaseEnvelope;this.releaseDuration=e}},h.prototype.setKeyScalingRelease=function(e,t,i){var n,s,o,r,a=this.sampleData.length;if(this.releaseEnvelope=i||this.releaseEnvelope,!1===isNaN(e)&&!1===isNaN(t))for(this.keyScalingRelease=[e,t],this.releaseDuration=0,o=(t-e)/this.numNotes,r=e,n=0;n<a;n++)(s=this.sampleData[n]).release_duration=r,s.release_envelope=r,r+=o},h.prototype.transpose=function(e,t,i){if(void 0!==p){var n=this.sampleData.length;!function s(o,r){var a;i&&i("transposing sample "+(o+1)+" of "+n),o<n?(a=r[o],setTimeout(function(){p(a.buffer,e,function(e){a.buffer=e,s(++o,r)})},10)):t&&(v.log("ready"),t())}(0,this.sampleData)}else v.log("transpose is still experimental")},h.prototype.processEvent=function(e){var t,i,n=e.type;void 0===e.time&&(e.time=0),128===n||144===n?128===n?(!0===this.sustainPedalDown&&(e.sustainPedalDown=!0),this.stopNote(e)):this.playNote(e):176===e.type&&(t=e.data1,i=e.data2,64===t?127===i?(this.sustainPedalDown=!0,u(this.track.song,"sustain_pedal","down")):0===i&&(this.sustainPedalDown=!1,u(this.track.song,"sustain_pedal","up"),this.stopSustain(e.time)):10===t?this.track.setPanning(l(i,0,127,-1,1)):7===t&&this.track.output.gain.setValueAtTime(i/127,e.time))},h.prototype.stopSustain=function(e){var t,i=this.scheduledSamples,n=this.sustainPedalSamples;a(n,function(n){void 0!==n&&((t=n.midiNote).noteOn.sustainPedalDown=void 0,t.noteOff.sustainPedalDown=void 0,n.stop(e,function(e){i[e.sourceId]=null,delete i[e.sourceId]}))}),this.sustainPedalSamples={}},h.prototype.playNote=function(e){var t,i;e.midiNote?(i=e.midiNote.id,void 0!==(t=this.scheduledSamples[i])&&t.unschedule(0),(t=this.createSample(e)).addData({midiNote:e.midiNote,noteName:e.midiNote.note.fullName,sourceId:i}),this.scheduledSamples[i]=t,t.start(e)):m.debug&&v.warn("playNote() no midi note")},h.prototype.stopNote=function(e){if(void 0!==e.midiNote){var t=e.midiNote.id,i=this.scheduledSamples[t],n=this.scheduledSamples,s=this.sustainPedalSamples;!0!==e.sustainPedalDown?void 0!==i&&i.stop(e.time,function(){n[t]=null,delete n[t]}):s[t]=i}else m.debug&&v.warn("stopNote() no midi note",e.ticks,e.noteNumber)},h.prototype.hasScheduledSamples=function(){return r(this.scheduledSamples)},h.prototype.reschedule=function(e){var t,i,n,s=e.millis,o=s+1e3*m.bufferTime,r=this.scheduledSamples;for(t in r)if(r.hasOwnProperty(t))if(void 0===(i=(n=r[t]).midiNote)||"removed"===i.state)n.unschedule(0,g),delete r[t];else{if(i.noteOn.millis>=s&&i.noteOff.millis<o&&n.noteName===i.fullName)continue;delete r[t],n.unschedule(null,g)}},h.prototype.unschedule=function(){var e,t,n,s,r=Array.prototype.slice.call(arguments),a=[];for(function e(t,i,n,s){var r;for(i=0;i<n;i++)void 0!==(r=t[i])&&("MidiNote"===r.className?s.push(r.noteOn):"array"===o(r)&&e(r,0,r.length))}(r,0,r.length,a),e=a.length-1;e>=0;e--)void 0!==(t=a[e]).midiNote?(n=t.midiNote.id,void 0!==(s=this.scheduledSamples[n])&&(s.unschedule(0,g),delete this.scheduledSamples[n])):"MidiEvent"===t.className&&(n=t.id,delete i["event_"+n],delete this.scheduledEvents[n])},h.prototype.allNotesOff=function(){var e,t,n=this.scheduledSamples;if(this.stopSustain(0),this.sustainPedalDown=!1,void 0!==n&&!0!==r(n)){for(t in n)n.hasOwnProperty(t)&&(e=n[t])&&e.unschedule(0,g);this.scheduledSamples={},a(this.scheduledEvents,function(e,t){delete i["event_"+t]}),this.scheduledEvents={}}},h.prototype.allNotesOffPart=function(e){var t,n,s=this.scheduledSamples;if(this.stopSustain(0),this.sustainPedalDown=!1,void 0!==s&&!0!==r(s)){for(n in s)s.hasOwnProperty(n)&&(t=s[n])&&t.unschedule(0,g);this.scheduledSamples={},a(this.scheduledEvents,function(e,t){delete i["event_"+t]}),this.scheduledEvents={}}},h.prototype.update=function(e){var t,i;for(t in this.scheduledSamples)this.scheduledSamples.hasOwnProperty(t)&&(i=this.scheduledSamples[t])&&i.update(e)},m.createInstrument=function(e){var i,n,r=o(e);return"object"===r?("Instrument"===e.className?n=e:"InstrumentConfig"===e.className&&(n="sinewave"===e.name?new f(e):new h(e)),n):("string"===r&&(i=s(e,t.instruments)),n="sinewave"===i.name?new f(i):new h(i))},m.protectedScope.addInitMethod(function(){var v=m.protectedScope;t=m.storage,c=m.createSample,m.createReverb,u=m.protectedScope.songDispatchEvent,e=v.context,i=v.timedTasks,n=v.repetitiveTasks,a=v.objectForEach,r=v.isEmptyObject,s=v.findItem,v.storeItem,o=v.typeString,v.pathToArray,p=v.transpose,f=v.createClass(h),l=m.util.remap,d=m.util.round,m.util.getEqualPowerCurve,f.prototype.parse=function(){var t=this,i=this.config;this.name="SineWave",this.waveForm=i.wave_form||"sine",this.autopan=i.autopan||!1,this.folder=i.folder||"heartbeat",this.releaseDuration=i.release_duration||1500,this.autopan&&(this.autoPanner=y()),n["update_"+this.name+"_"+(new Date).getTime()]=function(){t.autopan?t.update(Math.sin(2*e.currentTime*Math.PI)):t.update()}},f.prototype.createSample=function(e){var t={oscillator:!0,track:e.track,event:e,autopan:this.autopan,wave_form:this.waveForm,release_envelope:"equal power",release_duration:this.releaseDuration};return c(t)},m.createSimpleSynth=function(e){return new f(e=e||{})}})}(),function(){var e,t,i,n,s,o,r,a=window.sequencer,c=window.console;a.debug;(r=function(e){this.className="Instrument",this.id="I0"+(new Date).getTime(),this.config=e,this.scheduledEvents={},this.scheduledSamples={},this.sustainPedalDown=!1,this.sustainPedalSamples={},this.sampleDataByNoteNumber={},this.sampleData=[],this.info=e.info||{},void 0!==this.info.samples&&void 0!==this.info.sample.filesize&&(this.info.samples.filesize=n(this.samplepack.filesize/1024/1024,2))}).prototype.reset=function(){},r.prototype.parse=function(){var i,n,s,o,r,u,l,d,p,h,f,m,v,g,y,b=this.config,k=void 0===b.notename_mode?a.noteNameMode:b.notename_mode,N=this;if(this.name=b.name||this.id,this.autopan=b.autopan||!1,this.singlePitch=b.single_pitch||!1,this.keyScalingRelease=b.keyscaling_release,this.keyScalingPanning=b.keyscaling_panning,this.keyRange=b.keyrange||b.key_range,this.mapping=b.mapping,void 0===this.keyRange?(this.lowestNote=128,this.highestNote=-1):(this.lowestNote=this.keyRange[0],this.highestNote=this.keyRange[1],this.numNotes=this.highestNote-this.lowestNote),void 0!==b.release_duration?this.releaseDuration=b.release_duration:this.releaseDuration=0,this.releaseEnvelope=b.release_envelope||"equal power",this.autopan&&(this.autoPanner=(void 0)()),void 0===this.mapping)for(f in this.mapping={},this.samples)this.samples.hasOwnProperty(f)&&(this.mapping[f]={n:f});for(f in this.mapping)if(this.mapping.hasOwnProperty(f))if(m=this.mapping[f],isNaN(f)?(u=f.length,l=f.substring(u-1),d=f.substring(0,u-1),f,p=a.getNoteNumber(d,l)):(a.getNoteNameFromNoteNumber(f,k).join(""),p=f),p=parseInt(p,10),void 0===this.keyRange&&(this.lowestNote=p<this.lowestNote?p:this.lowestNote,this.highestNote=p>this.highestNote?p:this.highestNote),"string"===t(m))h=this.samples[m];else if("array"===t(m))for(this.multiLayered=!0,i=0,n=m.length;i<n;i++){for(w(v=m[i]),void 0===this.sampleDataByNoteNumber[p]&&(this.sampleDataByNoteNumber[p]=[]),o=v.v[0],r=v.v[1],s=o;s<=r;s++)this.sampleDataByNoteNumber[p][s]=y;this.sampleData.push(y)}else w(m),this.sampleDataByNoteNumber[p]=y,this.sampleData.push(y);if(void 0===this.keyRange&&(this.numNotes=this.highestNote-this.lowestNote,this.keyRange=[this.lowestNote,this.highestNote]),this.singlePitch)for(i=127;i>=0;i--)this.sampleData[i]=y,this.sampleDataByNoteNumber[i]=y;function w(e){if(e.n&&(h=N.samples[e.n]),void 0===h)return a.debug&&c.log("no buffer found for "+f+" ("+N.name+")"),void(y=!1);y={noteNumber:p,buffer:h,autopan:N.autopan},!0===b.sustain&&(y.sustain=!0,g=!0),void 0!==e.s&&(y.sustain_start=e.s[0],y.sustain_end=e.s[1],y.sustain=!0,g=!0),void 0!==b.release_duration&&(y.release_duration=b.release_duration,y.release_envelope=b.release_envelope||N.releaseEnvelope,y.release=!0,g=!0),void 0!==e.r&&("array"===t(e.r)?(y.release_duration=e.r[0],y.release_envelope=e.r[1]||N.releaseEnvelope):isNaN(e.r)||(y.release_duration=e.r,y.release_envelope=N.releaseEnvelope),y.release=!0,g=!0),void 0!==e.p&&(y.panPosition=e.p,y.panning=!0)}g&&(this.updateTaskId="update_"+this.name+"_"+(new Date).getTime(),e[this.updateTaskId]=function(){N.autopan?N.update(this.autoPanner.getValue()):N.update()})},r.prototype.getInfoAsHTML=function(){var e="",t="",i="",n={},s={};return void 0!==this.info&&(s=this.info.samples,n=this.info.instrument),void 0!==n.descriptiom&&(t+="<tr><td>info</td><td>"+n.description+"</td></tr>"),void 0!==n.author&&(t+="<tr><td>author</td><td>"+n.author+"</td></tr>"),void 0!==n.license&&(t+="<tr><td>license</td><td>"+n.license+"</td></tr>"),t+="<tr><td>keyrange</td><td>"+this.lowestNote+"("+a.getFullNoteName(this.lowestNote)+")",""!==(t+=" - "+this.highestNote+"("+a.getFullNoteName(this.highestNote)+")</td></tr>")&&(e+=t='<table><th colspan="2">instrument</th>'+t+"</table>"),void 0!==s.description&&(i+="<tr><td>info</td><td>"+s.description+"</td></tr>"),void 0!==s.author&&(i+="<tr><td>author</td><td>"+s.author+"</td></tr>"),void 0!==s.license&&(i+="<tr><td>license</td><td>"+s.license+"</td></tr>"),void 0!==s.compression&&(i+="<tr><td>compression</td><td>"+s.compression+"</td></tr>"),void 0!==s.filesize&&(i+="<tr><td>filesize</td><td>"+s.filesize+" MiB</td></tr>"),""!==i&&(e+=i='<table><th colspan="2">samplepack</th>'+i+"</table>"),e},r.prototype.createSample=function(e){var n=e.noteNumber,s=e.velocity,o=this.sampleDataByNoteNumber[n];return"array"===t(o)&&(o=o[s]),void 0===o||!1===o?{start:function(){c.warn("no audio data loaded for",n)},stop:function(){},update:function(){},addData:function(){},unschedule:function(){}}:(o.track=e.track,i(o))},a.createInstrument2=function(e){return new Promise(function(t,i){var n;void 0===e.samples&&i("instruments must have samples",e),n="sinewave"===e.name?o(e):new r(e),s(e.samples).then(function(i){e.samples=null,n.samples=i,n.parse(),t(n)},function(e){i(e)})})},a.protectedScope.addInitMethod(function(){var c=a.protectedScope;i=a.createSample,e=c.repetitiveTasks,t=c.typeString,n=a.util.round,o=a.createSimpleSynth,s=a.util.parseSamples;["createAutoPanner","setKeyScalingPanning","setKeyScalingRelease","setRelease","transposeSamples","processEvent","stopSustain","playNote","stopNote","allNotesOff","allNotesOffPart","update","hasScheduledSamples","reschedule","unschedule"].forEach(function(e){var t=c[e];r.prototype[e]=function(){t.apply(this,arguments)}})})}(),function(){var e,t,i,n,s,o,r,a=window.sequencer,c=window.console,u=0;function l(e,t){t&&t(!1)}function d(i,n){if(void 0===i.url)return i.localPath=void 0!==i.folder?i.folder+"/"+i.name:i.name,void n();e({url:i.url,responseType:"json",onError:function(){l(0,n)},onSuccess:function(e){null!==e?(void 0!==e.name&&void 0===i.name&&(i.name=e.name),void 0!==e.folder&&void 0===i.folder&&(i.folder=e.folder),void 0===i.name&&(i.name=t(i.url).name),i.localPath=void 0!==i.folder?i.folder+"/"+i.name:i.name,o(e,function(e,t){"name"!==t&&"folder"!==t&&(i[t]=e)}),n()):n(!1)}})}r=function(e){this.id="IC"+u+++(new Date).getTime(),this.className="InstrumentConfig";var t=this;o(e,function(e,i){t[i]=e})},a.addInstrument=function(e,t,o){var u,p,h,f;if("object"!==s(e))return a.debug>=2&&c.warn("can't add an Instrument with this data",e),!1;if(e.json){if(p=e.json,h=e.name,f=e.folder,"string"===s(p))try{p=JSON.parse(p)}catch(t){return a.debug>=2&&c.warn("can't add an Instrument with this data",e),!1}if(void 0===p.mapping)return a.debug>=2&&c.warn("can't add an Instrument with this data",e),!1;e={mapping:p.mapping,name:void 0===h?p.name:h,folder:void 0===f?p.folder:f}}u=new r(e),a.addTask({type:"load instrument config",method:d,params:u},function(e){!function(e){var t=i(e.localPath,a.storage.instruments,!0),s=e.action;t&&"InstrumentConfig"===t.className&&"overwrite"!==s?a.debug>=2&&(c.warn("there is already an Instrument at",e.localPath),l()):n(e,e.localPath,a.storage.instruments)}(u),t&&t(u)},o),a.startTaskQueue()},a.protectedScope.addInitMethod(function(){e=a.protectedScope.ajax,i=a.protectedScope.findItem,t=a.protectedScope.parseUrl,n=a.protectedScope.storeItem,s=a.protectedScope.typeString,o=a.protectedScope.objectForEach})}(),function(){var e,t,i,n,s,o,r,a,c,u,l,d,p,h,f,m,v,g,y,b,k,N=window.sequencer,w=window.console;function S(e){null}a=function(e,t){var i,n,s,o,r=this.sampleData.length;if(!1===e)for(i=0;i<r;i++)(n=this.sampleData[i]).panning=!1;if(!1===isNaN(e)&&!1===isNaN(t))for(s=(t-e)/this.numNotes,o=e,i=0;i<r;i++)(n=this.sampleData[i]).panning=!0,n.panPosition=o,o+=s},u=function(e,t){if(void 0!==e){this.releaseEnvelope=t||this.releaseEnvelope,this.keyScalingRelease=void 0;var i,n,s=this.sampleData.length;for(i=0;i<s;i++)(n=this.sampleData[i]).release=!0,n.release_duration=e,n.release_envelope=this.releaseEnvelope;this.releaseDuration=e}},c=function(e,t,i){var n,s,o,r,a=this.sampleData.length;if(this.releaseEnvelope=i||this.releaseEnvelope,!1===isNaN(e)&&!1===isNaN(t))for(this.keyScalingRelease=[e,t],this.releaseDuration=0,o=(t-e)/this.numNotes,r=e,n=0;n<a;n++)(s=this.sampleData[n]).release_duration=r,s.release_envelope=r,r+=o},l=function(e,t,i){if(void 0!==o){var n=this.sampleData.length;!function s(r,a){var c;i&&i("transposing sample "+(r+1)+" of "+n),r<n?(c=a[r],setTimeout(function(){o(c.buffer,e,function(e){c.buffer=e,s(++r,a)})},10)):t&&(w.log("ready"),t())}(0,this.sampleData)}else w.log("transpose is still experimental")},d=function(e){var i,n,s=e.type;void 0===e.time&&(e.time=0),128===s||144===s?128===s?(!0===this.sustainPedalDown&&(e.sustainPedalDown=!0),this.stopNote(e)):this.playNote(e):176===s&&(i=e.data1,n=e.data2,64===i?127===n?(this.sustainPedalDown=!0,r(this.track.song,"sustain_pedal","down")):0===n&&(this.sustainPedalDown=!1,r(this.track.song,"sustain_pedal","up"),this.stopSustain(e.time)):10===i?this.track.setPanning(t(n,0,127,-1,1)):7===i&&this.track.output.gain.setValueAtTime(n/127,e.time))},p=function(e){var t,i=this.scheduledSamples,s=this.sustainPedalSamples;n(s,function(n){void 0!==n&&((t=n.midiNote).noteOn.sustainPedalDown=void 0,t.noteOff.sustainPedalDown=void 0,n.stop(e,function(e){i[e.sourceId]=null,delete i[e.sourceId]}))}),this.sustainPedalSamples={}},h=function(e){var t,i;e.midiNote?(i=e.midiNote.id,void 0!==(t=this.scheduledSamples[i])&&t.unschedule(0),(t=this.createSample(e)).addData({midiNote:e.midiNote,noteName:e.midiNote.note.fullName,sourceId:i}),this.scheduledSamples[i]=t,t.start(e)):N.debug&&w.warn("playNote() no midi note")},f=function(e){if(void 0!==e.midiNote){var t=e.midiNote.id,i=this.scheduledSamples[t],n=this.scheduledSamples,s=this.sustainPedalSamples;!0!==e.sustainPedalDown?void 0!==i&&i.stop(e.time,function(){n[t]=null,delete n[t]}):s[t]=i}else N.debug&&w.warn("stopNote() no midi note")},y=function(){return s(this.scheduledSamples)},b=function(e){var t,i,n,s=e.millis,o=s+1e3*N.bufferTime,r=this.scheduledSamples;for(t in r)if(r.hasOwnProperty(t))if(void 0===(i=(n=r[t]).midiNote)||"removed"===i.state)n.unschedule(0,S),delete r[t];else{if(i.noteOn.millis>=s&&i.noteOff.millis<o&&n.noteName===i.fullName)continue;delete r[t],n.unschedule(null,S)}},k=function(){var t,n,s,o,r=Array.prototype.slice.call(arguments),a=[];for(function t(i,n,s,o){var r;for(n=0;n<s;n++)void 0!==(r=i[n])&&("MidiNote"===r.className?o.push(r.noteOn):"array"===e(r)&&t(r,0,r.length))}(r,0,r.length,a),t=a.length-1;t>=0;t--)void 0!==(n=a[t]).midiNote?(s=n.midiNote.id,void 0!==(o=this.scheduledSamples[s])&&(o.unschedule(0,S),delete this.scheduledSamples[s])):"MidiEvent"===n.className&&(s=n.id,delete i["event_"+s],delete this.scheduledEvents[s])},m=function(){var e,t,o=this.scheduledSamples;if(this.stopSustain(0),this.sustainPedalDown=!1,void 0!==o&&!0!==s(o)){for(t in o)o.hasOwnProperty(t)&&(e=o[t])&&e.unschedule(0,S);this.scheduledSamples={},n(this.scheduledEvents,function(e,t){delete i["event_"+t]}),this.scheduledEvents={}}},v=function(e){var t,o,r=this.scheduledSamples;if(this.stopSustain(0),this.sustainPedalDown=!1,void 0!==r&&!0!==s(r)){for(o in r)r.hasOwnProperty(o)&&(t=r[o])&&t.unschedule(0,S);this.scheduledSamples={},n(this.scheduledEvents,function(e,t){delete i["event_"+t]}),this.scheduledEvents={}}},g=function(e){var t,i;for(t in this.scheduledSamples)this.scheduledSamples.hasOwnProperty(t)&&(i=this.scheduledSamples[t])&&i.update(e)},N.protectedScope.createAutoPanner=function(e){return{getValue:function(e){return Math.sin(2*e*Math.PI)}}},N.protectedScope.setKeyScalingPanning=a,N.protectedScope.setKeyScalingRelease=c,N.protectedScope.setRelease=u,N.protectedScope.transposeSamples=l,N.protectedScope.processEvent=d,N.protectedScope.stopSustain=p,N.protectedScope.playNote=h,N.protectedScope.stopNote=f,N.protectedScope.allNotesOff=m,N.protectedScope.allNotesOffPart=v,N.protectedScope.update=g,N.protectedScope.hasScheduledSamples=y,N.protectedScope.reschedule=b,N.protectedScope.unschedule=k,N.protectedScope.addInitMethod(function(){e=N.protectedScope.typeString,i=N.protectedScope.timedTasks,N.createReverb,n=N.protectedScope.objectForEach,s=N.protectedScope.isEmptyObject,o=N.protectedScope.transpose,N.util.getEqualPowerCurve,t=N.util.remap,r=N.protectedScope.songDispatchEvent})}(),function(){var e,t,i,n,s,o,r,a,c,u,l,d,p,h=window.sequencer,f=window.console,m=window.requestAnimationFrame,v="newEvents newNotes newParts changedEvents changedNotes changedParts removedEvents removedNotes removedParts".split(" "),g=Math.ceil;(e=function(e,i){this.song=e,this.song.keyEditor=this,this.playhead=n(this.song,"barsbeats ticks millis","keyeditor"),this.numBars=e.bars,this.newNumBars=this.numBars,this.eventListeners={},this.interrupt=!1,this.iteratorFactory=t(this.song,this),this.verticalLine=this.iteratorFactory.createVerticalLineIterator(this),this.horizontalLine=this.iteratorFactory.createHorizontalLineIterator(this),this.eventIterator=this.iteratorFactory.createEventIterator(this),this.noteIterator=this.iteratorFactory.createNoteIterator(this),this.partIterator=this.iteratorFactory.createPartIterator(this),this.exactFitVertical=i.exactFitVertical||!1,this.exactFitHorizontal=i.exactFitHorizontal||!1,this.activeEvents=[],this.activeNotes=[],this.activeParts=[],this.newEvents=[],this.newNotes=[],this.newParts=[],this.changedEvents=[],this.changedNotes=[],this.changedParts=[],this.removedEvents=[],this.removedNotes=[],this.removedParts=[],this.recordedNotesObj={},this.recordedEventsObj={},this.snapshot={activeEvents:this.activeEvents,activeNotes:this.activeNotes,activeParts:this.activeParts,newEvents:this.newEvents,newNotes:this.newNotes,newParts:this.newParts,changedEvents:this.changedEvents,changedNotes:this.changedNotes,changedParts:this.changedParts,removedEvents:this.removedEvents,removedNotes:this.removedNotes,removedParts:this.removedParts},i.paginate?(this.paginate=!0,this.pageNo=0,this.barsPerPage=i.barsPerPage,this.pageWidth=i.pageWidth,this.pageHeight=i.pageHeight,this.width=this.pageWidth,this.lowestNote=i.lowestNote||e.lowestNote,this.highestNote=i.highestNote||e.highestNote,this.pitchRange=this.highestNote-this.lowestNote,this.exactFitVertical?(this.pitchHeight=this.height/this.pitchRange,this.height=this.pageHeight):(this.pitchHeight=i.pitchHeight||10,this.height=this.pitchHeight*this.pitchRange),u(this,0),l(this)):(this.setStartPosition(i.startPosition||1),this.setEndPosition(i.endPosition||e.bars+1),this.numTicks=this.endTicks-this.startTicks,i.width?(this.width=i.width,this.tickWidth=this.width/this.numTicks):i.tickWidth?(this.tickWidth=i.tickWidth,this.width=this.numTicks*this.tickWidth,this.exactFitHorizontal=!1):i.barsPerPage&&i.viewportWidth?(this.barsPerPage=i.barsPerPage,this.viewportWidth=i.viewportWidth,this.tickWidth=this.viewportWidth/(this.startPosition.ticksPerBar*this.barsPerPage),this.width=this.numTicks*this.tickWidth,this.scrollX=0,this.scrollPosition=0,this.viewportTicks=this.viewportWidth/this.tickWidth,this.maxScrollPosition=g(this.width/this.viewportWidth),this.scrollLimit=this.viewportWidth/this.tickWidth,d(this),this.exactFitHorizontal=!1):i.viewportWidth?(this.viewportWidth=this.width=i.viewportWidth,this.tickWidth=this.viewportWidth/this.numTicks,this.exactFitHorizontal=!0):(this.tickWidth=.1,this.width=this.numTicks*this.tickWidth,this.exactFitHorizontal=!1),this.lowestNote=i.lowestNote||e.lowestNote,this.highestNote=i.highestNote||e.highestNote,this.pitchRange=i.pitchRange||this.highestNote-this.lowestNote+1,i.height?(this.height=i.height,this.pitchHeight=this.height/this.pitchRange):i.pitchHeight?(this.pitchHeight=i.pitchHeight,this.height=this.pitchRange*this.pitchHeight,this.exactFitVertical=!1):i.viewportHeight?(this.viewportHeight=this.height=i.viewportHeight,this.pitchHeight=this.viewportHeight/this.pitchRange,this.exactFitVertical=!0):(this.pitchHeight=10,this.height=this.pitchRange*this.pitchHeight,this.exactFitVertical=!1)),this.scrollX=0,this.scrollY=0,this.currentPage=1,this.numPages=g(this.width/this.viewportWidth),this.snapValueX=void 0===i.snapX?0:i.snapX,this.snapValueY=void 0===i.snapY?"chromatic":i.snapY,this.setSnapX(this.snapValueX),this.setSnapY(this.snapValueY)}).prototype.setBarsPerPage=function(e){this.interrupt=!0;var t=r(this.scrollX/(this.viewportWidth/this.barsPerPage));this.barsPerPage=e,this.tickWidth=this.viewportWidth/(this.startPosition.ticksPerBar*this.barsPerPage),this.viewportTicks=this.viewportWidth/this.tickWidth,this.width=this.numTicks*this.tickWidth,this.verticalLine.reset(),this.horizontalLine.reset(),this.eventIterator.reset(),this.partIterator.reset(),this.scrollLimit=this.viewportWidth/this.tickWidth,this.maxScrollPosition=g(this.width/this.viewportWidth),this.snapWidth=this.tickWidth*this.snapTicks,this.numPages=g(this.numBars/this.barsPerPage),this.currentPage=a(this.song.ticks/(this.barsPerPage*this.song.ticksPerBar))+1,p(this,"scale",{}),this.song.playing?this.scrollPosition=a(this.song.ticks/this.viewportTicks):(this.scrollPosition=this.viewportWidth/this.barsPerPage*t/this.viewportWidth,p(this,"scroll",{x:this.scrollPosition*this.viewportWidth})),this.interrupt=!1},e.prototype.setViewport=function(e,t){var i=!1;this.barsPerPage&&e!==this.viewportWidth?(this.viewportWidth=e,this.tickWidth=this.viewportWidth/(this.startPosition.ticksPerBar*this.barsPerPage),this.viewportTicks=this.viewportWidth/this.tickWidth,this.width=this.numTicks*this.tickWidth,i=!0):!0===this.exactFitHorizontal&&e!==this.width&&(this.viewportWidth=this.width=e,this.tickWidth=this.width/this.numTicks,i=!0),!0===this.exactFitVertical&&t!==this.height&&(this.viewportHeight=this.height=t,this.pitchHeight=this.height/this.pitchRange,i=!0),i&&(this.verticalLine.reset(),this.horizontalLine.reset(),this.eventIterator.reset(),this.noteIterator.reset(),this.partIterator.reset(),p(this,"draw",{}))},e.prototype.updateSong=function(e){this.iteratorFactory.updateSong();var t,i,n,s,r=0;for(r=v.length-1;r>=0;r--)switch(t=v[r]){case"newNotes":case"changedNotes":for(i=(n=e[t]).length-1;i>=0;i--)(s=n[i]).bbox=this.getNoteRect(s);break;case"newParts":case"changedParts":for(i=(n=e[t]).length-1;i>=0;i--)(s=n[i]).bbox=this.getPartRect(s)}this.newNumBars=e.numBars,this.newEvents=this.newEvents.concat(e.newEvents),this.changedEvents=this.changedEvents.concat(e.changedEvents),this.removedEvents=this.removedEvents.concat(e.removedEvents),this.removedEventsObj=o(this.removedEvents,"id"),this.newNotes=this.newNotes.concat(e.newNotes),this.changedNotes=this.changedNotes.concat(e.changedNotes),this.removedNotes=this.removedNotes.concat(e.removedNotes),this.removedNotesObj=o(this.removedNotes,"id"),this.newParts=this.newParts.concat(e.newParts),this.changedParts=this.changedParts.concat(e.changedParts),this.removedParts=this.removedParts.concat(e.removedParts),this.removedPartsObj=o(this.removedParts,"id")},e.prototype.setStartPosition=function(e){"array"!==s(e)&&(e=["barsandbeats",e,1,1,0]),this.startPosition=i(this.song,e),this.startTicks=this.startPosition.ticks,this.startMillis=this.startPosition.millis},e.prototype.setEndPosition=function(e){"array"!==s(e)&&(e=["barsandbeats",e,1,1,0]),this.endPosition=i(this.song,e),this.endTicks=this.endPosition.ticks,this.endMillis=this.endPosition.millis},e.prototype.addEventListener=function(e,t){var i,n=this;e.split(" ").forEach(function(e){void 0===(i=n.eventListeners[e])&&(n.eventListeners[e]=[],i=n.eventListeners[e]),e+"-"+i.length,i.push(t)})},e.prototype.nextPage=function(){u(this,this.startBar+this.barsPerPage),p(this,"pagechange",{pageNo:this.pageNo,lastPage:this.lastPage})},e.prototype.prevPage=function(){u(this,this.startBar-this.barsPerPage),p(this,"pagechange",{pageNo:this.pageNo,lastPage:this.lastPage})},e.prototype.gotoPage=function(e){f.warn("ooops, not implemented yet!")},e.prototype.scroll=function(e){var t,i=r(this.scrollX/(this.viewportWidth/this.barsPerPage));switch(this.scrollPosition=this.viewportWidth/this.barsPerPage*i/this.viewportWidth,e){case">":this.scrollPosition+=1,this.scrollPosition=this.scrollPosition>this.maxScrollPosition?this.maxScrollPosition:this.scrollPosition;break;case">>":this.scrollPosition=this.maxScrollPosition;break;case"<":this.scrollPosition-=1,this.scrollPosition=this.scrollPosition<0?0:this.scrollPosition;break;case"<<":this.scrollPosition=0;break;default:if(isNaN(e))return;this.scrollPosition=parseInt(e)}t=this.scrollPosition*this.viewportWidth,this.scrollLimit=(t+this.viewportWidth)/this.tickWidth,this.currentPage=g(t/this.viewportWidth)+1,0===this.currentPage?this.currentPage=1:this.currentPage>this.maxScrollPosition&&(this.currentPage=this.maxScrollPosition),p(this,"scroll",{x:t})},e.prototype.updateScroll=function(e,t){this.scrollX=e,this.scrollY=t,this.scrollLimit=(e+this.viewportWidth)/this.tickWidth},e.prototype.getEventRect=function(e){var t=this.ticksToX(e.ticks-this.startTicks,!1),i=this.pitchToY(e.number),n=2*this.tickWidth,s=this.pitchHeight;return{x:t,y:i,width:n,height:s,top:i,left:t,bottom:i+s,right:t+n}},e.prototype.getNoteRect=function(e){var t,i,n=this.ticksToX(e.ticks-this.startTicks,!1),s=this.pitchToY(e.number),o=e.durationTicks*this.tickWidth,r=this.pitchHeight;if(e.endless&&(o=(this.song.ticks-e.noteOn.ticks)*this.tickWidth),this.paginate){if(t=e.ticks,i=e.noteOff.ticks,!(t<this.startTicks))return!1;n=(t=t+(this.startTicks-t)-this.startTicks)*this.tickWidth,o=((i=i>this.endTicks?this.endTicks:i)-this.startTicks)*this.tickWidth}return{x:n,y:s,width:o,height:r,top:s,left:n,bottom:s+r,right:n+o}},e.prototype.getPartRect=function(e){var t=e.getStats("noteNumber all"),i={top:this.pitchToY(t.max),bottom:this.pitchToY(t.min)+this.pitchHeight,left:this.ticksToX(e.start.ticks-this.startTicks,!1),right:this.ticksToX(e.end.ticks-this.startTicks,!1)};return i.x=i.left,i.y=i.top,i.width=i.right-i.left,i.height=i.bottom-i.top,e.bbox=i,e.stats=t,i},e.prototype.getBBox=function(e){var t,i;if("string"===s(e))switch(e.substring(0,1)){case"E":if(t="event",144!==event.type||void 0===event.endEvent)return void f.error("argument not supported, please check documentation");i=this.song.findEvent("id = "+e);break;case"P":t="part",i=this.song.getPart(e);break;case"T":t="track";break;default:return void f.error("argument not supported, please check documentation")}else switch(e.className){case"AudioEvent":t="audio";break;case"MidiEvent":t="event";break;case"Part":t="part";break;case"Track":t="track";break;default:return void f.error("argument not supported, please check documentation")}if(void 0!==i)switch(t){case"event":return this.getNoteRect(i);case"part":return this.getPartRect(i)}else f.error(e,"could not be found")},e.prototype.startMoveNote=function(e,t,i){"MidiNote"===e.className?(this.selectedNote=e,this.gripX=t-this.selectedNote.bbox.x):h.debug>=h.WARN&&f.warn(e,"is not a MidiNote")},e.prototype.stopMoveNote=function(){this.selectedNote=void 0},e.prototype.moveNote=function(e,t){if(void 0!==this.selectedNote){var i=this.yToPitch(t).number,n=this.selectedNote.pitch,s=this.xToTicks(e-this.gripX),o=this.selectedNote.ticks,r=this.selectedNote.part,a=!1;i!==n&&(r.transposeNote(this.selectedNote,i-n),a=!0),s!==o&&(r.moveNote(this.selectedNote,s-o),a=!0),!0===a&&this.song.update()}},e.prototype.startMovePart=function(e,t,i){"Part"===e.className?(this.selectedPart=e,this.selectedPart.pitch=this.yToPitch(i).number,this.gripX=t-this.selectedPart.bbox.x):h.debug>=h.WARN&&f.warn(e,"is not a Part")},e.prototype.stopMovePart=function(){this.selectedPart=void 0},e.prototype.movePart=function(e,t){if(void 0!==this.selectedPart){var i=this.yToPitch(t).number,n=this.selectedPart.pitch,s=this.xToTicks(e-this.gripX),o=this.selectedPart.ticks,r=!1;i!==n&&(this.selectedPart.track.transposePart(this.selectedPart,i-n),this.selectedPart.pitch=i,r=!0),s!==o&&(this.selectedPart.track.movePart(this.selectedPart,s-o),r=!0),!0===r&&this.song.update()}},e.prototype.getTicksAt=e.prototype.xToTicks=function(e,t){var i=(e+this.scrollX)/this.width*this.numTicks;return!1!==t&&0!==this.snapTicks&&(i=r(i/this.snapTicks)*this.snapTicks),i},e.prototype.getPitchAt=e.prototype.yToPitch=function(e){var t=this.highestNote-r((e+this.scrollY)/this.height*this.pitchRange);return t=c(t)},e.prototype.getXAt=e.prototype.ticksToX=function(e,t){var i=(e-this.startTicks)*this.tickWidth;return!1!==t&&0!==this.snapWidth&&(i=r(i/this.snapWidth)*this.snapWidth),i},e.prototype.getYAt=e.prototype.pitchToY=function(e){return this.height-(e-this.lowestNote+1)*this.pitchHeight},e.prototype.getPositionAt=function(e){var t=this.getTicksAt(e);return this.playhead.set("ticks",t,!1),this.playhead.get()},e.prototype.getPlayheadX=function(e){var t=this.song.ticks/this.song.durationTicks*this.width;return t=!0===e?t-this.scrollX:t},e.prototype.setPlayheadToX=function(e){var t=this.xToTicks(e,!1);this.song.setPlayhead("ticks",t)},e.prototype.getPlayheadPosition=function(e){var t=this.song.ticks/this.song.durationTicks*this.width;return t=!0===e?t-this.scrollX:t},e.prototype.setPlayheadPosition=function(e,t){var n;switch(e){case"x":n=this.xToTicks(t,!1);break;case"ticks":n=t;break;case"millis":n=this.playhead.set("millis",t).ticks;break;case"barsbeats":case"barsandbeats":n=i(this.song,["barsbeats",t]).ticks}this.song.setPlayhead("ticks",n)},e.prototype.getEventAt=function(e,t){this.getSongPosition(e),this.getPitchAt(t)},e.prototype.getEventsInRect=function(e,t,i,n){this.getSongPosition(e),this.getSongPosition(e+i),this.getPitchAt(t+n),this.getPitchAt(t)},e.prototype.getNoteAt=function(e,t){this.getSongPosition(e),this.getPitchAt(t)},e.prototype.getNotesInRect=function(e,t,i,n){this.getSongPosition(e),this.getSongPosition(e+i),this.getPitchAt(t+n),this.getPitchAt(t)},e.prototype.snap=function(e,t){return{x:this.snapX(e),y:this.snapY(t)}},e.prototype.snapX=function(e){return r((e+this.scrollX)/this.snapWidth)*this.snapWidth},e.prototype.snapY=function(e){return r((e+this.scrollY)/this.snapHeight)*this.snapHeight},e.prototype.setSnapX=function(e){if(void 0!==e){var t=4/this.song.denominator;"off"===e?this.snapTicks=0:"tick"===e?this.snapTicks=1:"beat"===e?this.snapTicks=this.song.ppq*t:"bar"===e?this.snapTicks=this.song.ppq*this.song.nominator*t:isNaN(e)&&-1!==e.indexOf("ticks")?(this.snapTicks=e.replace(/ticks/,""),isNaN(this.snapTicks)?this.snapTicks=this.song.ppq/4:this.snapTicks=parseInt(this.snapTicks)):isNaN(e)||0===e?(e=0,this.snapTicks=0):(e=parseInt(e),this.snapTicks=4/e*this.song.ppq),this.snapValueX=e,this.snapWidth=this.tickWidth*this.snapTicks}},e.prototype.setSnapY=function(e){void 0!==e&&(this.snapValueY=e,this.snapHeight=this.pitchHeight)},e.prototype.removeNote=function(e){e.part.removeEvents(e.noteOn,e.noteOff),this.song.update()},e.prototype.removePart=function(e){e.track.removePart(e),this.song.update()},e.prototype.prepareForRecording=function(){this.recordedEventsObj={},this.recordedNotesObj={}},e.prototype.getSnapshot=function(){var e,t,n,s,o,r,c,u,l,d,p,h=[],m=[],v=[],y=[].concat(this.activeEvents),b=[].concat(this.activeNotes),k=[].concat(this.activeParts),N=[],w=[],S=[];for(c in this.activeEvents=[],this.activeNotes=[],this.activeParts=[],this.activeStateChangedEvents=[],this.activeStateChangedNotes=[],this.activeStateChangedParts=[],this.newNumBars!==this.numBars&&(d=this.numBars,p=this.song.lastBar+1,this.endPosition=i(this.song,["barsbeats",p,1,1,0,!0]),this.verticalLine.reset(i(this.song,["barsbeats",d,1,1,0,!0]),this.endPosition),this.numBars=this.song.bars,this.endTicks=this.endPosition.ticks,this.numTicks=this.song.durationTicks,this.width=this.numTicks*this.tickWidth,this.maxScrollPosition=g(this.width/this.viewportWidth),this.numPages=g(this.numBars/this.barsPerPage)),e=this.song.activeEvents)e.hasOwnProperty(c)&&(u=e[c],this.activeEvents.push(u),!0!==u.active&&(u.active=!0,this.activeStateChangedEvents.push(u)));for(c in t=this.song.activeNotes)t.hasOwnProperty(c)&&(u=t[c],this.activeNotes.push(u),!0!==u.active&&(u.active=!0,this.activeStateChangedNotes.push(u)));for(c in n=this.song.activeParts)n.hasOwnProperty(c)&&(u=n[c],this.activeParts.push(u),!0!==u.active&&(u.active=!0,this.activeStateChangedParts.push(u)));if(o=this.song.recordedEvents)for(l=o.length,c=0;c<l;c++)u=o[c],void 0===this.recordedEventsObj[u.id]&&(u.bbox=this.getEventRect(u),N.push(u),this.recordedEventsObj[u.id]=u);if(s=this.song.recordedNotes)for(l=s.length,c=0;c<l;c++)u=s[c],void 0===this.recordedNotesObj[u.id]?(this.recordedNotesObj[u.id]=u,u.bbox=this.getNoteRect(u),w.push(u)):!0===u.endless?(u.bbox=this.getNoteRect(u),S.push(u)):!1===u.endless&&(u.bbox=this.getNoteRect(u),S.push(u),u.endless=void 0);for(c=y.length-1;c>=0;c--)void 0!==(u=y[c])?void 0===e[u.id]&&(h.push(u),!1!==u.active&&(u.active=!1,this.activeStateChangedEvents.push(u))):f.warn("event is undefined");for(c=b.length-1;c>=0;c--)void 0!==(u=b[c])?void 0===t[u.id]&&(m.push(u),!1!==u.active&&(u.active=!1,this.activeStateChangedNotes.push(u))):f.warn("note is undefined");for(c=k.length-1;c>=0;c--)void 0!==(u=k[c])?void 0===n[u.id]&&(v.push(u),!1!==u.active&&(u.active=!1,this.activeStateChangedParts.push(u))):f.warn("part is undefined");return this.song.playing&&(this.currentPage=a(this.song.ticks/(this.barsPerPage*this.song.ticksPerBar))+1),r={events:{active:this.activeEvents,inActive:this.nonActiveEvents,recorded:N,new:this.newEvents,changed:this.changedEvents,removed:this.removedEvents,stateChanged:this.activeStateChangedEvents},notes:{active:this.activeNotes,inActive:m,recorded:w,recording:S,new:this.newNotes,changed:this.changedNotes,removed:this.removedNotes,stateChanged:this.activeStateChangedNotes},parts:{active:this.activeParts,inActive:v,new:this.newParts,changed:this.changedParts,removed:this.removedParts,stateChanged:this.activeStateChangedParts},hasNewBars:d!==p,newWidth:this.width,pageNo:this.currentPage,lastPage:this.numPages},this.newEvents=[],this.changedEvents=[],this.removedEvents=[],this.newNotes=[],this.changedNotes=[],this.removedNotes=[],this.newParts=[],this.changedParts=[],this.removedParts=[],r},u=function(e,t){var i;for(e.numTicks=0,e.startBar=t>0?t:0,e.startBar=e.startBar>e.numBars-e.barsPerPage?e.numBars-e.barsPerPage:e.startBar,e.endBar=t+e.barsPerPage,e.endBar=e.endBar>e.numBars?e.numBars:e.endBar,e.endBar=e.endBar<e.barsPerPage?e.barsPerPage:e.endBar,f.log(t,e.startBar,e.endBar,e.numBars,e.numBars-e.barsPerPage),i=e.startBar;i<e.endBar;i++)e.numTicks+=e.bars[i].ticksPerBar;e.tickWidth=e.pageWidth/e.numTicks,e.startPosition=e.bars[e.startBar],e.endPosition=e.bars[e.endBar],e.startTicks=e.startPosition.ticks,e.endTicks=e.endPosition.ticks,e.verticalLine.reset(),e.horizontalLine.reset(),e.eventIterator.reset()},l=function(e){e.song.playing()&&e.song.ticks>=e.endTicks&&e.nextPage(),m(function(){l(e)})},d=function(e){if(e.song.playing&&!1===e.interrupt)if(e.song.ticks>=e.scrollLimit)p(e,"scroll",{x:e.scrollX+e.viewportWidth}),e.scrollLimit+=e.viewportWidth/e.tickWidth;else{var t=a(e.song.ticks/e.viewportTicks)*e.viewportTicks*e.tickWidth;e.scrollX!==t&&p(e,"scroll",{x:t})}m(function(){d(e)})},p=function(e,t,i){var n=e.eventListeners[t];n&&n.forEach(function(e){e(i)})},h.createKeyEditor=function(t,i){return new e(t,i)},h.protectedScope.addInitMethod(function(){i=h.protectedScope.getPosition,n=h.protectedScope.createPlayhead,c=h.createNote,h.debug,a=h.protectedScope.floor,r=h.protectedScope.round,s=h.protectedScope.typeString,h.protectedScope.objectToArray,o=h.protectedScope.arrayToObject,h.protectedScope.getScaffoldingBars,t=h.protectedScope.createKeyEditorIteratorFactory})}(),function(){var e,t,i=window.sequencer;function n(t,i){this.song=t,this.editor=i,this.position=e(this.song,"all","iterators"),this.updateSong()}n.prototype.updateSong=function(){this.events=this.song.events,this.numEvents=this.events.length,this.notes=this.song.notes,this.numNotes=this.notes.length,this.parts=this.song.parts,this.numParts=this.parts.length,this.position.updateSong()},n.prototype.createVerticalLineIterator=function(){var e,t,i,n,s,o,r,a,c,u,l,d,p,h,f,m={},v=this.editor,g=this.position;return f=function(){h=g.update("ticks",s),m.bar=h.ticksPerBar,m.beat=h.ticksPerBeat,m.sixteenth=h.ticksPerSixteenth,u=h.nominator,l=h.numSixteenth},{next:function(d){switch(d&&(n=d,t<.02?n="bar":t<.042&&(n="beat")),n){case"sixteenth":e="sixteenth",++c>l&&(e="beat",c=1,++a>u&&(e="bar",a=1,r++));break;case"beat":e="beat",c=1,++a>u&&(e="bar",a=1,r++);break;case"bar":e="bar",c=1,a=1,r++}return s+=m[n],f(),!(s>o)&&{x:s*t-i,bar:r,beat:a,sixteenth:c,type:e,position:h}},reset:function(e,u){d=e||v.startPosition,p=u||v.endPosition,s=d.ticks,r=d.bar,a=d.beat,c=d.sixteenth,o=p.ticks,t=v.tickWidth,i=0,g.set("ticks",s),t<.02?n="bar":t<.042&&(n="beat"),f()},hasNext:function(e){var i=o-s,r=!1;switch(e&&(n=e,t<.02?n="bar":t<.042&&(n="beat")),n){case"bar":case"beat":case"sixteenth":r=i>=m[n]}return r},setType:function(e){n=e,t<.02?n="bar":t<.042&&(n="beat")}}},n.prototype.createHorizontalLineIterator=function(){var e,i,n,s,o={},r=this.editor;return{next:function(n){return o={note:t(i),y:e*s},i--,e++,o},reset:function(){e=0,i=r.highestNote,n=r.pitchRange,s=r.pitchHeight},hasNext:function(t){var i=!1;switch(t){case"chromatic":i=e<n}return i}}},n.prototype.createEventIterator=function(){var e,t,n,s,o,r=this.editor,a=this.position,c=this.events,u=this.numEvents,l="";return{next:function(e){return l=e||l,t||o(l),t=!1,s},reset:function(){r.startTicks,e=r.endTicks,t=!1,!0===r.paginate&&!0===i.isPlaying()||(n=a.get().eventIndex-2)},hasNext:o=function(i){return l=i||l,t=!0,++n!==u&&(s=c[n],""===l&&s.ticks<=e)},setTypes:function(){Array.prototype.slice.call(arguments).forEach(function(e){l+=e+" "})}}},n.prototype.createNoteIterator=function(){var e,t,n,s,o,r,a,c=this.editor,u=this.song,l=this.notes,d=this.numNotes,p="";return{next:function(e){return p=e||p,n||a(p),n=!1,r.bbox=c.getNoteRect(r),r},reset:function(){if(e=c.startTicks,t=c.endTicks,l=u.notes,d=u.numNotes,n=!1,!0!==c.paginate||!0!==i.isPlaying()){for(s=0;s<d&&!(l[s].ticks>=e);s++);s--}},hasNext:a=function(i){if(p=i||p,n=!0,++s===this.numNotes)return!1;for(o=!1;s<d&&!((r=l[s]).ticks>=t);s++)if(c.paginate){if(r.ticks<e&&r.noteOff.ticks>e?o=!0:r.ticks<t&&(o=!0),o)break}else if(o=r.ticks<=t)break;return o}}},n.prototype.createPartIterator=function(){var e,t,i,n=this.editor,s=this.song,o=this.parts;return{next:function(t){return(i=o[e++]).bbox=n.getPartRect(i),i},reset:function(){o=s.parts,t=s.numParts,e=0},hasNext:function(i){return e<t}}},i.protectedScope.createKeyEditorIteratorFactory=function(e,t){return new n(e,t)},i.protectedScope.addInitMethod(function(){t=i.createNote,e=i.protectedScope.createPlayhead})}(),function(){var e,t,i,n,s,o,r=window.sequencer,a=window.console,c={volume:"setVolume",instrument:"setInstrument",noteNumberAccentedTick:"setNoteNumberAccentedTick",noteNumberNonAccentedTick:"setNoteNumberNonAccentedTick",velocityAccentedTick:"setVelocityAccentedTick",velocityNonAccentedTick:"setVelocityNonAccentedTick",noteLengthAccentedTick:"setNoteLengthAccentedTick",noteLengthNonAccentedTick:"setNoteLengthNonAccentedTick"};function u(e){return isNaN(e)?(r.debug&&a.log("please provide a number"),!1):e<0||e>127?(r.debug&&a.log("please provide a number between 0 and 127"),!1):e}function l(t,n,s,o){var a,c,u,l,d,p,h,f,m,v,g=0,y=[],b=t.song;for(a=n;a<=s;a++)for(h=(u=e(b,["barsbeats",a])).nominator,f=u.ticksPerBeat,c=0;c<h;c++)p=0===c?t.noteNumberAccented:t.noteNumberNonAccented,d=0===c?t.noteLengthAccented:t.noteLengthNonAccented,l=0===c?t.velocityAccented:t.velocityNonAccented,m=r.createMidiEvent(g,144,p,l),v=r.createMidiEvent(g+d,128,p,0),"precount"===o&&(m.part={id:"precount"},m.track=t.track,v.part={id:"precount"},v.track=t.track),i(m,v),y.push(m,v),g+=f;return y}(o=function(e){this.song=e,this.track=r.createTrack(this.song.id+"_metronome","metronome"),this.part=r.createPart(),this.track.addPart(this.part),this.track.connect(this.song.gainNode),this.events=[],this.precountEvents=[],this.noteNumberAccented=61,this.noteNumberNonAccented=60,this.volume=1,this.velocityNonAccented=100,this.velocityAccented=100,this.noteLengthNonAccented=e.ppq/4,this.noteLengthAccented=e.ppq/4,this.track.setInstrument("heartbeat/metronome"),this.precountDurationInMillis=0,this.bars=0}).prototype.init=function(e,t,i){e=void 0===e?"init":e,this.part.numEvents>0&&this.part.removeEvents(this.part.events),this.events=l(this,t,i,e),this.numEvents=this.events.length,this.part.addEvents(this.events),this.bars=this.song.bars,s(this.song,this.events)},o.prototype.update=function(e,t){0===e&&(e=1),void 0!==e&&void 0!==t?this.init("update",e,t):this.init("update",1,this.song.bars)},o.prototype.updateConfig=function(){this.init("configure",1,this.bars),this.allNotesOff(),this.song.scheduler.updateSong()},o.prototype.configure=function(e){var i=this;t(e,function(e,t){i[c[t]](e)}),this.updateConfig()},o.prototype.setInstrument=function(e){"Instrument"!==e.className&&(e=r.createInstrument(e)),!1!==e?this.track.setInstrument(e):this.track.setInstrument("heartbeat/metronome"),this.updateConfig()},o.prototype.setNoteLengthAccentedTick=function(e){isNaN(e)&&r.debug>=2&&a.warn("please provide a number"),this.noteLengthAccented=e,this.updateConfig()},o.prototype.setNoteLengthNonAccentedTick=function(e){isNaN(e)&&r.debug>=2&&a.warn("please provide a number"),this.noteLengthNonAccented=e,this.updateConfig()},o.prototype.setVelocityAccentedTick=function(e){!1!==(e=u(e))?this.velocityAccented=e:r.debug>=2&&a.warn("please provide a number"),this.updateConfig()},o.prototype.setVelocityNonAccentedTick=function(e){!1!==(e=u(e))?this.velocityNonAccented=e:r.debug>=2&&a.warn("please provide a number"),this.updateConfig()},o.prototype.setNoteNumberAccentedTick=function(e){!1!==(e=u(e))?this.noteNumberAccented=e:r.debug>=2&&a.warn("please provide a number"),this.updateConfig()},o.prototype.setNoteNumberNonAccentedTick=function(e){!1!==(e=u(e))?this.noteNumberNonAccented=e:r.debug>=2&&a.warn("please provide a number"),this.updateConfig()},o.prototype.reset=function(){this.volume=1,this.track.setInstrument("heartbeat/metronome"),this.noteNumberAccented=61,this.noteNumberNonAccented=60,this.velocityAccented=100,this.velocityNonAccented=100,this.noteLengthAccented=this.song.ppq/4,this.noteLengthNonAccented=this.song.ppq/4},o.prototype.allNotesOff=function(){this.track.instrument&&this.track.instrument.allNotesOff()},o.prototype.createPrecountEvents=function(e){if(!(e<=0)){var t=this.song.getPosition("barsbeats",this.song.bar+e);this.index=0,this.millis=0,this.startMillis=this.song.millis,this.precountDurationInMillis=t.millis-this.startMillis,this.precountEvents=l(this,this.song.bar,t.bar-1,"precount"),n(this.song,this.precountEvents)}},o.prototype.getPrecountEvents=function(e){var t,i,n=this.precountEvents,s=n.length,o=[];for(t=this.index;t<s&&(i=n[t]).millis<e;t++)i.time=this.startTime+i.millis,o.push(i),this.index++;return o},o.prototype.setVolume=function(e){this.track.setVolume(e)},r.protectedScope.createMetronome=function(e){return new o(e)},r.protectedScope.addInitMethod(function(){r.protectedScope.context,r.protectedScope.findItem,e=r.protectedScope.getPosition,i=r.createMidiNote,t=r.util.objectForEach,n=r.protectedScope.parseEvents,s=r.protectedScope.parseMetronomeEvents})}(),function(){var e,t,i,n=window.sequencer,s=window.console,o=Array.prototype.slice,r=0;(i=function(i){var o,a;if(this.className="MidiEvent",this.id="M"+r+(new Date).getTime(),this.eventNumber=r,this.channel="any",this.time=0,this.muted=!1,r++,i)if("midimessageevent"!==t(i[0])){if("array"===t(i[0]))o=i[0];else{if("number"!==t(i[0])||"number"!==t(i[1]))return n.debug>=1&&s.error("wrong number of arguments, please consult documentation"),!1;o=[i[0],i[1]],i.length>=3&&"number"===t(i[2])&&o.push(i[2]),4===i.length&&"number"===t(i[3])&&o.push(i[3]),5===i.length&&"number"===t(i[4])&&o.push(i[4])}switch(this.ticks=o[0],this.status=o[1],this.type=16*(this.status>>4),this.type>=128?(this.command=this.type,this.channel=1+(15&this.status)):(this.type=this.status,this.channel=o[4]||"any"),this.sortIndex=this.type+this.ticks,this.type){case 0:break;case 128:this.data1=o[2],a=e(this.data1),this.note=a,this.noteName=a.fullName,this.noteNumber=a.number,this.octave=a.octave,this.frequency=a.frequency,this.data2=0,this.velocity=this.data2;break;case 144:this.data1=o[2],this.data2=o[3],0===this.data2&&(this.type=128),a=e(this.data1),this.note=a,this.noteName=a.fullName,this.noteNumber=a.number,this.octave=a.octave,this.frequency=a.frequency,this.velocity=this.data2;break;case 81:this.bpm=o[2];break;case 88:this.nominator=o[2],this.denominator=o[3];break;case 176:this.data1=o[2],this.data2=o[3],this.controllerType=o[2],this.controllerValue=o[3];break;case 192:this.data1=o[2],this.programNumber=o[2];break;case 208:case 224:this.data1=o[2],this.data2=o[3];break;case 47:break;default:s.warn("not a recognized type of midi event!")}}else s.log("midimessageevent")}).prototype.clone=i.prototype.copy=function(){var e,t=new i;for(e in this)this.hasOwnProperty(e)&&("id"!==e&&"eventNumber"!==e&&"midiNote"!==e&&(t[e]=this[e]),t.song=void 0,t.track=void 0,t.trackId=void 0,t.part=void 0,t.partId=void 0);return t},i.prototype.transpose=function(i){if(128===this.type||144===this.type){if("array"===t(i)){var o=i[0];"hertz"===o||"semi"!==o&&"semitone"!==o||(i=i[1])}else if(!0===isNaN(i))return void(n.debug>=1&&s.error("please provide a number"));var r=this.data1+parseInt(i,10);r<0?r=0:r>127&&(r=127),this.data1=r;var a=e(this.data1);this.note=a,this.noteName=a.fullName,this.noteNumber=a.number,this.octave=a.octave,this.frequency=a.frequency,void 0!==this.midiNote&&(this.midiNote.pitch=this.data1),"new"!==this.state&&(this.state="changed"),void 0!==this.part&&(this.part.needsUpdate=!0)}else n.debug>=1&&s.error("you can only transpose note on and note off events")},i.prototype.setPitch=function(i){if(128===this.type||144===this.type){if("array"===t(i)){var o=i[0];"hertz"===o||"semi"!==o&&"semitone"!==o||(i=i[1])}else if(!0===isNaN(i))return void(n.debug>=1&&s.error("please provide a number"));this.data1=parseInt(i,10);var r=e(this.data1);this.note=r,this.noteName=r.fullName,this.noteNumber=r.number,this.octave=r.octave,this.frequency=r.frequency,void 0!==this.midiNote&&(this.midiNote.pitch=this.data1),"new"!==this.state&&(this.state="changed"),void 0!==this.part&&(this.part.needsUpdate=!0)}else n.debug>=1&&s.error("you can only set the pitch of note on and note off events")},i.prototype.move=function(e){isNaN(e)?n.debug>=1&&s.error("please provide a number"):(this.ticks+=parseInt(e,10),"new"!==this.state&&(this.state="changed"),void 0!==this.part&&(this.part.needsUpdate=!0))},i.prototype.moveTo=function(){var e=o.call(arguments);"ticks"===e[0]&&!1===isNaN(e[1])?this.ticks=parseInt(e[1],10):void 0===this.song?n.debug>=1&&s.error("The midi event has not been added to a song yet; you can only move to ticks values"):!1===(e=this.song.getPosition(e))?n.debug>=1&&s.error("wrong position data"):this.ticks=e.ticks,"new"!==this.state&&(this.state="changed"),void 0!==this.part&&(this.part.needsUpdate=!0)},i.prototype.reset=function(e,t,i){t=void 0===t,i=void 0===i,(e=void 0===e)&&(this.part=void 0,this.partId=void 0),t&&(this.track=void 0,this.trackId=void 0,this.channel=0),i&&(this.song=void 0)},i.prototype.update=function(){},n.createMidiEvent=function(){var e=o.call(arguments);return"MidiEvent"===e[0].className?e[0].copy():new i(e)},n.protectedScope.addInitMethod(function(){e=n.createNote,t=n.protectedScope.typeString})}(),function(){var e={"note off":128,"note on":144,"poly pressure":160,"control change":176,"program change":192,"channel pressure":208,"pitch bend":224,tempo:81,"time signature":88,"end of track":47},t={NOTE_OFF:128,NOTE_ON:144,POLY_PRESSURE:160,CONTROL_CHANGE:176,PROGRAM_CHANGE:192,CHANNEL_PRESSURE:208,PITCH_BEND:224,TEMPO:81,TIME_SIGNATURE:88,END_OF_TRACK:47},i={128:"note off",144:"note on",160:"poly pressure",176:"control change",192:"program change",208:"channel pressure",224:"pitch bend",81:"tempo",88:"time signature",47:"end of track"},n={128:"NOTE_OFF",144:"NOTE_ON",160:"POLY_PRESSURE",176:"CONTROL_CHANGE",192:"PROGRAM_CHANGE",208:"CHANNEL_PRESSURE",224:"PITCH_BEND",81:"TEMPO",88:"TIME_SIGNATURE",47:"END_OF_TRACK"};function s(i){var n=!1;return i=i.replace(/_/g," "),!1!==(n=e[i]||!1)?n:(i=i.replace(/\s/g,"_"),!1===(n=t[i]||!1)&&!0===sequencer.debug&&console.warn(i,"is not a valid (or supported) midi event name, please consult documentation"),n)}function o(e,t){var s=!1;return"lower"===(t=t||"upper")?(!1===(s=i[e]||!1)&&!0===sequencer.debug&&console.warn(e,"is not a valid (or supported) midi event number, please consult documentation"),s):(!1===(s=n[e]||!1)&&!0===sequencer.debug&&console.warn(e,"is not a valid (or supported) midi event number, please consult documentation"),s)}Object.defineProperty(sequencer,"DUMMY_EVENT",{value:0}),Object.defineProperty(sequencer,"MIDI_NOTE",{value:112}),Object.defineProperty(sequencer,"NOTE_OFF",{value:128}),Object.defineProperty(sequencer,"NOTE_ON",{value:144}),Object.defineProperty(sequencer,"POLY_PRESSURE",{value:160}),Object.defineProperty(sequencer,"CONTROL_CHANGE",{value:176}),Object.defineProperty(sequencer,"PROGRAM_CHANGE",{value:192}),Object.defineProperty(sequencer,"CHANNEL_PRESSURE",{value:208}),Object.defineProperty(sequencer,"PITCH_BEND",{value:224}),Object.defineProperty(sequencer,"SYSTEM_EXCLUSIVE",{value:240}),Object.defineProperty(sequencer,"MIDI_TIMECODE",{value:241}),Object.defineProperty(sequencer,"SONG_POSITION",{value:242}),Object.defineProperty(sequencer,"SONG_SELECT",{value:243}),Object.defineProperty(sequencer,"TUNE_REQUEST",{value:246}),Object.defineProperty(sequencer,"EOX",{value:247}),Object.defineProperty(sequencer,"TIMING_CLOCK",{value:248}),Object.defineProperty(sequencer,"START",{value:250}),Object.defineProperty(sequencer,"CONTINUE",{value:251}),Object.defineProperty(sequencer,"STOP",{value:252}),Object.defineProperty(sequencer,"ACTIVE_SENSING",{value:254}),Object.defineProperty(sequencer,"SYSTEM_RESET",{value:255}),Object.defineProperty(sequencer,"TEMPO",{value:81}),Object.defineProperty(sequencer,"TIME_SIGNATURE",{value:88}),Object.defineProperty(sequencer,"END_OF_TRACK",{value:47}),sequencer.checkEventType=function(e){return isNaN(e)?s(e):o(e)},sequencer.midiEventNameByNumber=o,sequencer.midiEventNumberByName=s}(),function(){var e,t,i,n,s,o,r,a,c,u,l,d=window.sequencer,p=window.console,h=0;function f(e,t){t&&t(!1)}function m(e,t,i){var n,s,o,l,h,f,m,v,g,y,b,k,N,w,S,E,P,T;for(t=new Uint8Array(t),n=r(t),e.base64="",e.numTracks=0,s=0,m=n.tracks.length,!0===d.overrulePPQ&&!1===isNaN(d.defaultPPQ)&&d.defaultPPQ>0?(E=d.defaultPPQ/n.header.ticksPerBeat,e.ppq=d.defaultPPQ):(E=1,e.ppq=n.header.ticksPerBeat),w=[],e.tracks=[];s<m;){for(l=(v=n.tracks[s]).length,y=0,b=0,k=-1,h=c(),f=a(),N=[],o=0,0,0,0,{},{},o=0;o<l;o++){switch(b+=(g=v[o]).deltaTime*E,-1===k&&void 0!==g.channel&&(k=g.channel,f.channel=k),"noteOn"===(P=g.subtype)?0:"noteOff"===P?0:0,g.subtype){case"trackName":f.name=g.text;break;case"instrumentName":g.text&&(f.instrumentName=g.text);break;case"noteOn":N.push(u(b,144,g.noteNumber,g.velocity));break;case"noteOff":N.push(u(b,128,g.noteNumber,g.velocity));break;case"endOfTrack":break;case"setTempo":S=6e7/g.microsecondsPerBeat,b===y&&T===P&&(d.debug>=3&&p.info("tempo events on the same tick",o,b,S),w.pop()),void 0===e.bpm&&(e.bpm=S),w.push(u(b,81,S));break;case"timeSignature":b===y&&T===P&&(d.debug>=3&&p.info("time signature events on the same tick",o,b,g.numerator,g.denominator),w.pop()),void 0===e.nominator&&(e.nominator=g.numerator,e.denominator=g.denominator),w.push(u(b,88,g.numerator,g.denominator));break;case"controller":N.push(u(b,176,g.controllerType,g.value));break;case"programChange":N.push(u(b,192,g.programNumber));break;case"channelAftertouch":N.push(u(b,208,g.amount));break;case"pitchBend":N.push(u(b,224,g.value))}T=P,y=b}N.length>0&&(f.addPart(h),h.addEvents(N),e.tracks.push(f),e.numTracks++),s++}e.timeEvents=w,e.autoSize=!0,e.loaded=!0,i(e)}function v(i,s){void 0===i.base64?void 0===i.arraybuffer?n({url:i.url,responseType:i.responseType,onError:function(){f(0,s)},onSuccess:function(n){if("json"===i.responseType){if(null===n)return void s(!1);if(void 0===n.base64)return f(0,s),void(d.debug&&p.warn("no base64 data"));void 0!==n.name&&void 0===i.name&&(i.name=n.name),void 0!==n.folder&&void 0===i.folder&&(i.folder=n.folder),void 0===i.name&&(i.name=e(i.url).name),i.localPath=void 0!==i.folder?i.folder+"/"+i.name:i.name,m(i,t(n.base64),s)}else void 0===i.name&&(i.name=e(i.url).name),i.localPath=void 0!==i.folder?i.folder+"/"+i.name:i.name,m(i,n,s)}}):m(i,i.arraybuffer,s):m(i,t(i.base64),s)}l=function(e){this.id="MF"+h+++(new Date).getTime(),this.className="MidiFile",this.url=e.url,this.json=e.json,this.base64=e.base64,this.arraybuffer=e.arraybuffer,this.name=e.name,this.folder=e.folder,void 0!==this.url?this.responseType=this.url.indexOf(".json")===this.url.lastIndexOf(".")?"json":"arraybuffer":void 0===this.name&&void 0===this.folder?(this.name=this.id,this.localPath=this.id):this.localPath=void 0!==this.folder?this.folder+"/"+this.name:this.name},d.addMidiFile=function(e,t){var n,r,a,c;if("object"!==i(e))return d.debug>=2&&p.warn("can't create a MidiFile with this data",e),!1;if(e.json){if(r=e.json,a=e.name,c=e.folder,"string"===i(r))try{r=JSON.parse(r)}catch(t){return d.debug>=2&&p.warn("can't create a MidiFile with this data",e),!1}if(void 0===r.base64)return d.debug>=2&&p.warn("can't create a MidiFile with this data",e),!1;e={base64:r.base64,name:void 0===a?r.name:a,folder:void 0===c?r.folder:c}}n=new l(e),d.addTask({type:"load midifile",method:v,params:n},function(){!function(e){var t=s(e.localPath,d.storage.midi,!0),i=e.action;t&&"MidiFile"===t.className&&"overwrite"!==i?d.debug>=2&&(p.warn("there is already a midifile at",e.localPath),f()):o(e,e.localPath,d.storage.midi)}(n),t&&t(n)}),d.startTaskQueue()},d.createMidiFile=function(e){return new function(e){var i=new FileReader;this._promise=new Promise(function(n,s){i.addEventListener("loadend",function(){m({},i.result,function(e){n(e)})}),i.addEventListener("error",function(e){s(e)}),void 0!==e.blob?i.readAsArrayBuffer(e.blob):void 0!==e.arraybuffer?m({},e.arraybuffer,function(e){n(e)}):void 0!==e.base64&&m({},t(e.base64),function(e){n(e)})})}(e)._promise},d.protectedScope.addInitMethod(function(){n=d.protectedScope.ajax,s=d.protectedScope.findItem,o=d.protectedScope.storeItem,d.protectedScope.deleteItem,e=d.protectedScope.parseUrl,i=d.protectedScope.typeString,r=d.protectedScope.parseMidiFile,t=d.protectedScope.base64ToBinary,c=d.createPart,a=d.createTrack,u=d.createMidiEvent})}(),function(){var e,t,i=window.sequencer,n=window.console,s=0;(e=function(e){var o,r,a,c,u,l,d=e.length;if(1===d){if(void 0===(o=e[0]))return void n.error("please provide at least a note on event");this.noteOn=o}else if(2===d){if(o=e[0],r=e[1],void 0===o)return void n.error("please provide at least a note on event");if("MidiEvent"===o.className&&r&"MidiEvent"===r.className){if(o.ticks>=r.ticks)return void n.error("MidiNote has wrong duration");this.noteOn=o,this.noteOff=r}}else{if(4!==d)return void n.error("wrong number of arguments, please consult documentation");if(a=e[0],c=e[1],u=e[2],l=e[3],a&&c&&a>=c)return void n.error("MidiNote has wrong duration");if(u<0||u>127)return void n.error("MidiNote has wrong note number");if(l<0||l>127)return void n.error("MidiNote has wrong velocity");o=t(a,i.NOTE_ON,u,l),r&&(r=t(c,i.NOTE_OFF,u,0))}o.midiNote=this,this.noteOn=o,void 0===r?this.endless=!0:(r.midiNote=this,this.endless=!1,this.noteOff=r,this.durationTicks=r.ticks-o.ticks,this.durationMillis=r.millis-o.millis),this.note=o.note,this.number=o.noteNumber,this.ticks=o.ticks,this.pitch=o.data1,this.velocity=o.velocity,this.id="N"+s+(new Date).getTime(),this.name=o.noteName,this.className="MidiNote",this.type=i.MIDI_NOTE,s++}).prototype.addNoteOff=function(e){void 0!==this.noteOff&&(n.log(e.ticks,e.noteNumber,this.id,"override note off event"),this.noteOff.midiNote=void 0);var t=this.noteOn;e.midiNote=this,this.endless=!1,this.noteOff=e,this.durationTicks=e.ticks-t.ticks,this.durationMillis=e.millis-t.millis,this.endless=!1},e.prototype.setPitch=function(e){e<0||e>127||(this.noteOn.setPitch(e),!1===this.endless&&this.noteOff.setPitch(e),this.number=this.noteOn.noteNumber,this.name=this.noteOn.noteName,this.pitch=e)},e.prototype.mute=function(e){this.mute=void 0!==e?e:!this.mute},i.protectedScope.addInitMethod(function(){t=i.createMidiEvent,i.protectedScope.typeString}),i.createMidiNote=function(){return new e(Array.prototype.slice.call(arguments))}}(),function(){var e,t,i,n=window.sequencer;window.console;function s(e){var t=e.read(4,!0),i=e.readInt32();return{id:t,length:i,data:e.read(i,!1)}}function o(i){var n={};n.deltaTime=i.readVarInt();var s,o,r=i.readInt8();if(240==(240&r)){if(255==r){n.type="meta";var a=i.readInt8();switch(s=i.readVarInt(),a){case 0:if(n.subtype="sequenceNumber",2!==s)throw"Expected length for sequenceNumber event is 2, got "+s;return n.number=i.readInt16(),n;case 1:return n.subtype="text",n.text=i.read(s),n;case 2:return n.subtype="copyrightNotice",n.text=i.read(s),n;case 3:return n.subtype="trackName",n.text=i.read(s),t=n.text,n;case 4:return n.subtype="instrumentName",n.text=i.read(s),n.text,n;case 5:return n.subtype="lyrics",n.text=i.read(s),n;case 6:return n.subtype="marker",n.text=i.read(s),n;case 7:return n.subtype="cuePoint",n.text=i.read(s),n;case 32:if(n.subtype="midiChannelPrefix",1!==s)throw"Expected length for midiChannelPrefix event is 1, got "+s;return n.channel=i.readInt8(),n;case 47:if(n.subtype="endOfTrack",0!==s)throw"Expected length for endOfTrack event is 0, got "+s;return n;case 81:if(n.subtype="setTempo",3!==s)throw"Expected length for setTempo event is 3, got "+s;return n.microsecondsPerBeat=(i.readInt8()<<16)+(i.readInt8()<<8)+i.readInt8(),n;case 84:if(n.subtype="smpteOffset",5!==s)throw"Expected length for smpteOffset event is 5, got "+s;var c=i.readInt8();return n.frameRate={0:24,32:25,64:29,96:30}[96&c],n.hour=31&c,n.min=i.readInt8(),n.sec=i.readInt8(),n.frame=i.readInt8(),n.subframe=i.readInt8(),n;case 88:if(n.subtype="timeSignature",4!==s)throw"Expected length for timeSignature event is 4, got "+s;return n.numerator=i.readInt8(),n.denominator=Math.pow(2,i.readInt8()),n.metronome=i.readInt8(),n.thirtyseconds=i.readInt8(),n;case 89:if(n.subtype="keySignature",2!==s)throw"Expected length for keySignature event is 2, got "+s;return n.key=i.readInt8(!0),n.scale=i.readInt8(),n;case 127:return n.subtype="sequencerSpecific",n.data=i.read(s),n;default:return n.subtype="unknown",n.data=i.read(s),n}return n.data=i.read(s),n}if(240==r)return n.type="sysEx",s=i.readVarInt(),n.data=i.read(s),n;if(247==r)return n.type="dividedSysEx",s=i.readVarInt(),n.data=i.read(s),n;throw"Unrecognised MIDI event type byte: "+r}0==(128&r)?(o=r,r=e):(o=i.readInt8(),e=r);var u=r>>4;switch(n.channel=15&r,n.type="channel",u){case 8:return n.subtype="noteOff",n.noteNumber=o,n.velocity=i.readInt8(),n;case 9:return n.noteNumber=o,n.velocity=i.readInt8(),0===n.velocity?n.subtype="noteOff":n.subtype="noteOn",n;case 10:return n.subtype="noteAftertouch",n.noteNumber=o,n.amount=i.readInt8(),n;case 11:return n.subtype="controller",n.controllerType=o,n.value=i.readInt8(),n;case 12:return n.subtype="programChange",n.programNumber=o,n;case 13:return n.subtype="channelAftertouch",n.amount=o,n;case 14:return n.subtype="pitchBend",n.value=o+(i.readInt8()<<7),n;default:return n.value=i.readInt8(),n.subtype="unknown",n}}n.protectedScope.parseMidiFile=function(e){return function(e){var n,r,a,c,u,l,d,p,h=[],f=[];if("MThd"!==(d=s(e)).id||6!==d.length)throw"Bad .mid file - header not found";if(n=(p=i(d.data)).readInt16(),r=p.readInt16(),32768&(a=p.readInt16()))throw"Expressing time division in SMTPE frames is not supported yet";var m={formatType:n,trackCount:r,ticksPerBeat:a};for(c=0;c<r;c++){if(h[c]=[],f[c]=t,"MTrk"!==(u=s(e)).id)throw"Unexpected chunk - expected MTrk, got "+u.id;for(l=i(u.data);!l.eof();){var v=o(l);h[c].push(v)}}return{header:m,tracks:h,trackNames:f}}(i(e))},n.protectedScope.addInitMethod(function(){i=n.protectedScope.createStream})}(),function(){var e=window.sequencer,t=(window.console,String.fromCharCode);e.protectedScope.createStream=function(e){var i=0;function n(t){var n=e[i];return t&&n>127&&(n-=256),i+=1,n}return{eof:function(){return i>=e.length},read:function(n,s){var o,r;if(s=void 0===s||s){for(o="",r=0;r<n;r++,i++)o+=t(e[i]);return o}for(o=[],r=0;r<n;r++,i++)o.push(e[i]);return o},readInt32:function(){var t=(e[i]<<24)+(e[i+1]<<16)+(e[i+2]<<8)+e[i+3];return i+=4,t},readInt16:function(){var t=(e[i]<<8)+e[i+1];return i+=2,t},readInt8:n,readVarInt:function(){for(var e=0;;){var t=n();if(!(128&t))return e+t;e+=127&t,e<<=7}}}}}(),function(){var e,t,i,n,s,o,r,a,c,u=window.sequencer,l=window.console,d=Array.prototype.slice,p=!1,h=0;function f(e){a=[],c=[],r.inputs.forEach(function(e){a.push({name:e.name,id:e.id}),u.midiInputs[e.id]=e}),a.sort(function(e,t){var i=e.name.toLowerCase(),n=t.name.toLowerCase();return i<n?-1:i>n?1:0}),u.numMidiInputs=a.length,r.outputs.forEach(function(e){c.push({name:e.name,id:e.id}),u.midiOutputs[e.id]=e}),c.sort(function(e,t){var i=e.name.toLowerCase(),n=t.name.toLowerCase();return i<n?-1:i>n?1:0}),u.numMidiOutputs=c.length}function m(t,s,o){var r,a,c,u=s.song;if(t.recordMillis=1e3*e.currentTime,t.state="recorded",144===t.type)r=n(t),s.recordingNotes[t.data1]=r;else if(128===t.type){if(void 0===(r=s.recordingNotes[t.data1]))return;r.addNoteOff(t),delete s.recordingNotes[t.data1]}(u.prerolling||u.recording)&&"midi"===s.recordEnabled?(144===t.type&&s.song.recordedNotes.push(r),s.recordPart.addEvent(t),s.song.recordedEvents.push(t)):s.enableRetrospectiveRecording&&s.retrospectiveRecording.push(t),void 0!==(a=s.midiEventListeners[t.type])&&i(a,function(e){e(t,o)}),"any"!==(c=s.channel)&&void 0!==c&&!0!==isNaN(c)||(c=0),i(s.midiOutputs,function(e){128!==t.type&&144!==t.type&&176!==t.type||e.send([t.type,t.data1,t.data2])}),!1===s.routeToMidiOut&&(t.track=s,s.instrument.processEvent(t))}function v(e,t){var n,s,o=document.createElement("select"),r=e.type,a=e.id||r,c=e.div,u=e.firstOption;if("input"===r||"output"===r)return void 0===u&&(u="input"===r?"choose MIDI in":"choose MIDI out"),o.id=a,s="input"===r?t.midiInputs:t.midiOutputs,!1!==u&&((n=document.createElement("option")).value=-1,n.innerHTML=u,o.appendChild(n)),i(s,function(e){(n=document.createElement("option")).value=e.id,n.innerHTML=e.name,o.appendChild(n)}),c&&c.appendChild(o),o;l.log('please set type to "input" or "output"')}function g(e,t){var n,s;if(t===u)for(n=0,s=a.length;n<s;n++)e(t.midiInputs[a[n].id],n);else i(t.midiInputs,function(t){e(t,n)})}function y(e,t){var n,s;if(t===u)for(n=0,s=c.length;n<s;n++)e(t.midiOutputs[c[n].id],n);else i(t.midiOutputs,function(t,i){e(t,i)})}u.getMidiPortsAsDropdown=function(){v(u)},u.getMidiInputsAsDropdown=function(e){return v(e=e||{type:"input"},u)},u.getMidiOutputsAsDropdown=function(e){return v(e=e||{type:"output"},u)},u.getMidiInputs=function(e){g(e,u)},u.getMidiOutputs=function(e){y(e,u)},u.protectedScope.addInitMethod(function(){e=u.protectedScope.context,n=u.createMidiNote,s=u.createMidiEvent,t=u.protectedScope.typeString,i=u.protectedScope.objectForEach}),u.protectedScope.initMidi=function(e){!0!==p?(p=!0,void 0!==navigator.requestMIDIAccess?navigator.requestMIDIAccess().then(function(t){void 0!==t._jazzInstances?(u.jazz=t._jazzInstances[0]._Jazz.version,u.midi=!0):(u.webmidi=!0,u.midi=!0),(r=t).onstatechange=f,f(),e()},function(t){l.log("MIDI could not be initialized:",t),e()}):("chrome"===u.browser?l.log("Web MIDI API not enabled"):l.log("Web MIDI API not supported"),e())):e()},u.protectedScope.initMidiSong=function(e){o=function(t){!function(e,t,n){var o,r,a,c,u=e.data,l=t.tracks,d=t.numTracks;for(a=s(t.ticks,u[0],u[1],u[2]),o=0;o<d;o++)!0===(r=l[o]).monitor&&void 0!==r.midiInputs[n.id]&&m(a,r,n);void 0!==(c=t.midiEventListeners[a.type])&&i(c,function(e){e(a,n)})}(t,e,this)},i(u.midiInputs,function(t){t.onmidimessage=o,e.midiInputs[t.id]=t}),i(u.midiOutputs,function(t){e.midiOutputs[t.id]=t}),e.numMidiInputs=u.numMidiInputs,e.numMidiOutputs=u.numMidiOutputs},u.protectedScope.getMidiInputs=g,u.protectedScope.getMidiOutputs=y,u.protectedScope.setMidiInputSong=function(e,t,i){var n,s=u.midiInputs[e],r=i.tracks,a=i.numTracks-1;if(t=void 0===t||t,void 0!==s)for(!1===t?(delete i.midiInputs[e],s.onmidimessage=null,i.numMidiInputs--):void 0!==s&&(i.midiInputs[e]=s,s.onmidimessage=o,i.numMidiInputs++),n=a;n>=0;n--)r[n].setMidiInput(e,t);else!0===u.debug&&l.log("no midi input with id",e,"found")},u.protectedScope.setMidiOutputSong=function(e,t,i){var n,s,o=u.midiOutputs[e],r=i.tracks,a=i.numTracks-1;if(t=void 0===t||t,void 0!==o)for(!1===t?(delete i.midiOutputs[e],i.numMidiOutputs--,s=i.scheduler.lastEventTime+100,o.send([176,123,0],s),o.send([176,121,0],s)):void 0!==o&&(i.midiOutputs[e]=o,i.numMidiOutputs++),n=a;n>=0;n--)r[n].setMidiOutput(e,t);else!0===u.debug&&l.log("no midi output with id",e,"found")},u.protectedScope.addMidiEventListener=function(e,n){e=d.call(e);var s,o,r=h++,a={},c=[];return(o=function(e,i,n){for(i=0;i<n;i++){var r=e[i],c=t(r);"array"===c?o(r,0,r.length):"function"===c?s=r:!1===isNaN(r)?(r=parseInt(r,10),!1!==u.checkEventType(r)&&(a[r]=r)):"string"===c&&!1!==u.checkEventType(r)&&(r=u.midiEventNumberByName(r),a[r]=r)}})(e,0,e.length),i(a,function(e){void 0===n.midiEventListeners[e]&&(n.midiEventListeners[e]={}),n.midiEventListeners[e][r]=s,c.push(e+"_"+r)}),1===c.length?c[0]:c},u.protectedScope.getMidiPortsAsDropdown=v,u.protectedScope.removeMidiEventListener=function(e,t){var i;i=(e=e.split("_"))[0],e=e[1],delete t.midiEventListeners[i][e]},u.protectedScope.removeMidiEventListeners=function(){},u.protectedScope.handleMidiMessageTrack=m}(),function(){var e=window.sequencer,t=(window.console,Array.prototype),i=e.defaultPPQ,n=["M".charCodeAt(0),"T".charCodeAt(0),"h".charCodeAt(0),"d".charCodeAt(0)],s=[0,0,0,6],o=[0,1],r=l(i.toString(16),2),a=["M".charCodeAt(0),"T".charCodeAt(0),"r".charCodeAt(0),"k".charCodeAt(0)];function c(e){var t,i,a,c,d,p,h=[].concat(n,s,o),f=e.tracks,m=e.tracks.length+1;for(h=(h=h.concat(l(m.toString(16),2),r)).concat(u(e.timeEvents,e.durationTicks,"tempo")),t=0,i=f.length;t<i;t++)a=f[t],h=h.concat(u(a.events,e.durationTicks,a.name,a.instrumentId));for(i=h.length,d=new ArrayBuffer(i),p=new Uint8Array(d),t=0;t<i;t++)p[t]=h[t];c=new Blob([p],{type:"application/x-midi",endings:"transparent"}),saveAs(c,e.name)}function u(e,t,n,s){var o,r,c,u,h,f=0,m=0,v=[];for(n&&(v.push(0),v.push(255),v.push(3),v=(v=v.concat(d(n.length))).concat(p(n))),s&&(v.push(0),v.push(255),v.push(4),v=(v=v.concat(d(s.length))).concat(p(s))),r=0,c=e.length;r<c;r++){if(m=d(m=(u=e[r]).ticks-f),v=v.concat(m),128===u.type||144===u.type)h=u.type+u.channel,v.push(h),v.push(u.noteNumber),v.push(u.velocity);else if(81===u.type){v.push(255),v.push(81),v.push(3);var g=Math.round(6e7/u.bpm);v=v.concat(l(g.toString(16),3))}else if(88===u.type){var y=u.denominator;2===y?y=1:4===y?y=2:8===y?y=3:16===y?y=4:32===y&&(y=5),v.push(255),v.push(88),v.push(4),v.push(u.nominator),v.push(y),v.push(i/u.nominator),v.push(8)}f=u.ticks}return m=d(m=t-f),(v=v.concat(m)).push(255),v.push(47),v.push(0),o=l(v.length.toString(16),4),[].concat(a,o,v)}function l(e,t){if(t)for(;e.length/2<t;)e="0"+e;for(var i=[],n=e.length-1;n>=0;n-=2){var s=0===n?e[n]:e[n-1]+e[n];i.unshift(parseInt(s,16))}return i}function d(e){for(var t=127&e;e>>=7;)t<<=8,t|=127&e|128;for(var i=[];i.push(255&t),128&t;)t>>=8;return i}function p(e){return t.map.call(e,function(e){return e.charCodeAt(0)})}e.protectedScope.saveToMidiFile=c,e.saveSongAsMidiFile=c}(),function(){var e,t,i,n=window.sequencer,s=window.console;function o(e){var o=(new DOMParser).parseFromString(e,"application/xml"),r=o.firstChild.nextSibling.nodeName;return i=o.createNSResolver(null===o.ownerDocument?o.documentElement:o.ownerDocument.documentElement),"score-partwise"===r?function(e){var s,o,r,a,c,u,l,d,p,h,f,m,v,g,y,b,k,N,w,S,E,P,T,A,I,x,O,M,C,B,R,_,V=e.evaluate("//score-part",e,i,XPathResult.ANY_TYPE,null),q=[],L=[],U={},D=n.defaultPPQ;for(;null!==(s=V.iterateNext());){for(b=e.evaluate("@id",s,i,XPathResult.STRING_TYPE,null).stringValue,y=e.evaluate("part-name",s,i,XPathResult.STRING_TYPE,null).stringValue,x=e.evaluate("midi-instrument/volume",s,i,XPathResult.NUMBER_TYPE,null).numberValue,x=parseInt(x/100*127),_=0,f=n.createTrack(y),m=n.createPart(),f.addPart(m),q.push(f),h=[],o=e.evaluate('//part[@id="'+b+'"]/measure',s,i,XPathResult.ANY_TYPE,null);null!==(r=o.iterateNext());)for(e.evaluate("@number",r,i,XPathResult.NUMBER_TYPE,null).numberValue,k=e.evaluate("attributes/divisions",r,i,XPathResult.NUMBER_TYPE,null).numberValue,isNaN(k)||(C=k),k=e.evaluate("attributes/time/beats",r,i,XPathResult.NUMBER_TYPE,null).numberValue,N=e.evaluate("attributes/time/beat-type",r,i,XPathResult.NUMBER_TYPE,null).numberValue,isNaN(k)||(B=k,R=N,L.push(n.createMidiEvent(_,n.TIME_SIGNATURE,B,R))),a=e.evaluate("*[self::note or self::backup or self::forward]",r,i,XPathResult.ANY_TYPE,null);null!==(c=a.iterateNext());){for(u=!1,l=!1,d=e.evaluate("tie",c,i,XPathResult.ANY_TYPE,null);null!==(p=d.iterateNext());)"start"===(k=e.evaluate("@type",p,i,XPathResult.STRING_TYPE,null).stringValue)?u=!0:"stop"===k&&(l=!0);if(O=e.evaluate("rest",c,i,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue,M=e.evaluate("chord",c,i,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue,null!==O)T=e.evaluate("duration",c,i,XPathResult.NUMBER_TYPE,null).numberValue,_+=T/C*D;else if("note"===c.nodeName){if(w=e.evaluate("pitch/step",c,i,XPathResult.STRING_TYPE,null).stringValue,S=e.evaluate("pitch/alter",c,i,XPathResult.NUMBER_TYPE,null).numberValue,P=e.evaluate("voice",c,i,XPathResult.NUMBER_TYPE,null).numberValue,E=e.evaluate("pitch/octave",c,i,XPathResult.NUMBER_TYPE,null).numberValue,T=e.evaluate("duration",c,i,XPathResult.NUMBER_TYPE,null).numberValue,e.evaluate("type",c,i,XPathResult.STRING_TYPE,null).stringValue,A=w,""!==w){if(!isNaN(S))switch(S){case-2:A+="bb";break;case-1:A+="b";break;case 1:A+="#";break;case 2:A+="##"}I=t(A,E),v=n.createMidiEvent(_,n.NOTE_ON,I,x),_+=T/C*D,g=n.createMidiEvent(_,n.NOTE_OFF,I,0),null!==M&&(_-=T/C*D),!1===u&&!1===l?h.push(v,g):!0===u&&!1===l?(U[P+"-"+I]=g,h.push(v,g)):!0===u&&!0===l?U[P+"-"+I].ticks+=T/C*D:!1===u&&!0===l&&(U[P+"-"+I].ticks+=T/C*D,delete U[P+"-"+I])}}else"backup"===c.nodeName?(T=e.evaluate("duration",c,i,XPathResult.NUMBER_TYPE,null).numberValue,_-=T/C*D):"forward"===c.nodeName&&(T=e.evaluate("duration",c,i,XPathResult.NUMBER_TYPE,null).numberValue,_+=T/C*D)}m.addEvents(h)}return n.createSong({bpm:110,tracks:q[0],timeEvents:L,useMetronome:!1})}(o):"score-timewise"===r?function(e){return e}(o):(s.log("unknown type",r),!1)}n.loadMusicXML=function(t,i,r){void 0!==t&&void 0!==i||n.debug>=n.WARN&&s.warn("please provide an url and a callback method"),e({url:t+"?"+(new Date).getTime(),method:"GET",onError:function(){i(!1)},onSuccess:function(e){i(!0===r?e:o(e))},responseType:"xml"})},n.parseMusicXML=o,n.protectedScope.addInitMethod(function(){e=n.protectedScope.ajax,n.protectedScope.typeString,t=n.getNoteNumber})}(),function(){var e,t,i,n,s,o,r,a,c,u=Math.pow;t={sharp:["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],flat:["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"],"enharmonic-sharp":["B#","C#","C##","D#","D##","E#","F#","F##","G#","G##","A#","A##"],"enharmonic-flat":["Dbb","Db","Ebb","Eb","Fb","Gbb","Gb","Abb","Ab","Bbb","Bb","Cb"]},r=function(){var t,r,u,l,d,p=Array.prototype.slice.call(arguments),h=p.length,f=!1,m=!1,v=p[0],g=p[1],y=p[2];return 1!==h||isNaN(v)?1===h&&"string"===e(v)?(t=s(v))?(u=t[0],r=t[1],(l=i(u,r))?(l<0||l>127)&&(m="please provide a note between C0 and G10"):m=v+" is not a valid note name, please use letters A - G and if necessary an accidental like #, ##, b or bb, followed by a number for the octave"):m=v+" is not a valid note name, please use letters A - G and if necessary an accidental like #, ##, b or bb, followed by a number for the octave":2!==h||"string"!==e(v)||isNaN(g)?2===h&&"string"===e(v)&&"string"===e(g)?(t=s(v))?((d=a(g))||(f=g+" is not a valid note name mode, using "+(d=sequencer.noteNameMode)),u=t[0],r=t[1],(l=i(u,r))?(l<0||l>127)&&(m="please provide a note between C0 and G10"):m=u+" is not a valid note name, please use letters A - G and if necessary an accidental like #, ##, b or bb, followed by a number for the octave",u=n(l,d)[0]):m=v+" is not a valid note name, please use letters A - G and if necessary an accidental like #, ##, b or bb, followed by a number for the octave":2===h&&"number"===e(v)&&"string"===e(g)?v<0||v>127?m="please provide a note number >= 0 and <= 127":((d=a(g))||(f=g+" is not a valid note name mode, using "+(d=sequencer.noteNameMode)),u=(t=n(l=v,d))[0],r=t[1],u=n(l,d)[0]):3!==h||"string"!==e(v)||isNaN(g)||"string"!==e(y)?m="wrong arguments, please consult documentation":(t=s(v,g))?((d=a(y))||(f=y+" is not a valid note name mode, using "+(d=sequencer.noteNameMode)),u=t[0],r=t[1],(l=i(u,r))?(l<0||l>127)&&(m="please provide a note between C0 and G10"):m=u+" is not a valid note name, please use letters A - G and if necessary an accidental like #, ##, b or bb, followed by a number for the octave",u=n(l,d)[0]):m=v+" is not a valid note name, please use letters A - G and if necessary an accidental like #, ##, b or bb, followed by a number for the octave":(t=s(v,g))?(u=t[0],r=t[1],(l=i(u,r))?(l<0||l>127)&&(m="please provide a note between C0 and G10"):m=u+" is not a valid note name, please use letters A - G and if necessary an accidental like #, ##, b or bb"):m=v+" is not a valid note name, please use letters A - G and if necessary an accidental like #, ##, b or bb":v<0||v>127?m="please provide a note number >= 0 and <= 127":(u=(t=n(l=v))[0],r=t[1]),m?(console.error(m),!1):(f&&console.warn(f),{name:u,octave:r,fullName:u+r,number:l,frequency:o(l),blackKey:c(l)})},n=function(e,i){i=i||sequencer.noteNameMode;var n=Math.floor(e/12-1);return[t[i][e%12],n]},i=function(e,i,n){var s,o,r,a;for(s in t)if(t.hasOwnProperty(s))for(r=0,a=(n=t[s]).length;r<a;r+=1)if(n[r]===e){o=r;break}return-1!==o&&o+12+12*i},o=function(e){return sequencer.pitch*u(2,(e-69)/12)},s=function(){var t,i,n,s,o,r=Array.prototype.slice.call(arguments),a=r.length,c=r[0],u=r[1];if(1===a&&"string"===e(c)){for(t=c.length,s="",o="",i=0;i<t;i++)n=c[i],isNaN(n)&&"-"!==n?s+=n:o+=n;""===o&&(o=0)}else{if(2!==a||"string"!==e(c)||isNaN(u))return!1;s=c,o=u}return o=parseInt(o,10),[s=s.substring(0,1).toUpperCase()+s.substring(1),o]},a=function(e){var t=!1;switch(e){case"sharp":case"flat":case"enharmonic-sharp":case"enharmonic-flat":t=e}return t},c=function(e){var t;switch(!0){case e%12==1:case e%12==3:case e%12==6:case e%12==8:case e%12==10:t=!0;break;default:t=!1}return t},sequencer.getNoteNumber=function(){var e=r.apply(this,arguments);return!!e&&e.number},sequencer.getNoteName=function(){var e=r.apply(this,arguments);return!!e&&e.name},sequencer.getNoteNameFromNoteNumber=function(e,t){return n(e,t)},sequencer.getNoteOctave=function(){var e=r.apply(this,arguments);return!!e&&e.octave},sequencer.getFullNoteName=function(){var e=r.apply(this,arguments);return!!e&&e.fullName},sequencer.getFrequency=function(){var e=r.apply(this,arguments);return!!e&&e.frequency},sequencer.isBlackKey=function(){var e=r.apply(this,arguments);return!!e&&e.blackKey},Object.defineProperty(sequencer,"SHARP",{value:"sharp"}),Object.defineProperty(sequencer,"FLAT",{value:"flat"}),Object.defineProperty(sequencer,"ENHARMONIC_SHARP",{value:"enharmonic-sharp"}),Object.defineProperty(sequencer,"ENHARMONIC_FLAT",{value:"enharmonic-flat"}),sequencer.createNote=r,sequencer.protectedScope.addInitMethod(function(){e=sequencer.protectedScope.typeString})}(),function(){var e,t,i,n,s,o,r,a,c,u,l,d,p,h,f,m=window.sequencer,v=(window.console,Math.round),g=Math.pow(10,m.precision);function y(y){var b,k;b=m.getNiceTime(h),y.bpm=f,y.factor=e,y.nominator=t,y.denominator=i,y.ticksPerBar=a,y.ticksPerBeat=c,y.ticksPerSixteenth=u,y.numSixteenth=l,y.millisPerTick=d,y.secondsPerTick=p,y.millis=v(h*g)/g,y.hour=b.hour,y.minute=b.minute,y.second=b.second,y.millisecond=b.millisecond,y.timeAsString=b.timeAsString,y.timeAsArray=b.timeAsArray,y.bar=n,y.beat=s,y.sixteenth=o,y.tick=r,k=0===r?"000":r<10?"00"+r:r<100?"0"+r:r,y.barsAsString=n+":"+s+":"+o+":"+k,y.barsAsArray=[n,s,o,r],y.state="clean",y.update()}m.protectedScope.parseEvents=function(m,v){var g,b,k,N,w=0;for(b=v.length,v.sort(function(e,t){return e.sortIndex-t.sortIndex}),function(m){f=m.bpm,e=m.factor,t=m.nominator,i=m.denominator,a=m.ticksPerBar,c=m.ticksPerBeat,u=m.ticksPerSixteenth,l=m.numSixteenth,d=m.millisPerTick,p=m.secondsPerTick,h=m.millis,n=m.bar,s=m.beat,o=m.sixteenth,r=m.tick}(m.timeEvents[0]),N=0;N<b;N++){for(k=(g=v[N]).ticks-w,r+=k;r>=u;)for(o++,r-=u;o>l;)for(o-=l,s++;s>t;)s-=t,n++;switch(g.type){case 81:f=g.bpm,h=g.millis,d=g.millisPerTick,p=g.secondsPerTick;break;case 88:e=g.factor,t=g.nominator,i=g.denominator,l=g.numSixteenth,a=g.ticksPerBar,c=g.ticksPerBeat,u=g.ticksPerSixteenth,h=g.millis;break;default:h+=k*d,y(g)}w=g.ticks}m.lastEventTmp=g},m.protectedScope.addInitMethod(function(){})}(),function(){var e,t,i,n,s,o,r,a,c,u,l,d,p,h,f,m,v,g,y,b,k=window.sequencer,N=window.console;function w(){p=1e3*(h=1/o*60/t/e)}function S(){g=4*(i=4/s),m=(f=e*i)*n,v=e/4}function E(e){e.bpm=t,e.nominator=n,e.denominator=s,e.ticksPerBar=m,e.ticksPerBeat=f,e.ticksPerSixteenth=v,e.factor=i,e.numSixteenth=g,e.secondsPerTick=h,e.millisPerTick=p,e.ticks=l,e.millis=d,e.seconds=d/1e3,e.bar=r,e.beat=a,e.sixteenth=c,e.tick=u;var o=0===u?"000":u<10?"00"+u:u<100?"0"+u:u;e.barsAsString=r+":"+a+":"+c+":"+o,e.barsAsArray=[r,a,c,u];var y=k.getNiceTime(d);e.hour=y.hour,e.minute=y.minute,e.second=y.second,e.millisecond=y.millisecond,e.timeAsString=y.timeAsString,e.timeAsArray=y.timeAsArray}k.protectedScope.parseTimeEvents=function(i){var h,f,m,k=0;if(void 0===i)return y=[],void N.log("reset",y);for(function(i){o=i.playbackSpeed,y=i.timeEvents,b=y.length,e=i.ppq,t=i.bpm,n=i.nominator,s=i.denominator,0,r=1,a=1,c=1,u=0,l=0,d=0}(i),w(),S(),y.sort(function(e,t){return e.ticks-t.ticks}),k=0;k<b;k++){for((f=y[k]).song=i,h=f.ticks-l,u+=h,l=f.ticks,m=f.type,d+=h*p;u>=v;)for(c++,u-=v;c>g;)for(c-=g,a++;a>n;)a-=n,r++;switch(m){case 81:t=f.bpm,w();break;case 88:n=f.nominator,s=f.denominator,S();break;default:continue}E(f)}i.lastEventTmp=f},k.protectedScope.addInitMethod(function(){k.createMidiEvent})}(),function(){var e,t,i,n,s,o,r,a,c,u,l,d,p,h,f,m,v=window.sequencer,g=window.console,y=0;p=function(e,t){var i,s,o,r=0,c=0,u=(e=Array.prototype.slice.call(e))[0],l=[],d=[];if("array"===n(u)){for(c=u.length-1;c>=0;c--)o=u[c],(s=a(o,t))&&l.push(s);r=0===l.length?0:1}for(i=e.length,c=r;c<i;c++)o=e[c],(s=a(o,t))?l.push(s):d.push(o);return 0===l.length?(v.debug&&g.warn("no events added",t.name),!1):(1===d.length&&"array"===n(d[0])&&(d=d[0]),{events:l,config:d})},a=function(e,i){var s=!1;return e?"MidiEvent"===e.className||"AudioEvent"===e.className?s=e:"array"===n(e)&&4===e.length?s=t(e):"string"===n(e)?s=i.eventsById[e]:!1===isNaN(e)&&(s=i.events[e]):s=!1,s},c=function(e,t,i){if(!1!==e){var n,s,o=e.events,r=t.ticks,a=o.length,c=t.track,u=t.eventsById;for(n=0;n<a;n++)(s=o[n]).type===v.END_OF_TRACK||"MidiEvent"!==s.className&&"AudioEvent"!==s.className||("AudioEvent"===s.className&&!0!==t.hasAudioEvents&&(t.hasAudioEvents=!0),void 0!==s.part&&(s=s.clone()),s.part=t,s.partId=t.id,i&&(r+=s.ticks,s.ticks=r),s.track=c,s.trackId=c?c.id:void 0,s.song=void 0,void 0!==c&&(s.song=c.song),"recorded"!==s.state&&(s.state="new"),u[s.id]=s);"new"!==t.state&&(t.state="changed"),t.needsUpdate=!0}},d=function(e,t){if(!1!==e){var i,n=e.events,s=e.config[0];for(i=n.length-1;i>=0;i--)n[i].transpose(s);"new"!==t.state&&void 0!==t.track&&(t.state="changed",t.track.needsUpdate=!0)}},u=function(e,t){if(!1!==e){var i,n,s,o=e.events,r=e.config[0];if(isNaN(r))g.warn("Part.moveEvent(s) -> please provide a number");else{for(i=o.length-1;i>=0;i--)(s=(n=o[i]).ticks+r)<0&&(s=0),n.ticks=s,"new"!==n.state&&(n.state="changed");t.needsUpdate=!0,"new"!==t.state&&t.track&&(t.state="changed",t.track.needsUpdate=!0)}}},l=function(e,t){var i,n,s=[];for(i=e.length-1;i>=0;i--)!1!==(n=a(e[i],t))&&(n.part===t?(n.state="removed",n.reset(),s.push(n)):g.warn("can't remove: this event belongs to part",n.part.id));return void 0!==t.track&&(t.track.needsUpdate=!0),t.needsUpdate=!0,s},h=function(e){var t,i,n,s,o=e.notes,r=e.lowestNote,a=e.highestNote;for(n=o.length-1;n>=0;n--)(s=o[n]).setPitch(r+(a-s.number)),t=s.noteOn,i=s.noteOff,t.state="changed",i.state="changed",s.state="changed";e.needsUpdate=!0,"new"!==e.state&&e.track&&(e.state="changed",e.track.needsUpdate=!0)},f=function(e,t){var i,n,s,o,r,a,c=e.notes;for(t=t||e.duration.ticks,a=c.length-1;a>=0;a--)n=(i=c[a]).noteOn,o=t-(s=i.noteOff).ticks,r=t-n.ticks,n.ticks=o,s.ticks=r,i.ticks=o,n.state="changed",s.state="changed",i.state="changed";e.needsUpdate=!0,"new"!==e.state&&e.track&&(e.state="changed",e.track.needsUpdate=!0)},(m=function(e){this.className="Part",this.id="P"+y+++(new Date).getTime(),this.partIndex=y,this.name=e||this.id,this.events=[],this.eventsById={},this.numEvents=0,this.notes=[],this.notesById={},this.numNotes=0,this.dirtyEvents={},this.dirtyNotes={},this.song=void 0,this.autoSize="right",this.ticks=0,this.millis=0,this.start={ticks:this.ticks,millis:this.millis},this.end={ticks:0,millis:0},this.duration={ticks:0,millis:0},this.startPosition=void 0,this.endPosition=void 0,this.needsUpdate=!1,this.state="clean",this.mute=!1,this.solo=!1,this.keepWhenEmpty=!0}).prototype.addEvent=m.prototype.addEvents=function(){var e=p(arguments,this);c(e,this,!1)},m.prototype.addEventsRelative=function(){var e=p(arguments,this);c(e,this,!0)},m.prototype.removeEvent=m.prototype.removeEvents=function(){var e=p(arguments,this);return!1!==e&&l(e.events,this)},m.prototype.moveEvent=m.prototype.moveEvents=function(){var e=p(arguments,this);u(e,this)},m.prototype.moveAllEvents=function(e){u({events:this.events,config:[e]},this)},m.prototype.moveNote=function(e,t){u({events:[e.noteOn,e.noteOff],config:[t]},this)},m.prototype.transposeEvents=function(){var e=p(arguments,this);d(e,this)},m.prototype.transposeAllEvents=function(e){d({events:this.events,config:[e]},this)},m.prototype.transposeNote=function(e,t){d({events:[e.noteOn,e.noteOff],config:[t]},this)},m.prototype.reverseByTicks=function(e){this.needsUpdate&&this.update(),f(this,e)},m.prototype.reverseByPitch=function(){this.needsUpdate&&this.update(),h(this)},m.prototype.findEvents=function(e){return s(this,e)},m.prototype.findNotes=function(e){return o(this,e)},m.prototype.getStats=function(e){return r(this,e)},m.prototype.getIndex=function(){var e,t;if(this.track)for(e=this.track.parts,t=this.track.numParts-1;t>=0;t--)if(e[t].id===this.id)return t;return-1},m.prototype.copy=function(){var e,t,n=new m(i(this.name)),s=this.ticks,o=this.eventsById,r=[];for(t in n.song=void 0,n.track=void 0,n.trackId=void 0,o)o.hasOwnProperty(t)&&((e=o[t].copy()).ticks=e.ticks-s,r.push(e));return n.addEvents(r),n},m.prototype.setSolo=function(e){void 0===e&&(e=!this.solo),this.mute=!1,this.solo=e,this.allNotesOff(),this.track&&this.track.setPartSolo(this,e)},m.prototype.allNotesOff=function(){void 0!==this.track&&this.track.instrument.allNotesOffPart(this.id)},m.prototype.reset=function(e,t){var i,n,s=this.eventsById;for(i in t&&(this.song=void 0),e&&(this.track=void 0),this.trackId=void 0,this.start.millis=void 0,this.end.millis=void 0,s)s.hasOwnProperty(i)&&((n=s[i]).ticks-=this.ticks,n.reset(!1,e,t));this.ticks=0,this.needsUpdate=!0},m.prototype.update=function(){var t,i,n,s,o,r,a,c,u,l=[],d=this.id,p=this.track,h=this.track?this.track.id:void 0;for(n in this.events=[],this.eventsById)this.eventsById.hasOwnProperty(n)&&("clean"!==(s=this.eventsById[n]).state&&(this.dirtyEvents[s.id]=s),"removed"!==s.state&&this.events.push(s));for(this.events.sort(function(e,t){return e.sortIndex-t.sortIndex}),t=0,i=this.notes.length;t<i;t++)"removed"===(r=this.notes[t]).noteOn.state||void 0!==r.noteOff&&"removed"===r.noteOff.state?(r.state="removed",this.dirtyNotes[r.id]=r,delete this.notesById[r.id]):("changed"===r.noteOn.state||void 0!==r.noteOff&&"changed"===r.noteOff.state)&&(r.state="changed",this.dirtyNotes[r.id]=r);for(t=0,i=this.events.length;t<i;t++)if(o=(s=this.events[t]).noteNumber,s.type===v.NOTE_ON)void 0===s.midiNote&&((r=e(s)).part=this,r.partId=d,r.track=p,r.trackId=h,r.state="new",this.notesById[r.id]=r,this.dirtyNotes[r.id]=r,void 0===l[o]&&(l[o]=[]),l[o].push(r));else if(s.type===v.NOTE_OFF)if(void 0===s.midiNote){if(void 0===l[o])continue;var f=l[o].length-1;if(void 0!==(r=l[o][f]).noteOff&&r.durationTicks>0)continue;if(null===r)continue;if(void 0===r.noteOn)continue;"new"!==r.state&&(r.state="changed"),this.dirtyNotes[r.id]=r,r.addNoteOff(s)}else void 0===this.notesById[s.midiNote.id]&&((r=s.midiNote).part=this,r.partId=d,r.track=p,r.trackId=h,this.notesById[r.id]=r);for(n in this.notes=[],l=null,this.notesById)this.notesById.hasOwnProperty(n)&&(r=this.notesById[n],this.notes.push(r));if(this.notes.sort(function(e,t){return e.ticks-t.ticks}),this.numEvents=this.events.length,this.numNotes=this.notes.length,a=this.events[0],c=this.events[this.numEvents-1],a)switch(a.ticks<this.ticks&&(this.autoSize="both"),this.autoSize){case"right":this.start.ticks=this.ticks,this.end.ticks=c.ticks,this.duration.ticks=c.ticks-this.start.ticks;break;case"both":this.start.ticks=a.ticks,this.end.ticks=c.ticks,this.duration.ticks=c.ticks-a.ticks}else this.start.ticks=this.ticks,this.end.ticks=this.ticks+100,this.duration.ticks=100;u=this.getStats("noteNumber all"),this.lowestNote=u.min,this.highestNote=u.max,this.ticks=this.start.ticks,"clean"===this.state&&(this.state="changed"),this.needsUpdate=!1},v.createPart=function(){return new m},v.protectedScope.addInitMethod(function(){e=v.createMidiNote,t=v.createMidiEvent,i=v.protectedScope.copyName,n=v.protectedScope.typeString,s=v.findEvent,o=v.findNote,r=v.getStats})}(),function(){var e,t,i,n=window.sequencer,s=(window.console,0);(e=function(e,t,i,n){this.id="POS"+s+++(new Date).getTime(),this.song=e,this.type=t||"",this.name=i||this.id,this.data=n||{},this.lastEvent=void 0,this.activeParts=[],this.activeNotes=[],this.activeEvents=[]}).prototype.set=function(e,t){return this.unit=e,this.currentValue=t,this.eventIndex=0,this.noteIndex=0,this.partIndex=0,this.calculate(),this.data},e.prototype.get=function(){return this.data},e.prototype.update=function(e,t){return 0===t?this.data:(this.unit=e,this.currentValue+=t,this.calculate(),this.data)},e.prototype.updateSong=function(){this.events=this.song.eventsMidiTime,this.numEvents=this.events.length,this.notes=this.song.notes,this.numNotes=this.song.numNotes,this.parts=this.song.parts,this.numParts=this.song.numParts,this.set("millis",this.song.millis||0)},e.prototype.setType=function(e){this.type=e,this.set(this.unit,this.currentValue)},e.prototype.addType=function(e){this.type+=" "+e,this.set(this.unit,this.currentValue)},e.prototype.removeType=function(e){var t=this.type.split(" ");this.type="",t.forEach(function(t){t!==e&&(this.type+=e+" ")}),this.type.trim(),this.set(this.currentValue)},e.prototype.calculate=function(){var e,s,o,r,a,c=[],u=[],l=[],d=[],p=[],h=[];for(e=this.eventIndex;e<this.numEvents&&(s=this.events[e])[this.unit]<=this.currentValue;e++)s.type!==n.MIDI_NOTE&&s.type!==n.DUMMY_EVENT&&h.push(s),this.lastEvent=s,this.eventIndex++;if(void 0===this.lastEvent&&(this.lastEvent=this.song.timeEvents[0]),a=t(this.song,this.unit,this.currentValue,"all",this.lastEvent),this.data.eventIndex=this.eventIndex,this.data.millis=a.millis,this.data.ticks=a.ticks,-1!==this.type.indexOf("all")){var f=this.data;i(a,function(e,t){f[t]=e})}else-1!==this.type.indexOf("barsbeats")?(this.data.bar=a.bar,this.data.beat=a.beat,this.data.sixteenth=a.sixteenth,this.data.tick=a.tick,this.data.barsAsString=a.barsAsString,this.data.ticksPerBar=a.ticksPerBar,this.data.ticksPerBeat=a.ticksPerBeat,this.data.ticksPerSixteenth=a.ticksPerSixteenth,this.data.numSixteenth=a.numSixteenth):-1!==this.type.indexOf("time")?(this.data.hour=a.hour,this.data.minute=a.minute,this.data.second=a.second,this.data.millisecond=a.millisecond,this.data.timeAsString=a.timeAsString):-1!==this.type.indexOf("percentage")&&(this.data.percentage=a.percentage);if(-1!==this.type.indexOf("events")||-1!==this.type.indexOf("all")){for(this.collectedEvents=h,e=this.activeEvents.length-1;e>=0;e--)81!==(s=this.activeEvents[e]).type&&88!==s.type&&0!==s.state.indexOf("removed")&&void 0!==this.song.eventsById[s.id]&&s[this.unit]<=this.currentValue&&s[this.unit]>this.currentValue-10&&l.push(s);for(this.activeEvents=[].concat(l),e=h.length-1;e>=0;e--)(s=h[e])[this.unit]>this.currentValue-10&&this.activeEvents.push(s);for(this.song.activeEvents={},e=this.activeEvents.length-1;e>=0;e--)s=this.activeEvents[e],this.song.activeEvents[s.id]=s}if(-1!==this.type.indexOf("notes")||-1!==this.type.indexOf("all")){for(e=this.noteIndex;e<this.numNotes&&(o=this.notes[e]).noteOn[this.unit]<=this.currentValue;e++)p.push(o),this.noteIndex++;for(e=this.activeNotes.length-1;e>=0;e--)0!==(o=this.activeNotes[e]).noteOn.state.indexOf("removed")&&void 0!==this.song.notesById[o.id]&&(void 0!==o.noteOff?o.noteOn[this.unit]<=this.currentValue&&o.noteOff[this.unit]>this.currentValue&&u.push(o):n.debug);for(this.activeNotes=[].concat(u),e=p.length-1;e>=0;e--)void 0!==(o=p[e]).noteOff?o.noteOff[this.unit]>this.currentValue&&this.activeNotes.push(o):n.debug;for(this.song.activeNotes={},e=this.activeNotes.length-1;e>=0;e--)o=this.activeNotes[e],this.song.activeNotes[o.id]=o}if(-1!==this.type.indexOf("parts")||-1!==this.type.indexOf("all")){for(e=this.partIndex;e<this.numParts&&(r=this.parts[e]).start[this.unit]<=this.currentValue;e++)d.push(r),this.partIndex++;for(e=this.activeParts.length-1;e>=0;e--)(r=this.activeParts[e]).start[this.unit]<=this.currentValue&&r.end[this.unit]>this.currentValue&&c.push(r);for(this.activeParts=[].concat(c),e=d.length-1;e>=0;e--)(r=d[e]).end[this.unit]>this.currentValue&&this.activeParts.push(r);for(this.song.activeParts={},e=this.activeParts.length-1;e>=0;e--)r=this.activeParts[e],this.song.activeParts[r.id]=r}!0===this.busy&&(this.busy=!1)},n.protectedScope.createPlayhead=function(t,i,n,s){return new e(t,i,n,s)},n.protectedScope.addInitMethod(function(){t=n.protectedScope.getPosition2,i=n.protectedScope.objectForEach,n.debug})}(),function(){var e,t,i,n,s,o,r,a,c,u,l,d,p,h,f,m,v,g,y,b,k,N,w,S,E,P,T,A,I,x,O,M,C,B,R,_,V,q=window.sequencer,L=window.console,U="all",D=!0;function F(e,t,i){var n,s,o=e.timeEvents;for(n=o.length-1;n>=0;n--)if((s=o[n])[t]<=i)return N=n,s}w=function(e,t,i){return D=void 0===i,R(e,t),p},S=function(e,t,i){return D=void 0===i,_(e,t),h},E=function(e,t,i){return t=["barsbeats"].concat(t),C(e,t,"millis",i),h},P=function(e,t,i){return t=["barsbeats"].concat(t),C(e,t,"ticks",i),p},T=function(e,t,i){return D=void 0===i,_(e,t),M(),U="barsandbeats",O()},A=function(e,t,i){return D=void 0===i,R(e,t),M(),U="barsandbeats",O()},R=function(e,t,i){var n=e.lastEvent;return!1===D&&t>n.millis&&(t=n.millis),void 0===i&&(i=F(e,"millis",t)),x(i),i.millis===t?(m=0,f=0):(m=t-i.millis,f=m/u),h+=m,p+=f},_=function(e,t,i){var n=e.lastEvent;return!1===D&&t>n.ticks&&(t=n.ticks),void 0===i&&(i=F(e,"ticks",t)),x(i),i.ticks===t?(f=0,m=0):m=(f=t-p)*u,p+=f,h+=m},V=function(e,t,i,n,o,l){var k,w=0,S=e.lastEvent;for(!1===D&&t>S.bar&&(t=S.bar),t=I(t),i=I(i),n=I(n),o=I(o,!0),void 0===l&&(l=F(e,"bar",t)),x(l);o>=c;)n++,o-=c;for(;n>d;)i++,n-=d;for(;i>s;)t++,i-=s;for(l=F(e,"bar",t),w=N;w>=0;w--)if((l=e.timeEvents[w]).bar<=t){x(l);break}k=o-b,m=(t-v)*a*u,m+=(i-g)*r*u,m+=(n-y)*c*u,v=t,g=i,y=n,b=o,h+=m+=k*u,p+=f=m/u},M=function(){for(var t=e(f);t>=c;)for(y++,t-=c;y>d;)for(y-=d,g++;g>s;)g-=s,v++;b=e(t)},x=function(e){n=e.bpm,s=e.nominator,o=e.denominator,a=e.ticksPerBar,r=e.ticksPerBeat,c=e.ticksPerSixteenth,d=e.numSixteenth,u=e.millisPerTick,l=e.secondsPerTick,v=e.bar,g=e.beat,y=e.sixteenth,b=e.tick,p=e.ticks,h=e.millis},O=function(t){var i,f,m={};switch(U){case"millis":m.millis=e(1e3*h)/1e3,m.millisRounded=e(h);break;case"ticks":m.ticks=e(p);break;case"barsbeats":case"barsandbeats":m.bar=v,m.beat=g,m.sixteenth=y,m.tick=b,f=0===b?"000":b<10?"00"+b:b<100?"0"+b:b,m.barsAsString=v+":"+g+":"+y+":"+f;break;case"time":i=q.getNiceTime(h),m.hour=i.hour,m.minute=i.minute,m.second=i.second,m.millisecond=i.millisecond,m.timeAsString=i.timeAsString;break;case"all":m.millis=e(1e3*h)/1e3,m.millisRounded=e(h),m.ticks=e(p),m.bar=v,m.beat=g,m.sixteenth=y,m.tick=b,f=0===b?"000":b<10?"00"+b:b<100?"0"+b:b,m.barsAsString=v+":"+g+":"+y+":"+f,i=q.getNiceTime(h),m.hour=i.hour,m.minute=i.minute,m.second=i.second,m.millisecond=i.millisecond,m.timeAsString=i.timeAsString,m.bpm=e(n*t.playbackSpeed,3),m.nominator=s,m.denominator=o,m.ticksPerBar=a,m.ticksPerBeat=r,m.ticksPerSixteenth=c,m.numSixteenth=d,m.millisPerTick=u,m.secondsPerTick=l,m.percentage=p/t.durationTicks}return m},I=function(t,i){return t=isNaN(t)?i?0:1:t,t=e(t),t=i?t<0?0:t:t<1?1:t},B=function(e){if(U="all",D=!0,"array"===i(e)){var t,n,s,o,r=e.length;if(k=e[0],"array"===i(e[0])&&(e=e[0],k=e[0],r=e.length),t=[k],-1!=="barsandbeats barsbeats time millis ticks perc percentage".indexOf(k)){for(n=1;n<r;n++)if(!0===(s=e[n])||!1===s)D=s;else if(isNaN(s)){if(-1==="barsandbeats barsbeats time millis ticks all".indexOf(s))return!1;U=s}else t.push(s);return(2===(o=t.length)||3===o||5===o)&&t}}return!1},C=function(e,i){var n,s,o,r=B(i);if(!1===r)return L.error("wrong position data"),!1;switch(k){case"barsbeats":case"barsandbeats":return V(e,r[1],r[2],r[3],r[4]),O(e);case"time":return n=0,n+=60*(s=r[1]||0)*60*1e3,n+=60*(s=r[2]||0)*1e3,n+=1e3*(s=r[3]||0),s=r[4]||0,R(e,n+=s),M(),O(e);case"millis":return R(e,r[1]),M(),O(e);case"ticks":return _(e,r[1]),M(),O(e);case"perc":case"percentage":return o=r[2],p=r[1]*e.durationTicks,void 0!==o&&(p=t(p/o)*o),_(e,p),M(),s=O(e)}return!1},q.protectedScope.getPosition=C,q.protectedScope.getPosition2=function(e,t,i,n,s){return"millis"===t?R(e,i,s):"ticks"===t&&_(e,i,s),"all"===n&&M(),O(e)},q.protectedScope.checkPosition=B,q.protectedScope.millisToTicks=w,q.protectedScope.ticksToMillis=S,q.protectedScope.ticksToBars=T,q.protectedScope.millisToBars=A,q.protectedScope.barsToTicks=P,q.protectedScope.barsToMillis=E,q.protectedScope.addInitMethod(function(){e=q.protectedScope.round,t=q.protectedScope.floor,i=q.protectedScope.typeString})}(),function(){var e,t,i,n,s,o,r,a,c,u,l,d,p,h,f=window.sequencer,m=window.console,v=function(t){this.id=s(),this.output=e.createGainNode(),this.output.connect(t.track.input),this.buffer=t.buffer,this.buffer&&(this.duration=this.buffer.duration),this.noteNumber=t.noteNumber,this.stopCallback=function(){},this.track=t.track};a=function(e,t){e.source.onended=function(){e.stopCallback(e)},t=t||0;try{e.source.stop(t)}catch(e){m.log(e)}},c=function(t){var i,n,s,o=e.currentTime;if(t.release_duration>0)try{switch(t.releaseEnvelope){case"linear":t.output.gain.linearRampToValueAtTime(t.volume,o),t.output.gain.linearRampToValueAtTime(0,o+t.releaseDuration);break;case"equal power":i=r(100,"fadeOut",t.volume),t.output.gain.setValueCurveAtTime(i,o,t.releaseDuration);break;case"array":for(s=t.releaseEnvelopeArray.length,i=new Float32Array(s),n=0;n<s;n++)i[n]=t.releaseEnvelopeArray[n]*t.volume;t.output.gain.setValueCurveAtTime(i,o,t.releaseDuration)}}catch(e){m.error(t.id,e)}},v.prototype.addData=function(e){this.sourceId=e.sourceId,this.noteName=e.noteName,this.midiNote=e.midiNote},v.prototype.createSource=function(){this.source=e.createBufferSource(),this.source.buffer=this.buffer},v.prototype.route=function(){this.source.connect(this.output)},v.prototype.start=function(e){if(void 0===this.source){this.volume=e.velocity/127,this.output.gain.value=this.volume,this.createSource(),this.phase="decay",this.route(),!0===i&&(this.source.start=this.source.noteOn,this.source.stop=this.source.noteOff);try{this.source.start(e.time,e.offset||0,e.duration||this.duration)}catch(e){m.warn(e)}}else m.error("this should never happen")},v.prototype.stop=function(e,t){void 0!==this.source?(0!==e&&void 0!==e||(e=f.getTime()),this.stopCallback=t||function(){},this.release?(this.source.loop=!1,this.startReleasePhase=e,this.stopTime=e+this.releaseDuration):a(this,e)):f.debug&&m.log("Sample.stop() source is undefined")},v.prototype.unschedule=function(i,n){var s=e.currentTime,o=this,r=null===i?100:i;this.source.onended=void 0;try{this.output.gain.cancelScheduledValues(0),this.output.gain.linearRampToValueAtTime(0,s+r/1e3),t["unschedule_"+this.id]={time:s+r/1e3,execute:function(){o?(o.panner&&o.panner.node.disconnect(0),void 0!==o.source&&(o.source.disconnect(0),o.source=void 0),n&&n(o)):m.log("sample is gone")}}}catch(e){m.log(e)}},v.prototype.update=function(t){var i="Sonata # 3"===this.track.name&&this.track.song.bar>=6&&this.track.song.bar<=10;this.autopan&&this.panner.setPosition(t),void 0!==this.startReleasePhase&&e.currentTime>=this.startReleasePhase&&"decay"===this.phase?(!0===i&&m.log(this.phase,"-> release",this.releaseDuration),this.phase="release",c(this)):void 0!==this.stopTime&&e.currentTime>=this.stopTime&&"release"===this.phase&&(!0===i&&m.log(this.phase,"-> stopped",this.stopTime,e.currentTime),this.phase="stopped",a(this))},f.createSample=function(e){return e.oscillator?new u(e):e.sustain&&e.release&&e.panning?new h(e):e.release&&e.panning?new p(e):e.release&&e.sustain?new d(e):e.release?new l(e):new v(e)},f.protectedScope.addInitMethod(function(){var a=f.protectedScope.createClass;e=f.protectedScope.context,t=f.protectedScope.timedTasks,r=f.util.getEqualPowerCurve,i=f.legacy,s=f.protectedScope.getSampleId,n=f.protectedScope.typeString,o=f.createPanner,l=a(v,function(e){this.release=!0,this.releaseDuration=e.release_duration/1e3,this.releaseEnvelope=e.release_envelope}),(d=a(v,function(e){this.release=!0,this.sustainStart=e.sustain_start/1e3,this.sustainEnd=e.sustain_end/1e3,this.releaseDuration=e.release_duration/1e3,this.releaseEnvelope=e.release_envelope,void 0===this.releaseEnvelope?this.releaseEnvelope="equal power":"array"===n(this.releaseEnvelope)&&(this.releaseEnvelopeArray=e.release_envelope_array,this.releaseEnvelope="array")})).prototype.route=function(){this.source.loop=!0,this.source.loopStart=this.sustainStart,this.source.loopEnd=this.sustainEnd,this.source.connect(this.output)},(p=a(v,function(e){this.release=!0,this.releaseDuration=e.release_duration/1e3,this.releaseEnvelope=e.release_envelope,void 0===this.releaseEnvelope?this.releaseEnvelope="equal power":"array"===n(this.releaseEnvelope)&&(this.releaseEnvelopeArray=e.release_envelope_array,this.releaseEnvelope="array"),this.panPosition=e.panPosition})).prototype.route=function(){this.panner=o(),this.panner.setPosition(this.panPosition||0),this.source.connect(this.panner.node),this.panner.node.connect(this.output)},(h=a(v,function(e){this.release=!0,this.sustainStart=e.sustain_start/1e3,this.sustainEnd=e.sustain_end/1e3,this.releaseDuration=e.release_duration/1e3,this.releaseEnvelope=e.release_envelope,void 0===this.releaseEnvelope?this.releaseEnvelope="equal power":"array"===n(this.releaseEnvelope)&&(this.releaseEnvelopeArray=e.release_envelope_array,this.releaseEnvelope="array"),this.panPosition=e.panPosition})).prototype.route=function(){this.source.loop=!0,this.source.loopStart=this.sustainStart,this.source.loopEnd=this.sustainEnd,this.panner=o(),this.panner.setPosition(this.panPosition||0),this.source.connect(this.panner.node),this.panner.node.connect(this.output)},(u=a(v,function(e){this.release=!0,this.panPosition=0,this.autopan=e.autopan||!1,this.frequency=e.event.frequency,this.waveForm=e.wave_form||0,this.releaseDuration=e.release_duration/1e3||1.5,this.releaseEnvelope=e.release_envelope||"equal power"})).prototype.createSource=function(){this.source=e.createOscillator(),this.source.type=this.waveForm,this.source.frequency.value=this.frequency},u.prototype.route=function(){this.volume*=.3,this.output.gain.value=this.volume,this.autopan?(this.panner=o(),this.panner.setPosition(0),this.source.connect(this.panner.node),this.panner.node.connect(this.output)):this.source.connect(this.output)}})}(),function(){var e,t,i,n,s,o,r,a,c,u,l,d,p,h=window.sequencer,f=window.console,m=0;function v(e,t){var i,n,s,o,r,a,c,u,l,d,p,h=t.mapping;for(i in e.samples=[],e.samplesById={},l=void 0!==(l=t.remote_path)&&l,h)h.hasOwnProperty(i)&&(d={id:i,folder:e.folder+"/"+e.name},!1!==l?0===(n=h[i]).indexOf("http://")||0===n.indexOf("https://")?d.url=n:(o=n,-1!==(a=n.lastIndexOf("/"))&&(o=n.substring(a+1)),s=n.substring(0,a),c=n.lastIndexOf("."),p=t.extension,-1!==c&&(r=n.substring(c+1)).length>=3&&r.length<=4&&(p=r,o=n.substring(a,c)),n=(n=(n=(n=l+"/"+s+"/"+o+"."+p).replace(/\/{2,}/g,"/")).replace(/^\//,"")).replace(/$\//,""),d.url=n):(void 0!==(u=h[i]).d?(d.base64=h[i].d,void 0!==u.s&&(d.sustain=u.s),void 0!==u.r&&(d.release=u.r)):d.base64=h[i],e.samplesById[i]=d),e.samples.push(d))}function g(e,t){!function(e,t,n){var s=0,o=e.length,r=e[s];N(r,function a(u){i(u,l+"/"+d,c.audio);t&&t(u);s++;s<o?N(r=e[s],a):n()})}(e.samples,function(e){},function(){e.loaded=!0,e.parseTime=u,h.debug>=2&&f.info("parsing",e.name,"took",1e3*u,"ms"),t&&t(!0)})}function y(e,t){e.reset(),e=void 0,t(!1)}function b(e){var s,o,r,a=t(e.localPath,h.storage.samplepacks,!0),c=e.action;if(a&&"SamplePack"===a.className)if("overwrite"===c)for(s=(o=a.samples).length-1;s>=0;s--)r=o[s],n(r.name+"/"+r.folder,h.storage.audio);else{if("append"!==c)return h.debug>=2&&f.warn("there is already a samplepack at",e.localPath),!1;for(s=(o=a.samples).length-1;s>=0;s--)e.samples.push(o[s])}return i(e,e.localPath,h.storage.samplepacks),!0}function k(t,i){!0!==t.hasMapping?e({url:t.url,responseType:"json",onError:function(){y(t,i)},onSuccess:function(e){if(null!==e){if(void 0===e.mapping)return h.debug>=2&&f.warn("can't create a SamplePack with this data",e),void y(t,i);void 0!==e.name&&void 0===t.name&&(t.name=e.name),void 0!==e.folder&&void 0===t.folder&&(t.folder=e.folder),void 0===t.name&&(t.name=o(t.url).name),t.action=e.action,t.localPath=void 0!==t.folder?t.folder+"/"+t.name:t.name,!0===b(t)?(v(t,e),g(t,i)):i(!1)}else i(!1)}}):!0===b(t)?g(t,i):i(!1)}function N(i,n){var s,o=i.url,a=i.base64;d=i.id,l=i.folder,!1!==(s=t(l+"/"+d,c.audio,!0))?n(s):a?("TWAAAP"!==a?w(s=r(a),n):n(s),i.base64=""):o?e({url:o,responseType:"arraybuffer",onError:function(){n()},onSuccess:function(e){w(e,n)}}):f.error("could not load sample",l+"/"+d)}function w(e,t){var i=h.getTime();if(null!==e)try{a.decodeAudioData(e,function(e){u+=h.getTime()-i,t(e)},function(e){f.log("error decoding audiodata",d,e),t()})}catch(e){f.log(d,e),t()}}(p=function(e){this.id="SP"+m+++(new Date).getTime(),this.className="SamplePack",this.loaded=!1,this.loadTime=0,this.parseTime=u=0,this.url=e.url,this.name=e.name,this.folder=e.folder,this.info=e.info||e.samplepack_info,this.author=e.author||e.samplepack_author,this.license=e.license||e.samplepack_license,this.compression=e.compression||e.samplepack_compression,void 0===this.compression&&void 0!==e.compression_type&&(this.compression=e.compression_type+" "+e.compression_level),this.pack=e.pack,this.filesize=e.filesize,void 0===this.filesize&&void 0!==this.pack&&(this.filesize=this.pack.filesize),e.mapping?(void 0===this.name&&void 0===this.folder?(this.name=this.id,this.localPath=this.id):this.localPath=void 0!==this.folder?this.folder+"/"+this.name:this.name,this.hasMapping=!0,this.action=e.action,v(this,e)):e.url&&(this.url=e.url)}).prototype.reset=function(){this.samples=[]},h.addSamplePack=function(e,t,i){var n,o,r,a,c=s(e);if(i=void 0!==i&&i,"object"!==c)return h.debug>=2&&f.warn("can't create a SamplePack with this data",e),!1;if(e.json){if(o=e.json,r=e.name,a=e.folder,"string"===s(o))try{o=JSON.parse(o)}catch(t){return h.debug>=2&&f.warn("can't create a SamplePack with this data",e),!1}if(void 0===o.mapping)return h.debug>=2&&f.warn("can't create a SamplePack with this data",e),!1;e={mapping:o.mapping,name:void 0===r?o.name:r,folder:void 0===a?o.folder:a}}n=new p(e),h.addTask({type:"load sample pack",method:k,params:n},function(e){t&&(!1===e?(n=null,t(null)):t(n))},i),h.startTaskQueue()},h.protectedScope.addInitMethod(function(){c=h.storage,e=h.protectedScope.ajax,a=h.protectedScope.context,t=h.protectedScope.findItem,o=h.protectedScope.parseUrl,i=h.protectedScope.storeItem,n=h.protectedScope.deleteItem,s=h.protectedScope.typeString,r=h.protectedScope.base64ToBinary})}(),function(){var e,t,i,n=window.sequencer;window.console;(i=function(e){this.song=e,this.looped=!1,this.notes={},this.audioEvents={}}).prototype.updateSong=function(){this.events=this.song.eventsMidiAudioMetronome,this.numEvents=this.events.length,this.index=0,this.maxtime=0,this.notes={},this.audioEvents=this.song.audioEvents,this.numAudioEvents=this.audioEvents.length,this.scheduledAudioEvents={},this.looped=!1,this.setIndex(this.song.millis)},i.prototype.setIndex=function(e){var t;for(t=0;t<this.numEvents;t++)if(this.events[t].millis>=e){this.index=t;break}this.beyondLoop=!1,e>this.song.loopEnd&&(this.beyondLoop=!0),this.scheduledAudioEvents={}},i.prototype.getDanglingAudioEvents=function(e,t){var i,n;for(i=0;i<this.numAudioEvents;i++)(n=this.audioEvents[i]).millis<e&&n.endMillis>e?(n.playheadOffset=e-n.millis,n.time=this.startTime+n.millis-this.songStartMillis+n.playheadOffset,n.playheadOffset/=1e3,this.scheduledAudioEvents[n.id]=n,t.push(n),0):n.playheadOffset=0;return t},i.prototype.getEvents=function(){var e,t,i,s,o,r,a,c,u,l=[];if(c=1e3*n.bufferTime,!0===this.song.doLoop&&this.song.loopDuration<c&&(this.maxtime=this.songMillis+this.song.loopDuration-1),!0===this.song.doLoop)if(this.maxtime>=this.song.loopEnd&&!1===this.beyondLoop){if(a=this.maxtime-this.song.loopEnd,this.maxtime=this.song.loopStart+a,!1===this.looped){for(this.looped=!0,e=this.index;e<this.numEvents&&(t=this.events[e]).millis<this.song.loopEnd;e++)t.time=this.startTime+t.millis-this.songStartMillis,l.push(t),this.index++;for(e in r=this.song.loopEndTicks-1,o=this.song.getPosition("ticks",r).millis,this.notes)if(this.notes.hasOwnProperty(e)){if(s=(i=this.notes[e]).noteOn,i.noteOff.millis<=this.song.loopEnd)continue;(t=n.createMidiEvent(r,128,s.data1,0)).millis=o,t.part=s.part,t.track=s.track,t.midiNote=s.midiNote,t.time=this.startTime+t.millis-this.songStartMillis,l.push(t)}for(e in this.scheduledAudioEvents)this.scheduledAudioEvents.hasOwnProperty(e)&&(u=this.scheduledAudioEvents[e]).endMillis>this.song.loopEnd&&(u.stopSample(this.song.loopEnd/1e3),delete this.scheduledAudioEvents[e]);this.notes={},this.setIndex(this.song.loopStart),this.song.startTime+=this.song.loopDuration,this.startTime=this.song.startTime,this.getDanglingAudioEvents(this.song.loopStart,l)}}else this.looped=!1;for(!0===this.firstRun&&(this.getDanglingAudioEvents(this.song.millis,l),this.firstRun=!1),e=this.index;e<this.numEvents&&(t=this.events[e]).millis<this.maxtime;e++)t.time=this.startTime+t.millis-this.songStartMillis,144===t.type||128===t.type?void 0!==t.midiNote&&void 0!==t.midiNote.noteOff&&(144===t.type?this.notes[t.midiNote.id]=t.midiNote:128===t.type&&delete this.notes[t.midiNote.id],l.push(t)):"audio"===t.type?(void 0!==this.scheduledAudioEvents[t.id]&&void 0!==(u=this.scheduledAudioEvents[t.id]).sample&&void 0!==u.sample.source&&u.stopSample(0),this.scheduledAudioEvents[t.id]=t,t.time=t.time+1e3*t.playheadOffset,l.push(t)):l.push(t),this.index++;return l},i.prototype.update=function(){var e,i,s,o,r,a;for(this.prevMaxtime=this.maxtime,!0===this.song.precounting?(this.songMillis=this.song.metronome.millis,this.maxtime=this.songMillis+1e3*n.bufferTime,o=[].concat(this.song.metronome.getPrecountEvents(this.maxtime)),this.maxtime>this.song.metronome.endMillis&&(this.songMillis=0,this.maxtime=this.song.millis+1e3*n.bufferTime,this.startTime=this.song.startTime,this.startTime2=this.song.startTime2,this.songStartMillis=this.song.startMillis,o=this.getEvents())):(this.songMillis=this.song.millis,this.maxtime=this.songMillis+1e3*n.bufferTime,this.startTime=this.song.startTime,this.startTime2=this.song.startTime2,this.songStartMillis=this.song.startMillis,o=this.getEvents()),s=o.length,e=0;e<s;e++)void 0===(r=(i=o[e]).track)||!0===i.mute||!0===i.part.mute||!0===i.track.mute||"metronome"===i.track.type&&!1===this.song.useMetronome||(i.time+=r.audioLatency,"audio"===i.type?(i.time/=1e3,r.audio.processEvent(i)):!1===r.routeToMidiOut?(i.time/=1e3,r.instrument.processEvent(i)):("any"!==(a=r.channel)&&void 0!==a&&!0!==isNaN(a)||(a=0),t(r.midiOutputs,function(e){128===i.type||144===i.type||176===i.type?e.send([i.type+a,i.data1,i.data2],i.time):192!==i.type&&224!==i.type||e.send([i.type+a,i.data1],i.time)}),this.lastEventTime=i.time))},i.prototype.unschedule=function(){var t,i,n,s=Array.prototype.slice.call(arguments),o=[];for(function t(i,n,s,o){var r;for(n=0;n<s;n++)void 0!==(r=i[n])&&("MidiEvent"===r.className?o.push(r):"MidiNote"===r.className?o.push(r.noteOn):"array"===e(r)&&t(r,0,r.length))}(s,0,s.length,o),t=o.length-1;t>=0;t--)(n=(i=o[t]).track.instrument)&&n.unscheduleEvent(i)},i.prototype.reschedule=function(){var e,t=this.song.numTracks,i=this.song.tracks;for(e=0;e<t;e++)i[e].instrument.reschedule(this.song)},n.protectedScope.addInitMethod(function(){e=n.protectedScope.typeString,t=n.protectedScope.objectForEach}),n.protectedScope.createScheduler=function(e){return new i(e)}}(),function(){var e,t,i,n,s,o,r,a,c,u,l,d,p=window.sequencer,h=window.console,f=Array.prototype.slice,m=0,v={},g=[],y={},b={};function k(e){y[e.id]=e}function N(e){var t;for(t in e)e.hasOwnProperty(t)&&(e[t]=null)}p.getSongs=function(){return y},p.deleteSong=function(e){if(void 0!==e&&null!==e&&"Song"===e.className){var t,i,n,s,o;for(e.stop(),e.disconnect(c),delete y[e.id],t=e.eventsMidiAudioMetronome.length-1;t>=0;t--)N(e.eventsMidiAudioMetronome[t]);for(t=e.timeEvents.length-1;t>=0;t--)e.timeEvents[t];for(t=e.numTracks-1;t>=0;t--){for(void 0!==(i=e.tracks[t]).audio&&i.audio.recorder.cleanup(),n=i.numParts-1;n>=0;n--){for(o=(s=i.parts[n]).numNotes-1;o>=0;o--)N(s.notes[o]);N(s),s=null}N(i),i=null}return N(e),e=null,null}},p.getSnapshot=function(e,i){if(void 0!==e){i=i||e.id;var n,s,o,r,a,c,u,l=b[i],d=e.activeEvents,p=e.activeNotes,f=e.activeParts,m=[],v=[],g=[];if(void 0!==l){for(n=l.activeEvents,s=l.activeNotes,o=l.activeParts,u=n.length-1;u>=0;u--)void 0===d[(r=n[u]).id]&&void 0!==e.eventsLib[r.id]&&m.push(r);for(u=s.length-1;u>=0;u--)void 0===p[(a=s[u]).id]&&void 0!==e.notesLib[a.id]&&v.push(a);for(u=o.length-1;u>=0;u--)void 0===f[(c=o[u]).id]&&g.push(c)}return l={activeEvents:t(d),activeNotes:t(p),activeParts:t(f),nonActiveEvents:m,nonActiveNotes:v,nonActiveParts:g},b[i]=l,l}h.error("song is undefined")},u=function(e){var t,i,n,s=p.getTime();for(t in o)o.hasOwnProperty(t)&&(n=o[t]).time>=s&&(n.execute(),n=null,delete o[t]);for(t in r)r.hasOwnProperty(t)&&r[t]();for(t in a)a.hasOwnProperty(t)&&a[t]();m>=10?(i=(e-l)/1e3,p.diff=i,i>p.bufferTime&&!0===p.autoAdjustBufferTime&&(p.debug&&h.log("adjusted buffertime:"+p.bufferTime+" -> "+i),p.bufferTime=i)):m++,l=e,r={},window.requestAnimationFrame(u)},p.processEvent=p.processEvents=function(){var t,i,o,r,a,c,u,l,h,m,g,y,b=f.call(arguments),k=60;for(d=[],(t=function(s,o,r){for(o=0;o<r;o++)i=s[o],l=e(i),void 0!==i&&("midimessageevent"===l?(s=i.data,u=n(0,s[0],s[1],s[2]),d.push(u)):"MidiEvent"===i.className?d.push(i):"array"===l?t(i,0,i.length):"string"===l?h=i:!1===isNaN(i)&&(k=i))})(b,0,b.length),m=p.createPart(),(g=p.createTrack()).setInstrument(h),void 0===v[g.instrumentId]?(v[g.instrumentId]=g,g.addPart(m),g.connect(s.destination)):m=(g=v[g.instrumentId]).parts[0],m.addEvents(d),g.update(),r=d.length,a=p.getTime(),y=60/k/p.defaultPPQ,o=0;o<r;o++)(c=d[o]).time=a+c.ticks*y+.002,g.instrument.processEvent(c)},p.stopProcessEvent=p.stopProcessEvents=function(){i(v,function(e){e.instrument.allNotesOff(),e=void 0}),v={}},p.play=function(){var t,i,n,s,o,r,a,c,u,l,d=f.call(arguments),h=[],m=[],v=[],g=[],b=[];for((n=function(t,o,d,p){for(o=0;o<d;o++)void 0!==(i=t[o])&&("string"===e(i)?l=i:"Song"===i.className?(void 0===a&&(a=i.bpm,c=i.nominator,u=i.denominator),g.push(i)):"Track"===i.className?(void 0===a&&void 0!==(s=i.song)&&(a=s.bpm,c=s.nominator,u=s.denominator),v.push(i)):"Part"===i.className?(void 0===a&&void 0!==(s=i.song)&&(a=s.bpm,c=s.nominator,u=s.denominator),m.push(i)):"MidiEvent"===i.className||"AudioEvent"===i.className?(void 0===a&&void 0!==(r=i.part)&&void 0!==(s=r.song)&&(a=s.bpm,c=s.nominator,u=s.denominator),81===i.type||88===i.type?b.push(i):h.push(i)):"array"===e(i)?n(i,0,i.length,"    "):!0===i||!1===i?i:0===i.indexOf("S")&&(s=y[i])&&s.play())})(d,0,d.length,"  "),t=g.length-1;t>=0;t--)s=g[t],v=v.concat(s.tracks),b=b.concat(s.timeEvents);return m.length>0&&((o=p.createTrack()).instrument=l,o.addParts(m),v.push(o)),h.length>0&&((o=p.createTrack()).instrument=l,(r=p.createPart()).addEvents(h),o.addPart(r),v.push(o)),k(s=p.createSong({bpm:a||120,nominator:c||4,denominator:u||4,timeEvents:b,tracks:v})),s.play(),s},p.setAnimationFrameType=function(e,t){switch(e=(e=e||"default").toLowerCase(),t=t||15,e){case"settimeout":window.requestAnimationFrame=function(e){setTimeout(e,t)};break;default:window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.requestAnimationFrame}},p.protectedScope.updateInstruments=function(){var e,t,i;for(e in y)if(y.hasOwnProperty(e))for(t=(i=y[e].tracks).length-1;t>=0;t--)i[t].instrument.reset()},p.allNotesOff=function(){i(y,function(e){e.allNotesOff()})},window.onblur=function(){!1!==p.pauseOnBlur&&(p.allNotesOff(),g=[],i(y,function(e){!0===e.playing&&(p.debug&&h.log("pause song",e.id),g.push(e),e.pause())}))},window.onfocus=function(){if(!1!==p.pauseOnBlur){var e,t,i,n=g.length;for(i=0;i<n;i++)t=(e=g[i]).millis,e.stop(),e.setPlayhead("millis",t),p.restartOnFocus&&e.play();g=[]}},p.protectedScope.addSong=k,p.protectedScope.addInitMethod(function(){t=p.protectedScope.objectToArray,p.protectedScope.isEmptyObject,p.protectedScope.isEmptyObject,i=p.protectedScope.objectForEach,o=p.protectedScope.timedTasks,r=p.protectedScope.scheduledTasks,a=p.protectedScope.repetitiveTasks,e=p.protectedScope.typeString,s=p.protectedScope.context,n=p.createMidiEvent,c=p.protectedScope.masterGainNode,p.protectedScope.parseTimeEvents,u()})}(),function(){var e,t,i,n,s,o,r,a,c,u,l,d,p,h,f,m,v,g,y,b,k,N,w,S,E,P,T,A,I,x,O,M,C,B,R,_,V,q,L,U,D,F,z,j,W,Q,H,K,G,X,Z,Y,J,$,ee=window.sequencer,te=window.console,ie=Array.prototype.slice,ne=0;$=function(o){o=o||{},this.id="S"+ne+++(new Date).getTime(),this.name=o.name||this.id,this.className="Song",F(this),this.midiInputs={},this.midiOutputs={},u(this),this.bpm=o.bpm||120,this.ppq=o.ppq||ee.defaultPPQ,this.bars=o.bars||30,this.lastBar=this.bars,this.lowestNote=o.lowestNote||0,this.highestNote=o.highestNote||127,this.pitchRange=this.highestNote-this.lowestNote+1,this.nominator=o.nominator||4,this.denominator=o.denominator||4,this.factor=4/this.denominator,this.ticksPerBeat=this.ppq*this.factor,this.ticksPerBar=this.ticksPerBeat*this.nominator,this.millisPerTick=6e4/this.bpm/this.ppq,this.quantizeValue=o.quantizeValue||"8",this.fixedLengthValue=o.fixedLengthValue||!1,this.positionType=o.positionType||"all",this.useMetronome=o.useMetronome,this.autoSize=void 0===o.autoSize||!0===o.autoSize,this.playbackSpeed=1,this.defaultInstrument=o.defaultInstrument||ee.defaultInstrument,this.recordId=-1,this.autoQuantize=!1,this.loop=o.loop||!1,this.doLoop=!1,this.illegalLoop=!0,this.loopStart=0,this.loopEnd=0,this.loopDuration=0,this.audioRecordingLatency=0,!0!==this.useMetronome&&!1!==this.useMetronome&&(this.useMetronome=!1),this.grid=void 0,o.timeEvents&&o.timeEvents.length>0?(this.timeEvents=[].concat(o.timeEvents),this.tempoEvent=X(ee.TEMPO,this)[0],this.timeSignatureEvent=X(ee.TIME_SIGNATURE,this)[0],void 0===this.tempoEvent?(this.tempoEvent=e(0,ee.TEMPO,this.bpm),this.timeEvents.unshift(this.tempoEvent)):this.bpm=this.tempoEvent.bpm,void 0===this.timeSignatureEvent?(this.timeSignatureEvent=e(0,ee.TIME_SIGNATURE,this.nominator,this.denominator),this.timeEvents.unshift(this.timeSignatureEvent)):(this.nominator=this.timeSignatureEvent.nominator,this.denominator=this.timeSignatureEvent.denominator)):(this.tempoEvent=e(0,ee.TEMPO,this.bpm),this.timeSignatureEvent=e(0,ee.TIME_SIGNATURE,this.nominator,this.denominator),this.timeEvents=[this.tempoEvent,this.timeSignatureEvent]),void 0!==o.timeEvents&&void 0!==o.bpm&&this.bpm!==o.bpm&&this.setTempo(o.bpm,!1),void 0===o.timeEvents||void 0===o.nominator&&void 0===o.denominator||this.nominator===o.nominator&&this.denominator===o.denominator||this.setTimeSignature(o.nominator||this.nominator,o.denominator||this.denominator,!1),this.tracks=[],this.parts=[],this.notes=[],this.events=[],this.allEvents=[],this.tracksById={},this.tracksByName={},this.partsById={},this.notesById={},this.eventsById={},this.activeEvents=null,this.activeNotes=null,this.activeParts=null,this.recordedNotes=[],this.recordedEvents=[],this.recordingNotes={},this.numTracks=0,this.numParts=0,this.numNotes=0,this.numEvents=0,this.instruments=[],this.playing=!1,this.paused=!1,this.stopped=!0,this.recording=!1,this.prerolling=!1,this.precounting=!1,this.preroll=!0,this.precount=0,this.listeners={},this.playhead=t(this,this.positionType,this.id,this),this.playheadRecording=t(this,"all",this.id+"_recording"),this.scheduler=n(this),this.followEvent=i(this),this.volume=1,this.gainNode=r.createGainNode(),this.gainNode.gain.value=this.volume,this.metronome=s(this,T),this.connect(),"MidiFile"===o.className&&!1===o.loaded&&ee.debug&&te.warn("midifile",o.name,"has not yet been loaded!"),o.tracks&&this.addTracks(o.tracks),o.parts&&this.addParts(o.parts),o.events&&this.addEvents(o.events),o.events||o.parts||o.tracks?(void 0===o.bars&&(this.lastBar=0),this.lastEvent=e([this.lastBar,ee.END_OF_TRACK])):this.lastEvent=e([this.bars*this.ticksPerBar,ee.END_OF_TRACK]),this.update(!0),this.numTimeEvents=this.timeEvents.length,this.playhead.set("ticks",0),this.midiEventListeners={}},K=function(e,t){var i=!1;return void 0===e?i=!1:"Part"===i.className?i=e:"string"===B(e)?i=t.partsById[e]:!1===isNaN(e)&&(i=t.parts[e]),i},Q=function(e,t){var i=!1;return void 0===e?i=!1:"Track"===e.className?i=e:"string"===B(e)?void 0===(i=t.tracksById[e])&&(i=t.tracksByName[e]):!1===isNaN(e)&&(i=t.tracks[e]),void 0===i&&(i=!1),i},H=function(e,t){var i,n,s=t.tracksById,o=t.tracksByName,r=[];for(i=e.length-1;i>=0;i--)!1!==(n=Q(e[i]))&&(void 0!==n.song&&null!==n.song&&(n=n.copy()),n.song=t,n.instrument.song=t,n.quantizeValue=t.quantizeValue,n.connect(t.gainNode),n.state="new",n.needsUpdate=!0,s[n.id]=n,o[n.name]=n,r.push(n.id),D(n.partsById,function(e){e.state="new"}));return r},z=function(e){var t,i,n=[];for(t=e.length-1;t>=0;t--)!1!==(i=Q(e[t]))&&(void 0===i.song||i.song===this?(i.state="removed",i.disconnect(this.gainNode),i.reset(),delete this.tracksById[i.id],delete this.tracksByName[i.name],n.push(i)):te.warn("can't remove: this track belongs to song",i.song.id));return n},G=function(e){var t,i,n=[];for(i=e.length-1;i>=0;i--)(t=K(e[i],this))&&n.push(t);return n},X=function(e,t){var i=[];return t.timeEvents.forEach(function(t){t.type===e&&i.push(t)}),i},j=function(e){var t=1e3*ee.getTime(),i=t-e.timeStamp,n=e.millis+i;if(e.diff=i,e.timeStamp=t,!0===e.precounting)return e.metronome.millis+=i,void e.scheduler.update(i);e.prevMillis=e.millis,e.doLoop&&e.scheduler.looped&&n>=e.loopEnd?(e.followEvent.resetAllListeners(),e.playhead.set("millis",e.loopStart+(n-e.loopEnd)),e.followEvent.update(),e.scheduler.update(),T(e,"loop")):n>=e.durationMillis?(e.playhead.update("millis",e.durationMillis-e.millis),e.followEvent.update(),e.pause(),e.endOfSong=!0,T(e,"end")):(e.playhead.update("millis",i),e.followEvent.update(),e.scheduler.update()),e.jump=!1},$.prototype.remove=function(){te.warn("Song.remove() is deprecated, please use sequencer.deleteSong()"),ee.deleteSong(this)},$.prototype.play=function(){var e,t;if(ee.unlockWebAudio(),this.playing)this.pause();else{this.scheduler.firstRun=!0,this.doLoop=!1===this.illegalLoop&&!0===this.loop,this.endOfSong&&(this.followEvent.resetAllListeners(),this.playhead.set("millis",0),this.scheduler.setIndex(0)),this.timeStamp=1e3*ee.getTime(),this.startTime=this.timeStamp;try{this.startTime2=window.performance.now()}catch(e){ee.debug&&te.log("window.performance.now() not supported")}this.precounting&&(this.metronome.startTime=this.startTime,this.metronome.startTime2=this.startTime2,this.startTime+=this.metronome.precountDurationInMillis,this.startTime2+=this.metronome.precountDurationInMillis,e=this,t=this.startTime/1e3,c.playAfterPrecount=function(){ee.getTime()>=t&&(e.precounting=!1,e.prerolling=!1,e.recording=!0,e.playing=!0,T(e,"record_start"),T(e,"play"),c.playAfterPrecount=void 0,delete c.playAfterPrecount)}),this.startMillis=this.millis,(e=this).playhead.update("millis",0),e.followEvent.update(),c[this.id]=function(){j(e)},this.paused=!1,this.stopped=!1,this.endOfSong=!1,!0!==this.precounting&&(this.playing=!0,T(this,"play"))}},$.prototype.pause=function(){!0!==this.recording&&!0!==this.precounting?this.stopped||this.paused?this.play():(delete c[this.id],this.allNotesOff(),this.playing=!1,this.paused=!0,T(this,"pause")):this.stop()},$.prototype.stop=function(){if(this.stopped)return this.followEvent.resetAllListeners(),this.playhead.set("millis",0),void this.scheduler.setIndex(0);!0!==this.recording&&!0!==this.precounting||this.stopRecording(),delete c[this.id],D(a,function(e,t){0!==t.indexOf("unschedule_")&&0!==t.indexOf("event_")||(null,delete a[t])}),this.allNotesOff(),this.playing=!1,this.paused=!1,this.stopped=!0,this.endOfSong=!1,this.followEvent.resetAllListeners(),this.playhead.set("millis",0),this.scheduler.setIndex(0),T(this,"stop")},$.prototype.adjustLatencyForAllRecordings=function(e){this.audioRecordingLatency=e,this.tracks.forEach(function(t){t.setAudioRecordingLatency(e)})},$.prototype.setAudioRecordingLatency=function(e,t,i){var n,s,o;for(n=this.audioEvents.length-1;n>=0&&(void 0===(o=(s=this.audioEvents[n]).sampleId)||e!==o);n--);s.track.setAudioRecordingLatency(e,t,i)},$.prototype.startRecording=$.prototype.record=function(e){if(!0!==this.recording&&!0!==this.precounting){var t,i,n=!1,s=!1,o=this;for(this.metronome.precountDurationInMillis=0,this.playing?(this.precount=0,this.recordStartMillis=this.millis):void 0===e?(this.precount=0,this.recordStartMillis=this.millis):(this.setPlayhead("barsbeats",this.bar),this.metronome.createPrecountEvents(e),this.precount=e,this.recordStartMillis=this.millis-this.metronome.precountDurationInMillis),this.recordTimestampTicks=this.ticks,this.recordId="REC"+(new Date).getTime(),this.recordedNotes=[],this.recordedEvents=[],this.recordingNotes={},this.recordingAudio=!1,void 0!==this.keyEditor&&this.keyEditor.prepareForRecording(this.recordId),t=this.numTracks-1;t>=0;t--)"audio"===(i=this.tracks[t]).recordEnabled&&(this.recordingAudio=!0),"audio"===i.recordEnabled?(s=!0,i.prepareForRecording(this.recordId,function(){!1===n&&(n=!0,Z.call(o))})):i.prepareForRecording(this.recordId);return!1===s&&Z.call(this),this.recordId}this.stop()},Z=function(){this.recordTimestamp=1e3*r.currentTime,!1===this.playing?(this.precount>0?(this.precounting=!0,this.prerolling=this.preroll,this.prerolling?T(this,"record_preroll"):T(this,"record_precount")):(this.recording=!0,T(this,"record_start")),this.play()):(this.recording=!0,this.precounting=!1,T(this,"record_start"))},Y=function(e,t,i){var n,s=this;e<this.numTracks?(n=this.tracks[e]).stopRecording(this.recordId,function(o){void 0!==o&&(t[n.name]=o),e++,Y.call(s,e,t,i)}):i(t)},$.prototype.stopRecording=function(){if(!1!==this.recording){this.recording=!1,this.prerolling=!1,this.precounting=!1,delete c.playAfterPrecount;var e=this;return Y.call(this,0,{},function(t){e.update(),T(e,"recorded_events",t)}),this.update(),T(this,"record_stop"),this.recordId}},$.prototype.undoRecording=function(e){var t,i;if(void 0===e)for(t=this.numTracks-1;t>=0;t--)this.tracks[t].undoRecording(this.recordId);else i=this.tracksByName,D(e,function(e,t){i[t].undoRecording(e)})},$.prototype.getAudioRecordingData=function(e){var t,i,n;for(t=this.audioEvents.length-1;t>=0&&(void 0===(n=(i=this.audioEvents[t]).sampleId)||e!==n);t--);return void 0!==i&&i.track.getAudioRecordingData(e)},$.prototype.quantize=function(){var e,t,i,n,s,o=ie.call(arguments),r=o.length,a={};for(e=0;e<r;e++)i=o[e],"string"===(n=B(i))||"number"===n?s=i:"object"===n&&(a=i);for(e=this.numTracks-1;e>=0;e--)t=this.tracks[e],void 0===s&&(s=t.quantizeValue),ee.quantize(t.events,s,this.ppq,a);return a},$.prototype.undoQuantize=function(e){var t;if(void 0!==e)for(t=this.numTracks-1;t>=0;t--)this.tracks[t].undoQuantize(e);else ee.debug>=2&&te.warn("please pass a quantize history object")},$.prototype.quantizeRecording=function(e){var t,i;for(t=this.numTracks-1;t>=0;t--)(i=this.tracks[t]).recordId===this.recordId&&i.quantizeRecording(e)},$.prototype.setLeftLocator=function(){var e=g(this,ie.call(arguments));void 0!==e&&(this.loopStartPosition=e,this.loopStart=e.millis,this.loopStartTicks=e.ticks),this.illegalLoop=this.loopStart>=this.loopEnd,this.doLoop=!1===this.illegalLoop&&!0===this.loop,this.loopDuration=!0===this.illegalLoop?0:this.loopEnd-this.loopStart},$.prototype.setRightLocator=function(){var e=g(this,ie.call(arguments));this.illegalLoop;void 0!==e&&(this.loopEndPosition=e,this.loopEnd=e.millis,this.loopEndTicks=e.ticks),this.illegalLoop=this.loopEnd<=this.loopStart,this.doLoop=!1===this.illegalLoop&&!0===this.loop,this.loopDuration=!0===this.illegalLoop?0:this.loopEnd-this.loopStart},$.prototype.setLoop=function(e){if(void 0===e)this.loop=!this.loop;else{if(!0!==e&&!1!==e)return void(ee.debug>=1&&te.error('pass "true", "false" or no value'));this.loop=e}this.doLoop=!1===this.illegalLoop&&!0===this.loop},$.prototype.setPlayhead=function(){this.jump=!0,this.scheduler.looped=!1,this.scheduler.firstRun=!0,this.timeStamp=1e3*ee.getTime(),this.startTime=this.timeStamp;try{this.startTime2=window.performance.now()}catch(e){ee.debug&&te.log("window.performance.now() not supported")}this.playing&&this.allNotesOff();var e=g(this,ie.call(arguments)).millis;this.startMillis=e,this.playhead.set("millis",e),this.scheduler.setIndex(e)},$.prototype.addEventListener=function(){return E.apply(this,arguments)},$.prototype.removeEventListener=function(){P.apply(this,arguments)},$.prototype.addEvent=$.prototype.addEvents=function(){var e,t;return void 0===(e=this.tracks[0])&&(e=ee.createTrack(),this.addTrack(e)),e.needsUpdate&&e.update(),void 0===(t=e.parts[0])&&(t=ee.createPart(),e.addPart(t)),t.addEvents.apply(t,arguments),this},$.prototype.addPart=$.prototype.addParts=function(){var e=this.tracks[0];return void 0===e&&(e=ee.createTrack(),this.addTrack(e)),e.addParts.apply(e,arguments),this},$.prototype.addTrack=function(){var e=W(arguments),t=e[0],i=e.length;return("array"===B(t)||i>1)&&(te.warn("please use addTracks() if you want to get more that one tracks"),e=[t]),H(e,this)[0]},$.prototype.addTracks=function(){return H(W(arguments),this)},$.prototype.getTrack=function(e){return Q(e,this)},$.prototype.getTracks=function(){var e,t,i=W(arguments),n=[];for(t=i.length-1;t>=0;t--)(e=Q(i[t],this))&&n.push(e);return n},$.prototype.getPart=function(){var e=W(arguments);return e.length>1&&te.warn("please use getParts() if you want to get more that one part"),G.call(this,e)[0]},$.prototype.getParts=function(){var e=W(arguments);return G.call(this,e)},$.prototype.removeTrack=function(){var e=W(arguments);return e.length>1&&te.warn("please use removeTracks() if you want to remove more that one tracks"),z.call(this,e)[0]},$.prototype.removeTracks=function(){return z.call(this,W(arguments))},$.prototype.setPlaybackSpeed=function(e){if(e<.01||e>100)te.error("playback speed has to be > 0.01 and < 100");else{var t,i,n,s=this.ticks;this.playbackSpeed=e,this.update(!0),void 0!==this.loopStartTicks&&(t=this.getPosition("ticks",this.loopStartTicks),this.loopStart=t.millis,this.loopStartTicks=t.ticks),void 0!==this.loopEndTicks&&(i=this.getPosition("ticks",this.loopEndTicks),this.loopEnd=i.millis,this.loopEndTicks=i.ticks),n=this.getPosition("ticks",s),this.setPlayhead("ticks",n.ticks)}},$.prototype.gridToSong=function(e,t,i,n){return x(this,e,t,i,n)},$.prototype.noteToGrid=function(e,t){return O(e,t,this)},$.prototype.eventToGrid=function(e,t,i){return M(e,t,i,this)},$.prototype.positionToGrid=function(e,t){return C(e,t,this)},$.prototype.getPosition=function(){return g(this,ie.call(arguments))},$.prototype.ticksToMillis=function(e,t){return b(this,e,t)},$.prototype.millisToTicks=function(e,t){return y(this,e,t)},$.prototype.ticksToBars=function(e,t){return k(this,e,t)},$.prototype.millisToBars=function(e,t){return N(this,e,t)},$.prototype.barsToTicks=function(){return w(this,ie.call(arguments))},$.prototype.barsToMillis=function(){return S(this,ie.call(arguments))},$.prototype.findEvent=$.prototype.findEvents=function(e){return L(this,e)},$.prototype.findNote=$.prototype.findNotes=function(e){return U(this,e)},$.prototype.getStats=function(e){return q(this,e)},$.prototype.createGrid=function(e){return void 0===this.grid?this.grid=J(this,e):this.grid.update(e),this.grid},$.prototype.update=function(e){A(this,e)},$.prototype.updateGrid=function(e){return this.grid.update(e),this.grid},$.prototype.updateTempoEvent=function(e,t){if(e.type===ee.TEMPO)if(e.song===this){var i=this.ticks;this.percentage;e.bpm=t,this.update(!0),this.updatePlayheadAndLocators(i)}else ee.debug>=4&&te.error("this event has not been added to this song yet");else ee.debug>=4&&te.error("this is not a tempo event")},$.prototype.updateTimeSignatureEvent=function(e,t,i){if(e.type===ee.TIME_SIGNATURE)if(e.song===this){var n=this.ticks;this.percentage;e.nominator=t||e.nominator,e.denominator=i||e.denominator,this.update(!0),this.updatePlayheadAndLocators(n)}else ee.debug>=4&&te.error("this event has not been added to this song yet");else ee.debug>=4&&te.error("this is not a time signature event")},$.prototype.getTempoEvents=function(){return X(ee.TEMPO,this)},$.prototype.getTimeSignatureEvents=function(){return X(ee.TIME_SIGNATURE,this)},$.prototype.updatePlayheadAndLocators=function(e){var t,i,n,s=this.loopStartPosition,o=this.loopEndPosition;void 0!==s&&(t=this.getPosition("ticks",s.ticks),this.loopStart=t.millis,this.loopStartTicks=t.ticks,this.loopStartPosition=t),void 0!==o&&((i=this.getPosition("ticks",o.ticks)).ticks>this.durationTicks&&(i=this.getPosition("ticks",this.bars)),this.loopEnd=i.millis,this.loopEndTicks=i.ticks,this.loopEndPosition=i),n=this.getPosition("ticks",e),this.doLoop&&n.ticks>this.durationTicks?this.setPlayhead("ticks",0):this.setPlayhead("ticks",n.ticks),this.loopDuration=!0===this.illegalLoop?0:this.loopEnd-this.loopStart},$.prototype.setTempo=function(e,t){var i,n,s=X(ee.TEMPO,this),o=this.ticks,r=(this.percentage,e/s[0].bpm);for(i=s.length-1;i>=0;i--)(n=s[i]).bpm=r*n.bpm;this.bpm=e,!1!==t&&(this.update(!0),this.updatePlayheadAndLocators(o))},$.prototype.setTimeSignature=function(e,t,i){var n,s,o=X(ee.TIME_SIGNATURE,this),r=(this.percentage,this.ticks);for(n=o.length-1;n>=0;n--)(s=o[n]).nominator=e,s.denominator=t;this.nominator=e,this.denominator=t,!1!==i&&(this.update(!0),this.updatePlayheadAndLocators(r))},$.prototype.resetTempo=function(e){var t=X(ee.TEMPO,this)[0],i=this.timeEvents;t.bpm=e,i=_(i,function(e){return 81===e.type}),this.numTimeEvents=i.length,this.update(!0)},$.prototype.resetTimeSignature=function(e,t){var i=X(ee.TIME_SIGNATURE,this)[0],n=this.timeEvents,s=this.ticks;i.nominator=e,i.denominator=t,n=_(n,function(e){return 88===e.type}),this.numTimeEvents=n.length,this.update(!0),this.updatePlayheadAndLocators(s)},$.prototype.addTimeEvent=$.prototype.addTimeEvents=function(){var e,t,i,n=W(arguments),s=this.ticks;for(e=n.length-1;e>=0;e--)"MidiEvent"===(t=n[e]).className&&(t.type===ee.TEMPO?this.timeEvents.push(t):t.type===ee.TIME_SIGNATURE&&(i=(i=this.getPosition("ticks",t.ticks)).beat>i.nominator/2?this.getPosition("barsbeats",i.bar+1):this.getPosition("barsbeats",i.bar),t.ticks=i.ticks,this.timeEvents.push(t)));this.numTimeEvents=this.timeEvents.length,this.update(!0),this.updatePlayheadAndLocators(s)},$.prototype.removeTimeEvent=$.prototype.removeTimeEvents=function(){var e,t,i=W(arguments),n=i.length,s=this.ticks,o=[];for(e=0;e<n;e++)(t=i[e])!==this.tempoEvent&&t!==this.timeSignatureEvent&&o.push(t);this.timeEvents=R(o,this.timeEvents),this.numTimeEvents=this.timeEvents.length,this.update(!0),this.updatePlayheadAndLocators(s)},$.prototype.removeDoubleTimeEvents=function(){var e,t,i,n,s=[],o={81:{},88:{}};for(e=this.timeEvents.length-1;e>=0;e--)void 0===o[(t=this.timeEvents[e]).type][t.ticks]&&(n=t.type,i=t.ticks,o[n][i]=t,0===i&&(81===n?this.tempoEvent=t:88===n&&(this.timeSignatureEvent=t)));D(o[81],function(e){s.push(e)}),D(o[88],function(e){s.push(e)}),this.timeEvents=s,this.update(!0)},$.prototype.setPitchRange=function(e,t){var i=this;i.lowestNote=e,i.highestNote=t,i.numNotes=i.pitchRange=i.highestNote-i.lowestNote+1},$.prototype.trim=function(){I(this,!0)},$.prototype.setDurationInBars=function(e){var t=this,i=t.findEvent("bar > "+e),n=[],s=[],o=[],r={},a={};return i.forEach(function(e){var t=e.trackId,i=e.partId;void 0===r[t]&&(r[t]=[]),r[t].push(e),void 0===a[i]&&(a[i]=e.part)}),D(r,function(e,i){var n=t.getTrack(i);n.removeEvents(e),s.push(n)}),D(a,function(e,t){0===e.events.length?(e.track.removePart(e),n.push(e)):o.push(e)}),t.bars=e,t.lastBar=e,{removedEvents:i,removedParts:n,changedTracks:s,changedParts:o}},$.prototype.addEffect=function(){},$.prototype.removeEffect=function(){},$.prototype.setVolume=function(){var e,t,i=ie.call(arguments),n=i.length,s=[];if(1===n){if(e=i[0],isNaN(e))return void te.warn("please pass a number");this.volume=e<0?0:e>1?1:e,this.gainNode.gain.value=this.volume}else for(function t(i,n,o){for(n=0;n<o;n++){var r=i[n],a=B(r);"array"===a?t(r,0,r.length):"number"===a?e=r:"Track"===r.className&&s.push(r)}}(i,0,n),t=s.length-1;t>=0;t--)s[t].setVolume(e)},$.prototype.getVolume=function(){return this.gainNode.gain.value},$.prototype.connect=function(){this.gainNode.connect(o)},$.prototype.disconnect=function(){this.gainNode.disconnect(o)},$.prototype.getMidiInputs=function(e){f(e,this)},$.prototype.getMidiOutputs=function(e){m(e,this)},$.prototype.setTrackSolo=function(e,t){var i,n;for(i=this.numTracks-1;i>=0;i--)n=this.tracks[i],!0===t?n.mute=n===e?!t:t:!1===t&&(n.mute=!1),n.solo=n===e&&t},$.prototype.muteAllTracks=function(e){var t;for(t=this.numTracks-1;t>=0;t--)this.tracks[t].mute=e},$.prototype.setMetronomeVolume=function(e){this.metronome.setVolume(e)},$.prototype.configureMetronome=function(e){this.metronome.configure(e)},$.prototype.resetMetronome=function(){this.metronome.reset()},$.prototype.setPrecount=function(e){this.precount=e},$.prototype.allNotesOff=function(){D(this.tracks,function(e){e.allNotesOff()}),this.metronome.allNotesOff(),this.resetExternalMidiDevices()},$.prototype.resetExternalMidiDevices=function(){var e=this.scheduler.lastEventTime+100;isNaN(e)&&(e=100),D(this.midiOutputs,function(t){t.send([176,123,0],e),t.send([176,121,0],e)})},$.prototype.addMidiEventListener=function(){return l(arguments,this)},$.prototype.removeMidiEventListener=function(e){d(e,this)},$.prototype.removeMidiEventListeners=function(){d(arguments,this)},$.prototype.getMidiInputsAsDropdown=function(e){return v(e=e||{type:"input"},this)},$.prototype.getMidiOutputsAsDropdown=function(e){return v(e=e||{type:"output"},this)},$.prototype.setMidiInput=function(e,t){p(e,t,this)},$.prototype.setMidiOutput=function(e,t){h(e,t,this)},$.prototype.getNoteLengthName=function(e){return V(this,e)},ee.createSong=function(e){return new $(e)},ee.protectedScope.addInitMethod(function(){r=ee.protectedScope.context,a=ee.protectedScope.timedTasks,c=ee.protectedScope.repetitiveTasks,o=ee.protectedScope.masterGainNode,e=ee.createMidiEvent,J=ee.protectedScope.createGrid,u=ee.protectedScope.initMidiSong,p=ee.protectedScope.setMidiInputSong,h=ee.protectedScope.setMidiOutputSong,f=ee.protectedScope.getMidiInputs,m=ee.protectedScope.getMidiOutputs,l=ee.protectedScope.addMidiEventListener,v=ee.protectedScope.getMidiPortsAsDropdown,d=ee.protectedScope.removeMidiEventListener,g=ee.protectedScope.getPosition,y=ee.protectedScope.millisToTicks,b=ee.protectedScope.ticksToMillis,k=ee.protectedScope.ticksToBars,N=ee.protectedScope.millisToBars,w=ee.protectedScope.barsToTicks,S=ee.protectedScope.barsToMillis,B=ee.protectedScope.typeString,R=ee.protectedScope.removeFromArray,_=ee.protectedScope.removeFromArray2,L=ee.findEvent,U=ee.findNote,q=ee.getStats,x=ee.gridToSong,O=ee.noteToGrid,M=ee.eventToGrid,C=ee.positionToGrid,W=ee.protectedScope.getArguments,D=ee.protectedScope.objectForEach,V=ee.protectedScope.getNoteLengthName,A=ee.protectedScope.update,I=ee.protectedScope.checkDuration,ee.protectedScope.addMetronomeEvents,ee.protectedScope.followEvent,t=ee.protectedScope.createPlayhead,n=ee.protectedScope.createScheduler,i=ee.protectedScope.createFollowEvent,s=ee.protectedScope.createMetronome,E=ee.protectedScope.songAddEventListener,P=ee.protectedScope.songRemoveEventListener,T=ee.protectedScope.songDispatchEvent,F=ee.protectedScope.addSong})}(),function(){var e,t,i,n,s=window.sequencer,o=window.console,r=Array.prototype.slice,a=0;n=function(){var e,t,i=r.call(arguments),n=i.length,s=i[0],o=i[1],a=[];if(n>2)for(e=2;e<n;)a.push(i[e]),e++;if(a.push(s),void 0!==(t=s.listeners[o])&&void 0!==t.length)for(e=t.length-1;e>=0;e--)t[e].callback.apply(null,a)},t=function(){var e,t=r.call(arguments),i=t[0];switch(i){case"play":case"stop":case"pause":case"end":case"record_start":case"record_stop":case"record_precount":case"record_preroll":case"recorded_events":case"latency_adjusted":case"loop_off":case"loop_on":case"loop":case"sustain_pedal":return void 0===this.listeners[i]&&(this.listeners[i]=[]),e=i+"_"+a++,this.listeners[i].push({id:e,callback:t[1]}),e;case"note":case"event":case"position":return this.followEvent.addEventListener(i,t[1],t[2]);default:o.log(i,"is not a supported event")}},i=function(){var t,i,n,s,a,c=r.call(arguments),u=c[0],l=c[1],d=[];if(-1!==u.indexOf("_")?(i=(t=u.split("_"))[0],n=u):i=u,"array"===e(i))return this.followEvent.removeEventListener(c);switch(i){case"play":case"stop":case"pause":case"end":case"record_start":case"record_stop":case"record_precount":case"record_preroll":case"recorded_events":case"latency_adjusted":case"loop_off":case"loop_on":case"loop":case"sustain_pedal":if((t=this.listeners[i])&&t.length>0){for(s=t.length-1;s>=0;s--)a=t[s],void 0!==n?a.id!==n&&d.push(a):void 0!==l&&a.callback!==l&&d.push(a);this.listeners[i]=[].concat(d)}break;case"note":case"event":case"position":return this.followEvent.removeEventListener(c);default:o.error("unsupported event")}},s.protectedScope.songAddEventListener=t,s.protectedScope.songRemoveEventListener=i,s.protectedScope.songDispatchEvent=n,s.protectedScope.addInitMethod(function(){e=s.protectedScope.typeString})}(),function(){var e,t,i,n,s,o,r=window.sequencer,a=window.console,c=0,u={bar:1,beat:1,sixteenth:1,tick:0,ticks:1,barsbeats:1,barsandbeats:1,hour:1,minute:1,second:1,millisecond:0,millis:1,time:1},l="= == === > >= < <= != !== %=";new RegExp(" "+l.replace(/\s+/g," | ")+" ");(o=function(e){this.song=e,this.allListenersById={},this.allListenersByType={},this.searchPatterns=[],this.eventListenersBySearchstring={},this.positionListenersBySearchstring={},this.allListenersByType={event:{instance:{},searchstring:{}},position:{ticks:[],repetitive:{},conditional_simple:{},conditional_complex:{}}}}).prototype.updateSong=function(){var t,i,n,s,o,r,a,u,l,d,p=[];for(s in u=this.allListenersByType.event.instance)if(u.hasOwnProperty(s)&&void 0===this.song.eventsById[s]){for(t=(p=u[s]).length-1;t>=0;t--)d=p[t],delete this.allListenersById[d];delete this.allListenersByType.event.instance[s]}for(s in p=[],u=this.allListenersByType.event.searchstring)u.hasOwnProperty(s)&&(p=p.concat(u[s]));for(t=p.length-1;t>=0;t--)delete this.allListenersById[p[t]];for(this.allListenersByType.event.searchstring={},r=this.allListenersByType.event.searchstring,t=this.searchPatterns.length-1;t>=0;t--)for(a=this.searchPatterns[t],o=e(this.song,a.searchstring),"note"===r.type&&(o=e(o,"type = NOTE_ON OR type = NOTE_OFF")),i=o.length-1;i>=0;i--)n=o[i],l={id:d="event_"+c++,event:n,type:a.type,subtype:a.subtype,callback:a.callback},this.allListenersById[d]=l,void 0===r[n.id]&&(r[n.id]=[]),r[n.id].push(d)},o.prototype.update=function(){var e,t,i,n,s=this.song,o=s.ticks;for(i=(t=this.song.playhead.collectedEvents).length,e=0;e<i;e++)n=t[e],this.callEventListeners(n.id,n);this.callListenersPositionTicks(o),s.bar!==this.bar&&(this.bar=s.bar,this.callListenersPositionRepetitive("bar"),this.callListenersPositionConditionalSimple("bar",this.bar),this.callListenersPositionConditionalComplex("bar",this.bar)),s.beat!==this.beat&&(this.beat=s.beat,this.callListenersPositionRepetitive("beat"),this.callListenersPositionConditionalSimple("beat",this.beat),this.callListenersPositionConditionalComplex("beat",this.beat)),s.sixteenth!==this.sixteenth&&(this.sixteenth=s.sixteenth,this.callListenersPositionRepetitive("sixteenth"),this.callListenersPositionConditionalSimple("sixteenth",this.sixteenth),this.callListenersPositionConditionalComplex("sixteenth",this.sixteenth)),s.hour!==this.hour&&(this.hour=s.hour,this.callListenersPositionRepetitive("hour"),this.callListenersPositionConditionalSimple("hour",this.hour),this.callListenersPositionConditionalComplex("hour",this.hour)),s.minute!==this.minute&&(this.minute=s.minute,this.callListenersPositionRepetitive("minute"),this.callListenersPositionConditionalSimple("minute",this.minute),this.callListenersPositionConditionalComplex("minute",this.minute)),s.second!==this.second&&(this.second=s.second,this.callListenersPositionRepetitive("second"),this.callListenersPositionConditionalSimple("second",this.second),this.callListenersPositionConditionalComplex("second",this.second))},o.prototype.callEventListeners=function(e,t){var i,n,s,o,r=[];for((s=this.allListenersByType.event.instance)[e]&&(r=r.concat(s[e])),(s=this.allListenersByType.event.searchstring)[e]&&(r=r.concat(s[e])),r.length,i=r.length-1;i>=0;i--)n=r[i],!0!==(o=this.allListenersById[n]).called&&(o.called=!0,o.callback(t))},o.prototype.callListenersPositionRepetitive=function(e){var t,i=this.allListenersByType.position.repetitive[e],n=this;i&&i.forEach(function(e){(t=n.allListenersById[e]).callback(t.searchstring)})},o.prototype.callListenersPositionConditionalSimple=function(e,t){var i,n,s=!1,o=this.allListenersByType.position.conditional_simple[e],r=this;o&&o.forEach(function(e){switch(i=r.allListenersById[e],n=i.data,i.operator){case">":s=t>n;break;case"<":s=t<n;break;case"%=":s=t%n==0;break;case"!=":case"!==":s=t!==n;break;case"===":s=t===n}!0===s&&i.callback(i.searchstring)})},o.prototype.callListenersPositionConditionalComplex=function(e,t){var i,n,s,o,r=this.allListenersByType.position.conditional_complex[e],a=this;r&&r.forEach(function(e){i=a.allListenersById[e],n=i.value1,s=i.value2,o=i.operator1,i.operator2,"<"===o?(t<n||t>s)&&i.callback(i.searchstring):">"===o&&t>n&&t<s&&i.callback(i.searchstring)})},o.prototype.callListenersPositionTicks=function(e){var t,i,n=this.allListenersByType.position.ticks,s=n.length;for(t=0;t<s;t++)e>=(i=this.allListenersById[n[t]]).ticks&&!i.called&&(i.callback(i.searchstring),i.called=!0)},o.prototype.addEventListener=function(i,s,o){var r,u,l,d,p,h,f,m,v=[],g=t(s);if("function"!==t(o))return a.error(o,"is not a function; please provide a function for callback"),-1;if("position"===i)return m=this.addPositionEventListener(s,o);if("string"===g){if(u=e(this.song,s),this.searchPatterns.push({searchstring:s,callback:o,type:"event",subtype:"searchstring"}),0===u.length)return-1;h="searchstring",d=this.allListenersByType.event.searchstring,this.eventListenersBySearchstring[s]=p=[]}else{if(-1===(u=n(i,s)))return-1;h="instance",d=this.allListenersByType.event.instance}for("note"===i&&(u=e(u,"type = NOTE_ON OR type = NOTE_OFF")),r=u.length-1;r>=0;r--)l=u[r],f={id:m="event_"+c++,event:l,type:i,subtype:h,callback:o},this.allListenersById[m]=f,void 0===d[l.id]&&(d[l.id]=[]),d[l.id].push(m),v.push(m),"searchstring"===h&&p.push(m);return"searchstring"===h||"array"===g||"note"===i?v:v[0]},o.prototype.addPositionEventListener=function(e,n){var o,r,d,p,h=e.split(/[\s+]/g),f=h.length,m=h[0],v=h[1],g=h[2],y=h[3],b=h[4],k=t(g);if(1!==f&&3!==f&&5!==f)return a.error("invalid search string, please consult documentation"),!1;if(1!==u[m])return a.error(m,"is not a supported event id, please consult documentation"),-1;switch("="!==v&&"=="!==v||(v="==="),m){case"barsbeats":case"barsandbeats":case"time":case"ticks":case"millis":if(void 0===v||"==="!==v)return a.error(m,"can only be used conditionally with the operators '===', '==' or '='"),-1;y&&a.warn("this position event type can only be used with a single condition, ignoring second condition");break;case"bar":case"beat":case"sixteenth":case"hour":case"minute":case"second":if(g&&isNaN(g))return a.error("please provide a number"),-1;if(b&&isNaN(b))return a.error("please provide a number"),-1}if(v&&-1===l.indexOf(v))return a.error(v,"is not a supported operator, please use any of",l),-1;if(v&&void 0===g)a.error("operator without value");else{if(y&&-1===l.indexOf(v))return a.error(y,"is not a supported operator, please use any of",l),-1;if(!y||void 0!==b){if(v&&y&&!1===s(v,y))return a.error("you can't use "+v+" together with "+y),-1;if("function"!==t(n))return a.error(n,"is not a function; please provide a function for callback"),-1;switch(m){case"bar":case"beat":case"sixteenth":g-=0,b-=0;case"hour":case"minute":case"second":g-=0,b-=0,v&&("<="===v?(g++,v="<"):">="===v&&(g--,v=">")),y&&("<="===y?(b++,y="<"):">="===y&&(b--,y=">"));break;case"ticks":g-=0;break;case"barsbeats":case"barsandbeats":isNaN(g)?"string"===k?(g=(g=g.replace(/[\[\]\s]/g,"")).split(","),g=i(this.song,["barsbeats",g[0],g[1]||1,g[2]||1,g[3]||0]).ticks):a.error("please provide a number or an array of numbers"):g=i(this.song,["barsbeats",g,1,1,0]).ticks,m="ticks";break;case"millis":g=i(this.song,["millis",g]).ticks,m="ticks";break;case"time":isNaN(g)?"string"===k?(g=g.replace(/[\[\]\s]/g,""),a.log(g),1===(g=g.split(",")).length?(p=60*g[0]*1e3,g=i(this.song,["millis",p]).ticks):g=i(this.song,["time",g[0],g[1],g[2],g[3]]).ticks):a.error("please provide a number or an array of numbers"):(p=60*g*1e3,g=i(this.song,["millis",p]).ticks),a.log(g),m="ticks"}return r="position_"+c++,"ticks"===m?(d={id:r,callback:n,type:"position",subtype:"ticks",ticks:g,searchstring:e},this.allListenersByType.position.ticks.push(r)):v||y?v&&!y?(d={id:r,callback:n,type:"position",subtype:"conditional_simple",position_type:m,data:g,operator:v,searchstring:e},void 0===(o=this.allListenersByType.position.conditional_simple)[m]&&(o[m]=[]),o[m].push(r)):v&&y&&(d={id:r,callback:n,type:"position",subtype:"conditional_complex",position_type:m,value1:g,value2:b,operator1:v,operator2:y,searchstring:e},void 0===(o=this.allListenersByType.position.conditional_complex)[m]&&(o[m]=[]),o[m].push(r)):(d={id:r,callback:n,type:"position",subtype:"repetitive",position_type:m,searchstring:e},void 0===(o=this.allListenersByType.position.repetitive)[m]&&(o[m]=[]),o[m].push(r)),this.allListenersById[r]=d,this.positionListenersBySearchstring[e]=r,r}a.error("operator without value")}},o.prototype.removeEventListener=function(e){var i,n,s,o,r,c,u,l,d,p,h,f,m,v,g,y,b,k=[],N=[];if(i=e[0],1===(n=e.length))for(m=(l="array"===t(i)?i:[i]).length-1;m>=0;m--)if(u=l[m],void 0!==this.allListenersById[u]){if(s=(d=this.allListenersById[u]).type,o=d.subtype,"position"===s){for(v=(y=this.allListenersByType[s][o][d.position_type]).length-1;v>=0;v--)(p=y[v])!==u&&k.push(p);this.allListenersByType[d.type][d.subtype][d.position_type]=[].concat(k),delete this.allListenersById[u]}else if("event"===s||"note"===s){for(h=d.event.id,v=(y=this.allListenersByType.event[o][h]).length-1;v>=0;v--)if(p=y[v],d=this.allListenersById[p],p!==u){k.push(p);break}this.allListenersByType.event[o][h]=[].concat(k),delete this.allListenersById[u]}}else a.warn("no event listener found with id",u);else if(2===n||3===n)switch(s=e[0],r=e[1],c=e[2],b=t(r),s){case"position":if("string"===b){for(u=this.positionListenersBySearchstring[r],d=this.allListenersById[u],m=(y=this.allListenersByType[d.type][d.subtype][d.position_type]).length-1;m>=0;m--)(p=y[m])!==u&&k.push(p);this.allListenersByType[d.type][d.subtype][d.position_type]=[].concat(k),delete this.allListenersById[u],delete this.positionListenersBySearchstring[r]}break;case"event":case"note":if("string"===b){for(m=(y=this.eventListenersBySearchstring[r]).length-1;m>=0;m--)N.push(y[m]);for(h in f=this.allListenersByType.event.searchstring)if(f.hasOwnProperty(h)){for(k=[],m=(y=f[h]).length-1;m>=0;m--){for(p=y[m],g=!1,v=N.length-1;v>=0;v--)if(p===N[v]){g=!0;break}!1===g?k.push(p):delete this.allListenersById[y[m]]}this.allListenersByType.event.searchstring[h]=[].concat(k)}delete this.eventListenersBySearchstring[r]}else if("object"===b){if("MidiEvent"!==r.className&&"MidiNote"!==r.className)return void a.error("please provide a midi event or a midi note");if("MidiNote"===r.className?u=r.noteOn.id:"MidiEvent"===r.className&&(u=r.id),void 0!==this.allListenersByType.event.instance[u]?(s="instance",y=this.allListenersByType.event.instance[u]):void 0!==this.allListenersByType.event.searchstring[u]&&(s="searchstring",y=this.allListenersByType.event.searchstring[u]),void 0===y)return void a.warn("no event listener bound to event with id",u);for("MidiNote"===r.className&&(l=this.allListenersByType.event[s][r.noteOff.id],y=y.concat(l)),m=y.length-1;m>=0;m--)p=y[m],d=this.allListenersById[p],c&&d.callback!==c?k.push(d.id):delete this.allListenersById[d.id],this.allListenersByType.event[s][d.event.id]=[].concat(k)}}},o.prototype.resetAllListeners=function(){var e,t=this.allListenersById;for(e in t)t.hasOwnProperty(e)&&(t[e].called=!1)},n=function(e,i){var n,s,o=t(i),r=[];if("array"!==o&&void 0!==i&&"MidiEvent"!==i.className&&"MidiNote"!==i.className)return a.error(i," is not valid data for event type 'event', please consult documentation"),-1;if("array"===o)for(n=i.length-1;n>=0;n--)s=i[n],"event"!==e||"MidiEvent"===s.className||"AudioEvent"===s.className?"note"!==e||"MidiNote"===s.className?r.push(s):a.warn("skipping",s,"because it is not a MidiNote"):a.warn("skipping",s,"because it is not a MidiEvent nor an AudioEvent");else if("event"===e){if("MidiEvent"!==i.className&&"AudioEvent"!==i.className)return a.error(i," is not a MidiEvent nor an AudioEvent"),-1;r=[i]}else if("note"===e){if("MidiNote"!==i.className)return a.error(i," is not a MidiNote"),-1;r=[i.noteOn,i.noteOff]}return r},s=function(e,t){switch(e){case"=":case"==":case"===":return!1}switch(t){case"=":case"==":case"===":return!1}return!0},r.protectedScope.createFollowEvent=function(e){return new o(e)},r.protectedScope.addInitMethod(function(){t=r.protectedScope.typeString,i=r.protectedScope.getPosition,r.midiEventNumberByName,r.midiEventNameByNumber,e=r.findEvent})}(),function(){var e,t,i,n,s,o,r;r=function(i,n,s,o,r){var a,c;if(void 0!==i)if(void 0!==n&&void 0!==s){if(void 0!==o&&void 0!==r)return a=t(n/o*i.ticks),c=i.highestNote-t(s/r*i.pitchRange),{position:e(i,["ticks",a]),note:c=sequencer.createNote(c)};console.error("please provide width and height")}else console.error("please provide a coordinate");else console.error("please provide a song")},sequencer.positionToSong=sequencer.coordinatesToPosition=sequencer.gridToSong=function(){var e=Array.prototype.slice.call(arguments),t=e.length,i=e[0];return 4===t&&"Song"!==i.className?r(sequencer.getSong(),i,e[1],e[2],e[3]):r(i,e[1],e[2],e[3],e[4])},sequencer.songToGrid=function(){var e=Array.prototype.slice.call(arguments),t=e.length,i=e[0],r=e[1];switch(t){case 3:s(i,r,e[2]);break;case 4:"x"===i?n(r,e[2],e[3]):"y"===i&&o(r,e[2],e[3]);break;case 6:break;default:console.error("wrong number of arguments")}},s=function(e,t,i,s){if(void 0===s&&(s=sequencer.getSong()),e.type!==sequencer.NOTE_ON&&e.type!==sequencer.NOTE_OFF)return console.error("please provide a NOTE_ON or a NOTE_OFF event"),null;e.millis,s.durationMillis;var r=sequencer.createNote(e.noteNumber);return{x:n(["ticks",e.ticks],t,s),y:o(r,i,s)}},n=function(n,s,o){void 0===o&&(o=sequencer.getSong()),"array"!==i(n)&&"ticks"===n.type||(n=e(o,n));var r=t(n.ticks/o.quantizeTicks)*o.quantizeTicks;return r/=o.ticks,r*=s},o=function(e,t,i){void 0===i&&(i=sequencer.getSong());var n,s=e.number;return s<i.lowestNote||s>i.highestNote?(console.error("note is out of range of the pitch range of this song"),null):(n=(n=(s-i.highestNote)/i.pitchRange)<0?-n:n,n*=t)},sequencer.protectedScope.addInitMethod(function(){e=sequencer.protectedScope.getPosition,t=sequencer.protectedScope.floor,sequencer.protectedScope.round,i=sequencer.protectedScope.typeString})}(),function(){var e,t,i,n,s,o,r=window.sequencer;window.console;function a(t,i){var n,s,o=t.lastEventTmp;for(s in!1===t.autoSize?t.lastBar=t.bars:t.lastBar=i?o.bar:Math.max(t.lastBar,o.bar),t.bars=parseInt(t.lastBar),n=e(t,["barsandbeats",t.bars,o.nominator,o.numSixteenth,o.ticksPerSixteenth,!0]),t.durationTicks=n.ticks,t.durationMillis=n.millis,n)n.hasOwnProperty(s)&&(t.lastEvent[s]=n[s])}function c(e,t){var i,n;for(i=t.length-1;i>=0;i--)(n=t[i]).startPosition=e.getPosition("ticks",n.start.ticks),n.endPosition=e.getPosition("ticks",n.end.ticks),n.start.millis=n.startPosition.millis,n.end.millis=n.endPosition.millis,n.duration.millis=n.end.millis-n.start.millis,n.state="clean"}function u(e,t){var i,n;for(i=t.length-1;i>=0;i--)!0===(n=t[i]).endless?(n.durationTicks=r.ticks-n.noteOn.ticks,n.durationMillis=r.millis-n.noteOn.millis):(n.durationTicks=n.noteOff.ticks-n.noteOn.ticks,n.durationMillis=n.noteOff.millis-n.noteOn.millis),n.ticks=n.noteOn.ticks,n.millis=n.noteOn.millis,n.number=n.noteOn.noteNumber,n.state="clean"}s=function(e,t){!0!==r.playing?o(e,t):n.updateSong=function(){o(e,t)}},o=function(e,n){var s,o,l,d,p,h,f,m,v,g,y,b=[],k=[],N=[],w=[],S=[],E=[],P=[],T=[],A=[],I=[],x=[],O=[],M=[],C=[],B=[],R=[],_=[],V=[],q=[],L=[],U=[],D={},F={},z={};for(o in!0===n&&t(e),e.tracksById)if(e.tracksById.hasOwnProperty(o)){for(l in!0===(h=e.tracksById[o]).needsUpdate&&h.update(),h.partsById)if(h.partsById.hasOwnProperty(l)){for(d in!0===(f=h.partsById[l]).needsUpdate&&f.update(),g=f.dirtyEvents)if(g.hasOwnProperty(d))switch((m=g[d]).state){case"new":b.push(m);break;case"recorded":w.push(m);break;case"changed":k.push(m);break;case"removed":N.push(m),delete f.eventsById[d]}for(d in y=f.dirtyNotes)if(y.hasOwnProperty(d))switch((v=y[d]).state){case"new":S.push(v);break;case"changed":E.push(v);break;case"removed":P.push(v),delete f.notesById[d]}switch(f.dirtyEvents={},f.dirtyNotes={},"removed"!==f.state?(q=q.concat(f.notes),R=R.concat(f.events)):(P=P.concat(f.notes),N=N.concat(f.events)),f.state){case"new":T.push(f),z[f.id]=f;break;case"changed":A.push(f),z[f.id]=f;break;case"removed":I.push(f),delete h.partsById[f.id]}}switch(L=L.concat(h.parts),h.state){case"clean":h.index=U.length,U.push(h);break;case"new":x.push(h),h.state="clean",h.index=U.length,U.push(h);break;case"changed":O.push(h),h.state="clean",h.index=U.length,U.push(h);break;case"removed":M.push(h),delete e.tracksById[h.id]}}for(s=N.length-1;s>=0;s--)(m=N[s]).state="clean";for(s=P.length-1;s>=0;s--)(v=P[s]).state="clean";for(s=I.length-1;s>=0;s--)(f=I[s]).state="clean";for(w.length>0&&function(e,t){var i,n,s,o,a,c=e.recordTimestamp,u=e.recordStartMillis,l=u,d=t.length,p=e.playheadRecording;for(p.set("millis",u),i=0;i<d;i++)o=t[i],a=o.recordMillis-c+u,s=p.update("millis",a-l),l=a,n=r.getNiceTime(s.millis),o.ticks=s.ticks,o.bpm=s.bpm,o.factor=s.factor,o.nominator=s.nominator,o.denominator=s.denominator,o.ticksPerBar=s.ticksPerBar,o.ticksPerBeat=s.ticksPerBeat,o.ticksPerSixteenth=s.ticksPerSixteenth,o.numSixteenth=s.numSixteenth,o.millisPerTick=s.millisPerTick,o.secondsPerTick=s.secondsPerTick,o.millis=s.millis,o.seconds=s.millis/1e3,o.hour=n.hour,o.minute=n.minute,o.second=n.second,o.millisecond=n.millisecond,o.timeAsString=n.timeAsString,o.timeAsArray=n.timeAsArray,o.bar=s.bar,o.beat=s.beat,o.sixteenth=s.sixteenth,o.tick=s.tick,o.barsAsString=s.bar+":"+s.beat+":"+s.sixteenth+":"+s.tick,o.barsAsArray=[s.bar,s.beat,s.sixteenth,s.tick],o.state="clean";e.recordStartMillis=void 0,e.recordTimestamp=void 0}(e,w),R.sort(function(e,t){return e.sortIndex-t.sortIndex}),q.sort(function(e,t){return e.ticks-t.ticks}),L.sort(function(e,t){return e.ticks-t.ticks}),s=R.length-1;s>=0;s--)D[(m=R[s]).id]=m,"audio"===m.type?V.push(m):_.push(m);for(s=q.length-1;s>=0;s--)F[(v=q[s]).id]=v;!1===n?(p=e.timeEvents.concat(b,k),i(e,p),u(e,p=[].concat(S,E)),c(e,p=[].concat(T,A))):(p=e.timeEvents.concat(R),i(e,p),u(e,q),c(e,L)),a(e),e.metronome.bars!==e.bars?e.metronome.update():!0===n&&e.metronome.update(),(C=[].concat(_,V,e.metronome.events)).sort(function(e,t){return e.ticks-t.ticks}),(B=[].concat(R,e.timeEvents)).sort(function(e,t){return e.ticks-t.ticks}),e.eventsMidiAudioMetronome=C,e.eventsMidiTime=B,e.events=R,e.midiEvents=_,e.audioEvents=V,e.notes=q,e.parts=L,e.tracks=U,e.numEvents=R.length,e.numNotes=q.length,e.numParts=L.length,e.numTracks=U.length,e.eventsById=D,e.notesById=F,e.partsById=z,e.newEvents=b,e.changedEvents=k,e.removedEvents=N,e.newNotes=S,e.changedNotes=E,e.removedNotes=P,e.newParts=T,e.changedParts=A,e.removedParts=I,e.playhead.updateSong(),e.playheadRecording.updateSong(),e.scheduler.updateSong(),e.scheduler.reschedule(),e.followEvent.updateSong(),void 0!==e.grid&&e.grid.update(),void 0!==e.keyEditor&&e.keyEditor.updateSong({numBars:e.bars,newEvents:b,changedEvents:k,removedEvents:N,newNotes:S,changedNotes:E,removedNotes:P,newParts:T,changedParts:A,removedParts:I})},r.protectedScope.update=s,r.protectedScope.checkDuration=a,r.protectedScope.parseMetronomeEvents=function(e,t){var n=t.concat(e.timeEvents);i(e,n),(t=t.concat(e.events)).sort(function(e,t){return e.sortIndex-t.sortIndex}),e.eventsMidiAudioMetronome=[].concat(t)},r.protectedScope.addInitMethod(function(){e=r.protectedScope.getPosition,i=r.protectedScope.parseEvents,t=r.protectedScope.parseTimeEvents,r.protectedScope.getInstrument,n=r.protectedScope.scheduledTasks})}(),function(){var e,t,i,n,s,o,r,a,c,u,l,d,p,h,f,m,v,g,y=window.sequencer,b=window.console,k=y.debug,N=Array.prototype.slice,w=0;function S(t,i){var n=!1;return t?"Part"===t.className?n=t:"string"===e(t)?n=i.partsById[t]:!1===isNaN(t)&&(n=i.parts[t]):n=!1,n}function E(t,i){var n=!1;return t?"MidiEvent"===t.className||"AudioEvent"===t.className?n=t:"array"===e(t)&&4===t.length?n=o(t):"string"===e(t)?n=i.eventsById[t]:!1===isNaN(t)&&(n=i.events[t]):n=!1,n}function P(t,i){var n,s,o,r=0,a=0,c=(t=Array.prototype.slice.call(t))[0],u=[],l=[];if("array"===e(c)){for(a=c.length-1;a>=0;a--)(s=S(o=c[a],i))&&u.push(s);r=0===u.length?0:1}for(n=t.length,a=r;a<n;a++)(s=S(o=t[a],i))?u.push(s):l.push(o);return 0===u.length?(b.warn("no parts added"),!1):{parts:u,config:l}}function T(e,t){var i,n;if(!1===(e=s(e)))return!1;if(i=e[0],void 0===t&&"ticks"!==i)return b.error("Track has not been added to a song yet, you can only use tick values"),!1;switch(i){case"ticks":n=e[1];break;case"millis":n=t.millisToTicks(e[1]);break;case"barsbeats":case"barsandbeats":case"time":n=(e=t.getPosition(e,"ticks")).ticks}return n}function A(e,t){if(!1!==e){var i,n,s,o,r,a,u,l=t.song,d=e.parts,p=d.length,h=t.partsById;for(i=0;i<p;i++)if(!1!==(o=S(d[i]))){for(n in void 0!==o.track&&(o=o.copy()),o.hasAudioEvents&&void 0===t.audio&&(t.audio=c(t)),o.song=l,o.track=t,o.trackId=t.id,r=o.eventsById,u=0!==(a=o.ticks),r)r.hasOwnProperty(n)&&((s=r[n]).track=t,s.channel=t.channel,s.trackId=t.id,u&&(s.ticks+=a),s.state="new");o.state="new",o.needsUpdate=!0,h[o.id]=o}else b.error(o,"is not a part");t.needsUpdate=!0}}function I(e,t){if(!1===e)return[];var i,n,s=[],o=e.parts;if(void 0===o)return b.log("weird situation, check this when it happens"),[];for(i=o.length-1;i>=0;i--)void 0===(n=o[i]).track||n.track===t?(s.push(n),n.state="removed",n.reset(!0,!0)):b.warn("can't remove: this part belongs to track",n.track.id);return t.needsUpdate=!0,s}function x(e,t){if(!1!==e){var i,n,s,o={},r=[],a=e;for(i=a.length-1;i>=0;i--)void 0===(s=a[i]).track||s.track===t?(void 0===o[n=s.partId]&&(o[n]=[]),o[n].push(s),r.push(s)):b.warn("can't remove: this event belongs to track",s.track.id);for(n in o)o.hasOwnProperty(n)&&t.partsById[n].removeEvents(o[n]);return t.needsUpdate=!0,r}}function O(e){var t;return void 0!==e.song&&void 0!==e.song.defaultInstrument&&(t=i(e.song.defaultInstrument,y.storage.instruments)),!1!==t&&void 0!==t||(t=i(y.defaultInstrument,y.storage.instruments)),t}(g=function(e,t,i){this.className="Track",this.id="T"+w+++(new Date).getTime(),this.type=t||"instrument",this.name=e||this.id,this.song=i,this.instrumentName="",this.events=[],this.eventsById={},this.notes=[],this.notesById={},this.parts=[],this.partsById={},this.numParts=0,this.numEvents=0,this.needsUpdate=!1,this.audioLatency=0,this.effects={},this.numEffects=0,this.volume=1,this.input=r.createGainNode(),this.input.gain.value=1,this.output=r.createGainNode(),this.output.gain.value=this.volume,this.panner=u(),this.input.connect(this.panner.node),this.panner.node.connect(this.output),this.lastEffect=this.input,this.midiInputs={},this.midiOutputs={},this.routeToMidiOut=!1,this.midiEventListeners={},this.monitor=!1,this.recordEnabled=!1,this.mute=!1,this.solo=!1,this.channel="any",this.quantizeValue=0,this.fixedLengthValue=0,this.autoQuantize=!1,this.retrospectiveRecording=[],this.recordingNotes={},this.enableRetrospectiveRecording=!1,"metronome"!==t&&this.setInstrument(this.instrumentName)}).prototype.addPart=g.prototype.addParts=function(){A(P(arguments,this),this)},g.prototype.addPartAt=g.prototype.addPartsAt=function(){var e,t,i,n,s,o=P(arguments,this);if(!1!==o){if(t=o.parts,void 0===(e=o.config))return b.error("please provide position data"),!1;for(i=t.length-1;i>=0;i--)n=t[i],!1!==(s="ticks"===e[0]?e[1]:T(e[i],this.song))&&(n.ticks+=s);A(o,this)}},g.prototype.movePart=g.prototype.moveParts=function(){!function(e,t){if(!1!==e){var i,n,s,o=e.parts,r=e.config[0],a=r;for(s=o.length-1;s>=0;s--)(i=(n=o[s]).ticks+r)<0&&(i=0,a=-n.ticks),n.ticks=i,n.moveEvents(n.events,a),"new"!==n.state&&(n.state="changed");t.needsUpdate=!0}}(P(arguments,this),this)},g.prototype.movePartTo=g.prototype.movePartsTo=function(){!function(e,t){if(!1!==e){var i,n,s,o,r=t.song,a=e.parts,c=e.config;for(i=a.length-1;i>=0;i--)n=a[i],!1!==(s=T(c[i],r))?(o=s-n.ticks,n.ticks=s,n.moveAllEvents(o),"new"!==n.state&&(n.state="changed")):b.warn("wrong position data, skipping part",n.id);t.needsUpdate=!0}}(P(arguments,this),this)},g.prototype.moveAllParts=function(e){this.moveParts({parts:this.parts,config:[e]})},g.prototype.copyPart=g.prototype.copyParts=function(){var e,t=P(arguments,this),i=[];if(!1!==t){if(0!==e.length)return(e=t.parts).forEach(function(e){i.push(e.copy())}),1===i.length?i[0]:i;b.error("no parts")}},g.prototype.removePart=function(){var e=I(P(arguments,this),this);return 1===e.length?e[0]:e},g.prototype.removeParts=function(){return I(P(arguments,this),this)},g.prototype.getPart=function(e){return S(e)},g.prototype.getParts=function(){var t,i,n=Array.prototype.slice.call(arguments),s=[];return(i=function(n,o){t=n[o],"array"===e(t)?i(t,0):s.push(S(t))})(n,0),s},g.prototype.getPartAt=g.prototype.getPartsAt=function(e){var t=T(e,this.song),i=this.parts,n=[];if(!1!==t)return i.forEach(function(e){e.ticks===t&&n.push(e)}),n;b.error("please provide position as array, for instance: ['barsandbeats',5,1,2,0]")},g.prototype.getPartFromTo=g.prototype.getPartsFromTo=function(e,t){var i=this.parts,n=[],s=T(e,this.song),o=T(t,this.song);if(!1!==s){if(!1!==o)return i.forEach(function(e){(s>=e.start.ticks&&s<=e.end.ticks||o>=e.start.ticks&&o<=e.end.ticks)&&n.push(e)}),n;b.error("invalid position data for from position")}else b.error("invalid position data for from position")},g.prototype.getPartBetween=g.prototype.getPartBetween=function(e,t){var i=this.parts,n=[],s=T(e,this.song),o=T(o,this.song);if(!1!==s&&!1!==o)return i.forEach(function(e){e.start.ticks>=s&&e.end.ticks<=o&&n.push(e)}),n;b.error("please provide position as array, for instance: ['barsandbeats',5,1,2,0]")},g.prototype.copy=function(){var e,i,n,s=new g(t(this.name)),o=this.parts,r=[];if(s.song=null,s.instrumentId=this.instrumentId,s.numEffects=this.numEffects,this.numEffects>0)for(i in s.effects={},this.effects)this.effects.hasOwnProperty(i)&&(n=this.effects[i],s.effects[n.id]=n.copy());for(i=o.length-1;i>=0;i--)e=o[i],r.push(e.copy());return s.addParts(r),s},g.prototype.removeEvent=g.prototype.removeEvents=function(){x(function(t,i){var n,s,o,r=0,a=0,c=(t=Array.prototype.slice.call(t))[0],u=[],l=[];if("array"===e(c)){for(a=c.length-1;a>=0;a--)(s=E(o=c[a],i))&&u.push(s);r=1}for(n=t.length,a=r;a<n;a++)(s=E(o=t[a],i))?u.push(s):l.push(o);return 0===u.length&&k>=2&&b.info("Please provide one or more events, or an array of events"),1===l.length&&"array"===e(l[0])&&(l=l[0]),{events:u,config:l}}(arguments,this).events,this)},g.prototype.removeEventsFromTo=function(e,t){b.warn("removeEventsFromTo() is temporarily disabled")},g.prototype.removeEventAt=g.prototype.removeEventsAt=function(e){b.warn("removeEventAt() is temporarily disabled")},g.prototype.removeAllEvents=function(){x(this.events,this)},g.prototype.transposePart=function(e,t){var i=e.getStats("noteNumber all"),n=0,s=127;this.song&&(n=this.song.lowestNote,s=this.song.highestNote),i.min+t<n?i.min:i.max+t>s?s=i.max:e.transposeAllEvents(t)},g.prototype.reset=function(){var e;for(e in this.song=null,this.audio&&this.audio.setSong(null),this.partsById)this.partsById.hasOwnProperty(e)&&this.partsById[e].reset(!1,!0);this.needsUpdate=!0},g.prototype.findEvent=function(e){return f(this,e)},g.prototype.findNote=function(e){return m(this,e)},g.prototype.getStats=function(e){return v(this,e)},g.prototype.update=function(){var e,t,i,n,s,o;for(t in this.parts=[],this.notes=[],this.events=[],this.partsById)if(this.partsById.hasOwnProperty(t)){if(!0===(i=this.partsById[t]).needsUpdate&&i.update(),0===i.events.length&&!1===i.keepWhenEmpty&&this.removePart(i),"new"===i.state&&void 0!==this.song)for(e=(s=i.events).length-1;e>=0;e--)(n=s[e]).song=this.song;"removed"!==i.state&&(this.parts.push(i),this.notes=this.notes.concat(i.notes),this.events=this.events.concat(i.events))}for(this.parts.sort(function(e,t){return e.ticks-t.ticks}),this.notes.sort(function(e,t){return e.ticks-t.ticks}),this.events.sort(function(e,t){return e.sortIndex-t.sortIndex}),this.numEvents=this.events.length,this.numNotes=this.notes.length,this.numParts=this.parts.length,e=this.numEvents-1;e>=0;e--)n=this.events[e],this.eventsById[n.id]=n;for(e=this.numNotes-1;e>=0;e--)o=this.notes[e],this.notesById[o.id]=o;this.needsUpdate=!1},g.prototype.getIndex=function(){var e,t=-1,i=this.song.tracks,n=i.length;if(n>0)for(e=0;e<n;e++)if(i[e].id===this.id){t=e;break}return t},g.prototype.addEffect=function(e,t){e&&(this.effects[e.id]=e,this.numEffects++,void 0!==this.lastEffect&&(this.lastEffect.disconnect(0),e.setInput(this.lastEffect)),e.output.connect(this.panner.node),this.lastEffect=e.output)},g.prototype.removeEffect=function(e){!1!==e&&(delete this.effects[e.id],this.numEffects--)},g.prototype.setEffectPosition=function(e,t){var i,n,s=this.numEffects-1;if(!(t<0||t>s))for(e.position=t,i=0;i<s-1;i++)(n=this.effects[i]).position>=t&&n!==e&&(n.position+=1)},g.prototype.setSolo=function(e){void 0===e&&(e=!this.solo),this.mute=!1,this.solo=e,this.song&&this.song.setTrackSolo(this,e)},g.prototype.setPartSolo=function(e,t){var i,n;for(i=this.numParts-1;i>=0;i--)n=this.parts[i],!0===t?n.mute=n===e?!t:t:!1===t&&(n.mute=!1),n.solo=n===e&&t},g.prototype.setVolume=function(e){isNaN(e)?y.debug>=1&&b.error("please pass a number"):e<0||e>1?y.debug>=1&&b.error("please pass a float between 0 and 1"):(this.volume=e,this.input.gain.value=this.volume)},g.prototype.getVolume=function(){return this.volume},g.prototype.setPanning=function(e){this.panner.setPosition(e)},g.prototype.connect=function(e){this.output.connect(e)},g.prototype.disconnect=function(e){this.output.disconnect(0)},g.prototype.setInstrument=function(e){""!==e&&void 0!==e&&!1!==e||(e=O(this));var t=a(e);!1===t&&(t=a(O(this))),t.track=this,this.instrument&&this.instrument.allNotesOff(),this.instrument=t,this.instrumentId=t.name,this.song&&(this.instrument.song=this.song)},g.prototype.setMidiInput=function(e,t){var i,s,o=this.midiInputs;if(t=void 0===t||t,"all"===e)return s=void 0!==this.song?this.song.midiInputs:y.midiInputs,void n(s,function(e,i){!0===t?o[i]=e:delete o[i]});void 0!==(i=this.song.midiInputs[e])&&(t?this.midiInputs[e]=i:delete this.midiInputs[e])},g.prototype.setMidiOutput=function(e,t){t=void 0===t||t;var i=this.song.midiOutputs[e],s=this;void 0!==i&&(!0===t&&this.instrument.allNotesOff(),t?this.midiOutputs[e]=i:delete this.midiOutputs[e],this.routeToMidiOut=!1,n(this.midiOutputs,function(e,t){!1!==e&&(s.routeToMidiOut=!0)}))},g.prototype.prepareForRecording=function(e,t){"midi"!==this.recordEnabled&&"audio"!==this.recordEnabled||(this.recordPart=y.createPart(),this.addPart(this.recordPart),this.recordingNotes={},this.recordId=e,"audio"===this.recordEnabled&&(void 0===this.audio&&(this.audio=c(this)),this.audio.prepareForRecording(e,t)))},g.prototype.stopRecording=function(e,t){if(this.recordId===e)if(this.recordingNotes={},(this.autoQuantize||this.song.autoQuantize)&&(k>=1&&b.log("performing auto quantize"),this.quantizeRecording()),"midi"===this.recordEnabled)this.recordPart.update(),t(this.recordPart.events);else if("audio"===this.recordEnabled){var i=this;this.audio.stopRecording(function(e){var n=y.createAudioEvent({ticks:i.song.recordTimestampTicks,buffer:e.audioBuffer,sampleId:e.id});i.recordPart.addEvent(n),i.recordPart.update(),t([n])})}},g.prototype.undoRecording=function(t){var i=e(t);"string"===i?this.recordId===t&&this.removePart(this.recordPart):"array"===i&&this.removeEvents(t)},g.prototype.setWaveformConfig=function(e){this.waveformConfig=e,void 0!==this.audio&&(this.audio.recorder.waveformConfig=e)},g.prototype.getAudioRecordingData=function(e){if(void 0!==this.audio)return void 0===e?(y.debug>=y.WARN&&b.warn("please provide a recording id"),!1):y.storage.audio.recordings[e]},g.prototype.encodeAudioRecording=function(e,t,i,n){if(void 0!==this.audio){if(void 0===e)return y.debug>=y.WARN&&b.warn("please provide a recording id"),void(n&&n(!1));var s=y.storage.audio.recordings[e];p(s.audioBuffer,t,i,function(e){s.mp3=e,n(s)})}},g.prototype.setAudioRecordingLatency=function(e,t,i){void 0!==this.audio&&this.audio.setAudioRecordingLatency(e,t,function(t){var n,s,o,r=this.song.audioEvents;for(n=r.length-1;n>=0;n--)void 0!==(o=(s=r[n]).sampleId)&&e===o&&(s.buffer=t.audioBuffer);void 0!==i&&i()})},g.prototype.quantizeRecording=function(e){return e=e||this.quantizeValue,y.quantize(this.recordPart.events,e,this.song.ppq)},g.prototype.quantize=function(){var t,i,n,s,o=N.call(arguments),r=o.length;for(t=0;t<r;t++)i=o[t],"string"===(n=e(i))||"number"===n?s=i:"object"===n&&i;return void 0===s&&(s=this.quantizeValue),y.quantize(this.events,s,this.song.ppq,history)},g.prototype.undoQuantize=function(e){if(void 0!==e){var t,i,n=e.tracks[this.id].quantizedEvents,s=n.length;for(t=0;t<s;t++)(i=n[t]).ticks=e.events[i.id].ticks}else y.debug>=2&&b.warn("please pass a quantize history object")},g.prototype.addMidiEventListener=function(){return l(arguments,this)},g.prototype.removeMidiEventListener=function(e){d(e,this)},g.prototype.allNotesOff=function(e){this.audio&&this.audio.allNotesOff(),this.instrument&&this.instrument.allNotesOff()},g.prototype.processMidiEvent=function(e){h(e,this)},y.protectedScope.Track=g,y.createTrack=function(e,t,i){return new g(e,t,i)},y.protectedScope.addInitMethod(function(){var g=y.protectedScope;v=y.getStats,f=y.findEvent,m=y.findNote,y.createPart,o=y.createMidiEvent,y.createMidiNote,a=y.createInstrument,u=y.createPanner,p=y.encodeAudio,r=g.context,i=g.findItem,l=g.addMidiEventListener,d=g.removeMidiEventListener,c=y.protectedScope.createAudioTrack,s=g.checkPosition,n=g.objectForEach,e=g.typeString,t=g.copyName,h=g.handleMidiMessageTrack})}(),function(){var e,t,i,s=window.sequencer,o=window.console,r=Array.prototype.slice,a=Math.pow,c=Math.round,u=Math.floor,l=Math.random,d={1:"quarter",2:"eighth",4:"sixteenth",8:"32th",16:"64th"};function p(e){return"object"!=(void 0===e?"undefined":n(e))?void 0===e?"undefined":n(e):null===e?"null":Object.prototype.toString.call(e).match(/\[object\s(\w+)\]/)[1].toLowerCase()}function h(e,t){if(void 0===t||t<=0)return c(e);var i=a(10,t);return c(e*i)/i}function f(e,t){if(void 0===t||t<=0)return u(e);var i=a(10,t);return u(e*i)/i}function m(e,t){if(void 0===e)return!1;var i,n=!0;for(i in t=t||"",e)if(e.hasOwnProperty(i)&&-1===t.indexOf(i)){n=!1;break}return n}function v(e,t){var i,n=e;for(i in n)n.hasOwnProperty(i)&&t(n[i],i)}function g(e){var t,i,n=new XMLHttpRequest,s=void 0===e.method?"GET":e.method;if(i=new Promise(function(i,o){o=o||function(){},i=i||function(){},n.onload=function(){200===n.status?"json"===e.responseType?(t=n.response.length,i(JSON.parse(n.response),t)):i(n.response):o(n.status)},n.onerror=function(t){e.onError(t)},n.open(s,e.url,!0),e.overrideMimeType&&n.overrideMimeType(e.overrideMimeType),e.responseType&&("json"===e.responseType?n.responseType="text":n.responseType=e.responseType),"POST"===s&&n.setRequestHeader("Content-type","application/x-www-form-urlencoded"),e.data?n.send(e.data):n.send()}),void 0===e.onSuccess)return i;i.then(e.onSuccess,e.onError)}function y(e,t,i,n){var s,o;for(s in e)if(e.hasOwnProperty(s)){if("id"===s||"path"===s||"className"===s)continue;if(void 0===(o=e[s]))continue;"Folder"===o.className?!0===i&&y(o,t,i,n+"."):void 0===o.name?t.push({name:s,data:o}):t.push(o)}}function b(e,i,n){var s,o;for(s in e){if(!1!==t)return;if(e.hasOwnProperty(s)){if(p(o=e[s]),s===i){t=o;break}void 0!==o&&"Folder"===o.className&&b(o,i,n+=".")}}}function k(e,i,n){if(n=void 0!==n&&n,void 0===e||""===e)return i;var s,o,r,a,c,u;if(u=(o=P(e)).pop(),r=o.length,""===u)return i;if(t=!1,o.length>0){for(a=i,s=0;s<r&&void 0!==(a=a[o[s]]);s++);a&&(c=a[u])}return void 0===c&&(!0===n?c=i[u]:(b(i,u,"."),c=t)),void 0===c&&(c=!1),c}function N(t,i){return new Promise(function(n,s){try{e.decodeAudioData(i,function(e){n({id:t,buffer:e})},function(e){o.log("error decoding audiodata",t,e),n({id:t,buffer:void 0})})}catch(e){o.log("error decoding audiodata",t,e),n({id:t,buffer:void 0})}})}function w(e,t){return new Promise(function(i,n){g({url:t,responseType:"arraybuffer"}).then(function(t){N(e,t).then(i,n)},function(){i({id:e,buffer:void 0})})})}function S(e){var t,i,n,s,o;for(i=[],n=(t=e||"").length,s=String.fromCharCode,o=0;o<n;o++)i[o]=s(255&t.charCodeAt(o));return i.join("")}function E(e){var t,i,n,s,o,r,a,c,u,l,d,p,h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",f=0;for(t=Math.ceil(3*e.length/4),n=new ArrayBuffer(t),i=new Uint8Array(n),s=h.indexOf(e.charAt(e.length-1)),o=h.indexOf(e.charAt(e.length-1)),64==s&&t--,64==o&&t--,e=e.replace(/[^A-Za-z0-9\+\/\=]/g,""),p=0;p<t;p+=3)r=h.indexOf(e.charAt(f++))<<2|(u=h.indexOf(e.charAt(f++)))>>4,a=(15&u)<<4|(l=h.indexOf(e.charAt(f++)))>>2,c=(3&l)<<6|(d=h.indexOf(e.charAt(f++))),i[p]=r,64!=l&&(i[p+1]=a),64!=d&&(i[p+2]=c);return n}function P(e){return void 0===e?[]:e=(e=(e=(e=(e=e.replace(/undefined/g,"")).replace(/\/{2,}/g,"/")).replace(/^\//,"")).replace(/\/$/,"")).split("/")}function T(e,t,i){var n=l()*(t-e)+e;return!0===i?c(n):n}function A(e){return e>64&&e<91?e-65:e>96&&e<123?e-71:e>47&&e<58?e+4:43===e?62:47===e?63:0}function I(e){return e<26?e+65:e<52?e+71:e<62?e-4:62===e?43:63===e?47:65}s.protectedScope.addInitMethod(function(){e=s.protectedScope.context}),s.util.b64ToUint6=A,s.util.base64DecToArr=function(e,t){for(var i,n,s=e.replace(/[^A-Za-z0-9\+\/]/g,""),o=s.length,r=t?Math.ceil((3*o+1>>2)/t)*t:3*o+1>>2,a=new Uint8Array(r),c=0,u=0,l=0;l<o;l++)if(n=3&l,c|=A(s.charCodeAt(l))<<18-6*n,3===n||o-l==1){for(i=0;i<3&&u<r;i++,u++)a[u]=c>>>(16>>>i&24)&255;c=0}return a},s.util.uint6ToB64=I,s.util.base64EncArr=function(e){for(var t=2,i="",n=e.length,s=0,o=0;o<n;o++)t=o%3,o>0&&4*o/3%76==0&&(i+="\r\n"),s|=e[o]<<(16>>>t&24),2!==t&&e.length-o!=1||(i+=String.fromCharCode(I(s>>>18&63),I(s>>>12&63),I(s>>>6&63),I(63&s)),s=0);return i.substr(0,i.length-2+t)+(2===t?"":1===t?"=":"==")},s.util.UTF8ArrToStr=function(e){for(var t,i="",n=e.length,s=0;s<n;s++)t=e[s],i+=String.fromCharCode(t>251&&t<254&&s+5<n?1073741824*(t-252)+(e[++s]-128<<24)+(e[++s]-128<<18)+(e[++s]-128<<12)+(e[++s]-128<<6)+e[++s]-128:t>247&&t<252&&s+4<n?(t-248<<24)+(e[++s]-128<<18)+(e[++s]-128<<12)+(e[++s]-128<<6)+e[++s]-128:t>239&&t<248&&s+3<n?(t-240<<18)+(e[++s]-128<<12)+(e[++s]-128<<6)+e[++s]-128:t>223&&t<240&&s+2<n?(t-224<<12)+(e[++s]-128<<6)+e[++s]-128:t>191&&t<224&&s+1<n?(t-192<<6)+e[++s]-128:t);return i},s.util.strToUTF8Arr=function(e){for(var t,i,n=e.length,s=0,o=0;o<n;o++)s+=(i=e.charCodeAt(o))<128?1:i<2048?2:i<65536?3:i<2097152?4:i<67108864?5:6;t=new Uint8Array(s);for(var r=0,a=0;r<s;a++)(i=e.charCodeAt(a))<128?t[r++]=i:i<2048?(t[r++]=192+(i>>>6),t[r++]=128+(63&i)):i<65536?(t[r++]=224+(i>>>12),t[r++]=128+(i>>>6&63),t[r++]=128+(63&i)):i<2097152?(t[r++]=240+(i>>>18),t[r++]=128+(i>>>12&63),t[r++]=128+(i>>>6&63),t[r++]=128+(63&i)):i<67108864?(t[r++]=248+(i>>>24),t[r++]=128+(i>>>18&63),t[r++]=128+(i>>>12&63),t[r++]=128+(i>>>6&63),t[r++]=128+(63&i)):(t[r++]=252+(i>>>30),t[r++]=128+(i>>>24&63),t[r++]=128+(i>>>18&63),t[r++]=128+(i>>>12&63),t[r++]=128+(i>>>6&63),t[r++]=128+(63&i));return t},s.util.ajax=g,s.util.ajax2=function(e){var t,i=new XMLHttpRequest,n=void 0===e.method?"GET":e.method;i.onreadystatechange=function(){404===i.request&&e.onError(404)},i.onload=function(){200===i.status?"json"===e.responseType?(t=i.response.length,e.onSuccess(JSON.parse(i.response),t)):e.onSuccess(i.response):e.onError(i.status)},i.onerror=function(t){e.onError(t)},i.open(n,e.url,!0),e.overrideMimeType&&i.overrideMimeType(e.overrideMimeType),e.responseType&&("json"===e.responseType?i.responseType="text":i.responseType=e.responseType),"POST"===n&&i.setRequestHeader("Content-type","application/x-www-form-urlencoded"),e.data?i.send(e.data):i.send()},s.util.parseSamples=function(e){var t,i,n=[];for(t in e)e.hasOwnProperty(t)&&(-1===(i=e[t]).indexOf("http://")?n.push(N(t,E(i))):n.push(w(t,i)));return new Promise(function(e,t){Promise.all(n).then(function(t){var i={};t.forEach(function(e){i[e.id]=e.buffer}),e(i)},function(e){t(e)})})},s.util.round=h,s.util.floor=f,s.util.remap=function(e,t,i,n,s){return(e-t)*(s-n)/(i-t)+n},s.util.getRandom=T,s.util.createSlider=function(e){var t,i=e.slider,n=e.message,s=e.label;function o(n){var s=i.valueAsNumber;e.onMouseDown&&e.onMouseDown(s,n),t.onMouseDown&&t.onMouseDown(s,n)}function r(n){var s=i.valueAsNumber;e.onMouseUp&&e.onMouseUp(s,n),t.onMouseUp&&t.onMouseUp(s,n)}function a(n){var s=i.valueAsNumber;e.onMouseMove&&e.onMouseMove(s,n),t.onMouseMove&&t.onMouseMove(s,n)}return void 0===e.label&&(s=i.parentNode.firstChild),void 0!==e.initialSliderValue&&(i.value=e.initialSliderValue),void 0!==e.initialLabelValue&&(s.innerHTML=n.replace("{value}",e.initialLabelValue)),void 0!==e.min&&(i.min=e.min),void 0!==e.max&&(i.max=e.max),void 0!==e.step&&(i.step=e.step),i.addEventListener("mousedown",function(e){setTimeout(o,0,e),i.addEventListener("mousemove",a,!1)},!1),i.addEventListener("mouseup",function(e){setTimeout(r,0,e),i.removeEventListener("mousemove",a,!1)},!1),i.addEventListener("change",function(n){!function(n){var s=i.valueAsNumber;e.onChange&&e.onChange(s,n),t.onChange&&t.onChange(s,n)}(n)},!1),(t={getValue:function(){return e.getValue?e.getValue(i.valueAsNumber):i.valueAsNumber},setValue:function(t){e.setValue?i.value=e.setValue(t):i.value=t},setLabel:function(e){s.innerHTML=n.replace("{value}",e)},elem:i,element:i}).set=function(e){setLabel(e),setValue(e)},t},s.util.createSlider2=function(e){var t=e.slider,i=e.message,n=t.parentNode.firstChild;function s(){var s=a();void 0!==e.onMouseMove&&e.onMouseMove(t.valueAsNumber,s),n.innerHTML=i.replace("{value}",s)}function o(){var s=a();void 0!==e.onMouseUp&&e.onMouseUp(t.valueAsNumber,s),n.innerHTML=i.replace("{value}",s)}function r(){var s=a();void 0!==e.onMouseDown&&e.onMouseDown(t.valueAsNumber,s),n.innerHTML=i.replace("{value}",s)}function a(){var i=t.valueAsNumber;return void 0!==e.calculate&&(i=e.calculate(i)),i}function c(t){return void 0!==e.calculateFromLabel&&(t=e.calculateFromLabel(t)),t}return e.initialValueSlider&&(t.value=e.initialValueSlider,n.innerHTML=i.replace("{value}",a())),e.initialValueLabel&&(n.innerHTML=i.replace("{value}",e.initialValueLabel),t.value=c(e.initialValueLabel)),t.addEventListener("mousedown",function(){setTimeout(r,0),t.addEventListener("mousemove",s,!1)},!1),t.addEventListener("mouseup",function(){setTimeout(o,0),t.removeEventListener("mousemove",s,!1)},!1),{updateSlider:function(e){t.value=e,n.innerHTML=i.replace("{value}",a())},updateLabel:function(e){n.innerHTML=i.replace("{value}",e),t.value=c(e)},getValue1:function(){return t.valueAsNumber},getValue2:function(){return a(t.valueAsNumber)}}},s.util.getRandomNotes=function(e){var t,i,n,o,r,a,c,u,l,d,p,h=0,f=[];for(p=(e=e||{}).ppq||s.defaultPPQ,o=e.numNotes||20,a=e.noteLength||p/2,c=e.minVelocity||30,u=e.maxVelocity||127,l=e.minNoteNumber||60,d=e.maxNoteNumber||127,a>p&&(a=p),t=0;t<o;t++)r=T(l,d,!0),n=T(c,u,!0),i=s.createMidiEvent(h,s.NOTE_ON,r,n),f.push(i),h+=a,i=s.createMidiEvent(h,s.NOTE_OFF,r,0),f.push(i),h+=p-a;return f},s.util.getEqualPowerCurve=function(e,t,i){var n,s,o,r=new Float32Array(e);for(n=0;n<e;n++)o=n/e,"fadeIn"===t?s=Math.cos(.5*(1-o)*Math.PI)*i:"fadeOut"===t&&(s=Math.cos(.5*o*Math.PI)*i),r[n]=s,n===e-1&&(r[n]="fadeIn"===t?1:0);return r},s.util.objectForEach=v,s.util.insertLink=function(e){var t,i=e.indexOf("http://");return-1!==i&&-1!==(i=(t=e.substring(i)).indexOf(" "))&&(t=t.substring(0,i)),'<a href="'+t+'"></a>'},s.util.encode64=function(e){for(var t="",i=new Uint8Array(e),n=i.byteLength,s=0;s<n;s++)t+=String.fromCharCode(i[s]);return window.btoa(t)},s.protectedScope.getNoteLengthName=function(e,t){for(var i in d)if(d.hasOwnProperty(i)&&t===e.ppq/i)return d[i];return!1},s.protectedScope.toBinaryString=S,s.protectedScope.base64ToBinary=E,s.protectedScope.toUint8Array=function(e){var t,i,n,s,o;for(n=(t=e||"").length,i=new Uint8Array(n),s=String.fromCharCode,o=0;o<n;o++)i[o]=s(255&t.charCodeAt(o));return i},s.protectedScope.getArguments=function(e){var t,i,n=[];return e=r.call(e),(t=function(e,s,o){for(s=0;s<o;s++)"array"===p(i=e[s])?t(i,0,i.length):n.push(i)})(e,0,e.length),n},s.protectedScope.pathToArray=P,s.protectedScope.parseUrl=function(e){var t,i,n,s="",o=e,r="";return-1!==(t=(e=(e=(e=e.replace(/\/{2,}/g,"/")).replace(/^\//,"")).replace(/\/$/,"")).lastIndexOf("/"))&&(o=e.substring(t+1),s=e.substring(0,t)),-1!==(i=e.lastIndexOf("."))&&(n=e.substring(i+1)).length>=3&&n.length<=4&&(r=n,o=e.substring(t+1,i)),{path:s,name:o,ext:r}},s.protectedScope.loadLoop=function e(t,i,n,s,o){0!==i?n[t].load(function(){o&&o(arguments),++t<i?e(t,i,n,s,o):s&&s()}):s&&s()},s.protectedScope.findItem=k,s.protectedScope.storeItem=function(e,t,i){var n,s,o,r,a,c="";for(o=(s=P(t)).length,r=i,a=0;a<o;a++){if(c+="/"+(n=s[a]),void 0===r[n]&&(r[n]={path:c,className:"Folder"}),a===o-1){r[n]=e;break}r=r[n]}},s.protectedScope.deleteItem=function(e,t){var i,n,s,o=t;if(!(i=k(e,t,!0)))return!1;if("Folder"===i.className)for(s in i)i.hasOwnProperty(s)&&"className"!==s&&delete i[s];for(e=P(e);e.length>1;){for(s=0,o=t;s<e.length-1;)o=o[e[s++]];"Folder"===(i=o[n=e[s]]).className?m(i,"path className")&&delete o[n]:delete o[n],e.pop()}return 1===e.length&&""!==e[0]&&("Folder"===(i=t[n=e[0]]).className?m(t[n],"path className")&&delete t[n]:delete t[n]),!0},s.protectedScope.toBinaryString=S,s.protectedScope.ajax=g,s.protectedScope.copyObject=function(e){var t,i={};if("object"!==p(e))return{};for(t in e)e.hasOwnProperty(t)&&(i[t]=e[t]);return i},s.protectedScope.findItemsInFolder=function(e,t,n){n=void 0===n||n;var s,o,r=P(e),a=r.length,c=r[a-1],u=[];if(0===a)y(t,u,n,".");else{for(s=t,o=0;o<a&&void 0!==(s=s[r[o]]);o++);s?y(s,u,n,"."):(i=!1,function e(t,n,s){var o,r;for(o in t){if(!1!==i)return;if(t.hasOwnProperty(o)&&void 0!==(r=t[o])&&"Folder"===r.className){if(o===n)return void(i=r);e(r,n,s+".")}}}(t,c,"."),y(i,u,n,"."))}return u.sort(function(e,t){var i=e.name.toLowerCase(),n=t.name.toLowerCase();return i<n?-1:i>n?1:0}),u},s.convertPPQ=function(){var e,t,i=r.call(arguments),n=i[0],a=i[1],c=a/n;function u(i){for(e=i.length-1;e>=0;e--)(t=i[e]).ticks=c*t.ticks,"new"!==t.state&&(t.state="changed")}isNaN(n)||isNaN(a)?4===s.debug&&o.error("PPQ values must be numbers"):function(e,t,i){var n,s,o,r,a;for(r=t;r<i;r++)if("array"===(s=p(n=e[r])))u(n);else if("object"===s)if("Part"===n.className||"Track"===n.className||"Song"===n.className)u(n.events);else if("MidiFile"===n.className)for(a=n.numTracks-1;a>=0;a--)!0===(o=n.tracks[a]).needsUpdate&&(o.update(),o.events&&u(o.events))}(i,2,i.length)},s.getNiceTime=function(e){var t,i,n,s,o,r="";return s=h(1e3*((o=e/1e3)-3600*(t=f(o/3600))-60*(i=f(o%3600/60))-(n=f(o%60)))),r+=t+":",r+=i<10?"0"+i:i,r+=":",r+=n<10?"0"+n:n,r+=":",{hour:t,minute:i,second:n,millisecond:s,timeAsString:r+=0===s?"000":s<10?"00"+s:s<100?"0"+s:s,timeAsArray:[t,i,n,s]}},s.protectedScope.isEmptyObject=m,s.protectedScope.objectForEach=v,s.protectedScope.objectToArray=function(e){var t,i=[];for(t in e)e.hasOwnProperty(t)&&i.push(e[t]);return i},s.protectedScope.arrayToObject=function(e,t){var i,n={};for(i=e.length-1;i>=0;i--)n[e[i][t]]=e[i];return n},s.protectedScope.createClass=function(e,t){var i;return(i=function(){this.parent=e,arguments.length>0&&(e.apply(this,arguments),void 0!==t&&t.apply(this,arguments))}).prototype=Object.create(e.prototype),i},s.protectedScope.clone=function e(t){var i,s;if(null===t||"object"!==(void 0===t?"undefined":n(t)))return t;for(i in s=t.constructor(),t)t.hasOwnProperty(i)&&(s[i]=e(t[i]));return s},s.protectedScope.round=h,s.protectedScope.floor=f,s.protectedScope.typeString=p,s.protectedScope.copyName=function(e){var t,i=e.indexOf("_copy");return-1===i?e+"_copy":""===(t=e.substring(i+5))?e+"2":e.slice(0,-1)+(parseInt(t,10)+1)},s.protectedScope.removeFromArray=function(e,t){var i,n,s,o,r,a,c=[];for("array"!==p(e)&&(e=[e]),s=t.length,o=e.length,i=0;i<s;i++){for(a=t[i],r=!1,n=0;n<o;n++)if(a===e[n]){r=!0;break}!1===r&&c.push(a)}return c},s.protectedScope.removeFromArray2=function(e,t){var i,n,s=e.length,o=[];for(i=0;i<s;i++)!1===t(n=e[i])&&o.push(n);return o},s.protectedScope.filterItemsByClassName=function(e,t,i){var n,s;for(n in e)e.hasOwnProperty(n)&&((s=e[n]).className===t?i.push(s):"object"===p(s)&&b(s,t,i))},s.getMicrosecondsFromBPM=function(e){return h(6e7/e)},s.getWaveformData=function(e,t,i){var n,s,o,r,a,c,u=document.createElement("canvas"),l=u.getContext("2d"),d=e.getChannelData(0),p=(e.getChannelData(0),d.length),h=t.height||100,f=t.color||"#71DE71",m=t.bgcolor||"#000",v=h/2,g=t.sampleStep||50,y=0,b=0,k=[];for(void 0!==t.width?o=(s=t.width)/p:(o=t.density||1,s=1e3,r=p*t.density%s,a=Math.ceil(p*t.density/s),c=0),u.width=s,u.height=h,l.fillStyle=m,l.fillRect(0,0,s,h),l.beginPath(),l.strokeStyle=f,l.lineWidth=1,l.moveTo(0,v),n=0;n<p;n+=g)(y=(n-b)*o)>=s?(l.stroke(),k.push(u.toDataURL("image/png")),c++,u.width=c===a-1?r:s,l.beginPath(),l.strokeStyle=f,b=n,y=0,l.moveTo(y,v-d[n]*v)):l.lineTo(y,v-d[n]*v);y<s&&(l.stroke(),k.push(u.toDataURL("image/png"))),i(k)}}(),function(){var e=window.sequencer,t=window.console,i=(Math.floor,Math.round),n={1:4,"1.":6,"1..":7,"1...":7.5,"1T":2/3*4,2:2,"2.":3,"2..":3.5,"2...":3.75,"2T":2/3*2,4:1,"4.":1.5,"4..":1.75,"4...":1.875,"4T":2/3*1,8:.5,"8.":.75,"8..":.875,"8...":.9375,"8T":2/3*1/2,16:.25,"16.":.375,"16..":.4375,"16...":.46875,"16T":2/3*1/4,32:1/8,"32.":.1875,"32..":.21875,"32...":.234375,"32T":2/3*1/8,64:1/16,"64.":.09375,"64..":.109375,"64...":.1171875,"64T":2/3*1/16,128:1/32,"128.":1.5/32,"128..":1.75/32,"128...":1.875/32,"128T":2/3*1/32};e.protectedScope.addInitMethod(function(){e.protectedScope.copyObject}),e.quantize=function(s,o,r,a){var c;if(o=(o=""+o).toUpperCase(),r=r||e.defaultPPQ,0===o)return{};var u,l,d,p,h,f,m=a||{};if(void 0===m.events&&(m.events={}),void 0===m.tracks&&(m.tracks={}),void 0!==(f=-1!==o.indexOf("TICKS")?parseInt(o.replace(/TICKS/,""),10):n[o]*r)){for(u=s.length-1;u>=0;u--)l=s[u],m.events[l.id]={event:l,ticks:l.ticks},128!==l.type&&(d=l.ticks,h=(p=i(d/f)*f)-d,l.ticks=p,l.state="changed",l.part.needsUpdate=!0,l.track.needsUpdate=!0,c=l.track,void 0===m.tracks[c.id]&&(m.tracks[c.id]={track:c,quantizedEvents:[]}),m.tracks[c.id].quantizedEvents.push(l),void 0!==l.midiNote&&(l.midiNote.noteOff.ticks+=h,l.midiNote.noteOff.state="changed",l.midiNote.state="changed",m.tracks[c.id].quantizedEvents.push(l.midiNote.noteOff)));return m}e.debug&&t.warn("invalid quantize value")},e.fixedLength=function(e,t,i,n){}}(),function(){var e,t,i,n=window.sequencer,s=!1,o=[];function r(t,n,s){try{e.decodeAudioData(i(t),function(){window.sequencer[n]=!0,s()},function(){s()})}catch(e){s()}}n.protectedScope.callInitMethods(),e=n.protectedScope.context,t=n.protectedScope.initMidi,i=n.protectedScope.base64ToBinary,delete n.protectedScope,n.ready=function(e){!0===s?e():o.push(e)},n.addInstrument({name:"sinewave",folder:"heartbeat",autopan:!1,attack:200,keyrange:[21,108],release_duration:50}),n.addInstrument({name:"metronome",folder:"heartbeat",sample_path:"heartbeat/metronome",keyrange:[60,61],mapping:{60:{n:"lowtick"},61:{n:"hightick"}}}),n.addSamplePack({name:"metronome",folder:"heartbeat",mapping:{hightick:"UklGRkQFAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YSAFAACx/xf/dADOACwBsP3p+6H+zAGoBOkCCwBX/EH5OvxlA4kJ2wcSArT9E/ut+HT2evUx98n6OAF5CCUMwQvfCOsJxAx0DSIMEAq9BiAB3vhz7mLkT9sR133YxN2s5QLv0vrUBnwRnxuQJeEsSDCiMd8yFS8aKFIhohUsCKj64u625OraA9HuyPnElcP+wxvJWtW25637VQ0jHPgnBTDDM1o0CzKLK+8hzhgFDOz8Se4J47DYVtG0z5fQq9LB12rfA+j99roHAhelIyMwIjdTOuU8mjwIOGoxhCb5E53/j+3k3/fTY8pTw4y/Tr+ew8DMvdsk8RcHRRkSKO4yGTkHPkU/rzzyNcgsrR94Dp/5r+Zs17zOncoDxhfE38WLyn/TeOMi9r0IRxlRKIQzyTlOPKo9yjmWMcokDRLc/Y7rudtdzu/D2L1Iu+27JcG3yYrVLujl+3UOZx1UK5Q0qzmNPDk8ZjeeMPojzhH+/jLtPd5m0hHLHsYIw5TEMMnA0jvj8fSOBiwXASZgMzM8dUBGQbI+rzjpKkIZygZT9QflcdaRyqXCz7+VwUPH784r3K7s+v0KDu8bvyeLMb43NjrhOIo0dSvQHi0PnP6i7ovg3NTxy4/Gf8X8yH/QBtvX55P2Ygb0FcUjsy4LNmI5ejiXM38r7iC8FJwHPvok7dDgQdaJzlTKIsoFzsrVkuA87d/6qAi7FQ0h9ClKMLEz3TOrMBcqYSD8E9AFd/dS6kTf6dbU0XnQv9IH2MXfZ+ln9DEAFwwdFy8giib6KawqeChgI/UbHBOTCZj/vvXe7InlFuDN3P3b0d1F4gzpifG2+u4D7Qw1FfwbnCD+IlgjWyHLHPMVog2mBL37qvP+7NvnYuTv4rvjfubN6k3wpPZ0/WkEOwtiEUsWcxm+Gl4aOhhiFDAPIwmbAtn7TPVy77zqcefr5YHmHull7enyfPmcAHgHew1REr8Vhhd/F+AV1RJ0DikJWQNc/ZP3efKd7hvs2ur46rHs5u8e9N/48/0hA/8HFgwuD04RSBIREqsQOg7mCssGMAJW/Xn4G/TK8Lbuzu0I7qTvnPJy9sX6bP84BLYIbAwdD84QYxG7EOcODAxwCFMEAQC9+7P3SvTX8XHw+u9R8KTxIvSo9+X7VQCUBJ0IMwziDj4QLhAGD9UMrgnTBZcBRv1v+Xv2UfS+8tfx+vES87z0+vb3+Zf9ZgEQBSEIUArWC8kM2QyzC5EJEAdvBHgBXP5n++r4Avd89Wj07fMw9D31Jvfp+Uj9xQD9A8QG5QhXClELrAsvC9wJ7gd6BWIC3v6O+7T4PPZN9EHzWvNf9Pz1Fvit+qL9rQCHAwEG/weCCZUKFwvDCnIJcAcQBWcCaf8Z/CD55vaB9dD0wPSP9UL3m/k7/Mz+JwEyAw8FzAY7CBsJaQk5CWkI2gatBCICYf+j/Fr6vfiV9872sfZP91z4p/lR+3H9zf89AroEFAfjCP0Jcwo8CjAJdQdgBSEDkgDQ/Vj7ZfnR95T28fUd9v32Vvg2+nb8+/6xAWoE4AbDCP4JpAqbCqQJ0weEBfgCTACT/R37M/m+9672IPY69gb3afhW+tT8qf+MAj0FggcuCScKXAriCcMIEAfyBJYCFwCP/Rz7A/l793z2F/Zn9mH37fjd+i39yf9pAt0EFAfRCNkJGAqrCZYIvgZPBJ8B6P4//M350vdz9q/1lfUq9mz3RPmi+3H+bgFVBOQG3wgHCkwK0Am7CCAHCgWmAjAA",lowtick:"UklGRlQFAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YTAFAAB0/5v+U/4T/3gA0wFTAuUB+f8d/nT90f1q/ub+tf46/mb/8wFQA9gC7wCd/mr+FAGRA3cE6wJf/h36evmv+8v/NwRHBZUC2/60+//5EvuZ/aX/bgFOAp8Azvzh9wfzLPF68zT4y/2BAygIfQwaEjYY0x31Irwl8SOWHVESOgPh9NfpReFt22nYHddD2BXcZeDa5InqgPDx9nP+6gS4CBYLnw0zES0WXxv4HkcgLh/1G+EX1RNpD4wKigXH/6r5/fNu7lTpj+Zu5hHoXOtL71byr/Qp91L64v6OBO4JoQ5zEskU+hU1FiQVeRP7EWgP4Qr0BIT+tPid9C3y1vCh8FDxJvK28vvyy/LA8pLzU/XP95v6xvw4/uD/RAK2BSkKcg6BEScTZBMeEqkPTQxjCKEEVwFi/nv7h/hp9aDyAvHP8MfxLvM+9PX0uPW19g/4Lfr7/C4AKgNaBXQGywb0BhIHWQfWB1oIzAjtCF8IHwdtBakDVwKLAeYA8v9w/kj81/nQ94v29/XX9bz1bPUY9Uz1Z/aH+Hr7yP4MAi4F+wcfCnYLNgyfDPsMSw0sDUAMfgrcB5IEMwFb/iX8T/pT+O/1X/Mf8cbvrO+18MLyvfVP+Rf9wgAoBCEHpwnIC5EN4Q5AD3wO1Ay0CpsIvwbvBNcCbQAr/nX8Ofsf+vb4mvda9rj1z/WX9pL3a/hH+ZX6R/wn/vP/eQESA/AE+wYDCcwKFAyPDCkMFQuSCe4HVQbSBHQDCwI8ANL9JPuY+HX28vTq82PzdPMV9Az1MfZ49zD5gftx/sQBBQXLB8cJ/gqpCw8MigwWDXENXQ2rDDUL7QgDBswCdv8S/K74WPVk8hXwou4P7mvu1+9T8pz1Uvli/ZoBwgWRCcsMPg/CEEQR4RDADwoO9wusCVMH4ARSApn/ufzd+Wj3bvX78xzzx/L68qzz1vSD9qX4Gfvd/c0AhwO/BWwHmghvCQEKVQonClsJCwiIBh0F0gOgAm0BOwAx/03+XP0g/Lb6cPmX+F/4vfh++TH6s/os+7/7cvwL/Zz9XP5O/3IA3AF9AzsF9gaUCAAKHgueCzcL9wntB3sF4wIzAI396fp1+Gv2IvWn9N30p/Xi9m74G/ru+9P9k/8aAYEC1AMTBSIG0wYuB1gHkgcACGEISAhTBzEFWAKt/5L92fuU+vX50fmf+SP5i/gb+Bf4mviv+Sr7kvyb/Uj+r/4X/8r/+gCiAo0EUAaRBzwISwjqB3IHGQfCBv8FpgTMApQAKf67+5n5/vfn9jz2yPVn9SL1RPXq9SP3Dvmr+6f+sQGKBAcH+whOCh0Laws3C28KLAmDB5AFfQNoAVP/Zv3e+7P6sfnL+Cv4vPeM95b37feV+Jn51Poq/LL9mv+YAVYD3gQuBmcHSAikCIEI7Af+BuEFngQXA1sBv/9v/pf9MP3W/Fj8q/sR+6H6U/o3+mP6y/pN+/f7xvye/WH+Jf9mAD4CQAQJBisHtgf6Bw0I8QdsB1sGywT4AggBCP/o/KX6mPg19572jfaz9uf2S/cM+E35E/tW/af/5wH1A8AFKgfkB/AHgwfxBlAGgQVIBMMCJwGs/43+vP0i/Zr8Lfzl+9H76fvi+9f75fsf/In8BP10/ej9cf4O/7f/dAAcAaUBEgKMAhgDpAMEBCEEDwTfA3IDxQL8ASoBUwCG/87+J/6h/Rr9pPxk/Gb8oPwJ/XH9w/39/UD+qP41/9D/WwDeAGsBAgKdAhEDQQNAA0sDbwOVA5YDVwPOAhgCVAGRAA=="}}),n.addTask({type:"test mp3",method:function(e){r("//sQxAADwAABpAAAACAAADSAAAAETEFNRTMuOTkuNVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVU=","mp3",e)},params:[]}),n.addTask({type:"test ogg",method:function(e){r("T2dnUwACAAAAAAAAAABdxd4XAAAAADaS0jQBHgF2b3JiaXMAAAAAAUSsAAAAAAAAgLsAAAAAAAC4AU9nZ1MAAAAAAAAAAAAAXcXeFwEAAAAaXK+QDz3/////////////////MgN2b3JiaXMtAAAAWGlwaC5PcmcgbGliVm9yYmlzIEkgMjAxMDExMDEgKFNjaGF1ZmVudWdnZXQpAAAAAAEFdm9yYmlzH0JDVgEAAAEAGGNUKUaZUtJKiRlzlDFGmWKSSomlhBZCSJ1zFFOpOdeca6y5tSCEEBpTUCkFmVKOUmkZY5ApBZlSEEtJJXQSOiedYxBbScHWmGuLQbYchA2aUkwpxJRSikIIGVOMKcWUUkpCByV0DjrmHFOOSihBuJxzq7WWlmOLqXSSSuckZExCSCmFkkoHpVNOQkg1ltZSKR1zUlJqQegghBBCtiCEDYLQkFUAAAEAwEAQGrIKAFAAABCKoRiKAoSGrAIAMgAABKAojuIojiM5kmNJFhAasgoAAAIAEAAAwHAUSZEUybEkS9IsS9NEUVV91TZVVfZ1Xdd1Xdd1IDRkFQAAAQBASKeZpRogwgxkGAgNWQUAIAAAAEYowhADQkNWAQAAAQAAYig5iCa05nxzjoNmOWgqxeZ0cCLV5kluKubmnHPOOSebc8Y455xzinJmMWgmtOaccxKDZiloJrTmnHOexOZBa6q05pxzxjmng3FGGOecc5q05kFqNtbmnHMWtKY5ai7F5pxzIuXmSW0u1eacc84555xzzjnnnHOqF6dzcE4455xzovbmWm5CF+eccz4Zp3tzQjjnnHPOOeecc84555xzgtCQVQAAEAAAQRg2hnGnIEifo4EYRYhpyKQH3aPDJGgMcgqpR6OjkVLqIJRUxkkpnSA0ZBUAAAgAACGEFFJIIYUUUkghhRRSiCGGGGLIKaecggoqqaSiijLKLLPMMssss8wy67CzzjrsMMQQQwyttBJLTbXVWGOtueecaw7SWmmttdZKKaWUUkopCA1ZBQCAAAAQCBlkkEFGIYUUUoghppxyyimooAJCQ1YBAIAAAAIAAAA8yXNER3RER3RER3RER3REx3M8R5RESZRESbRMy9RMTxVV1ZVdW9Zl3fZtYRd23fd13/d149eFYVmWZVmWZVmWZVmWZVmWZVmC0JBVAAAIAACAEEIIIYUUUkghpRhjzDHnoJNQQiA0ZBUAAAgAIAAAAMBRHMVxJEdyJMmSLEmTNEuzPM3TPE30RFEUTdNURVd0Rd20RdmUTdd0Tdl0VVm1XVm2bdnWbV+Wbd/3fd/3fd/3fd/3fd/3dR0IDVkFAEgAAOhIjqRIiqRIjuM4kiQBoSGrAAAZAAABACiKoziO40iSJEmWpEme5VmiZmqmZ3qqqAKhIasAAEAAAAEAAAAAACia4imm4imi4jmiI0qiZVqipmquKJuy67qu67qu67qu67qu67qu67qu67qu67qu67qu67qu67qu67ouEBqyCgCQAADQkRzJkRxJkRRJkRzJAUJDVgEAMgAAAgBwDMeQFMmxLEvTPM3TPE30RE/0TE8VXdEFQkNWAQCAAAACAAAAAAAwJMNSLEdzNEmUVEu1VE21VEsVVU9VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVU1TdM0TSA0ZCUAAAQAwGKNweUgISUl5d4QwhCTnjEmIbVeIQSRkt4xBhWDnjKiDHLeQuMQgx4IDVkRAEQBAADGIMcQc8g5R6mTEjnnqHSUGuccpY5SZynFmGLNKJXYUqyNc45SR62jlGIsLXaUUo2pxgIAAAIcAAACLIRCQ1YEAFEAAIQxSCmkFGKMOaecQ4wp55hzhjHmHHOOOeegdFIq55x0TkrEGHOOOaecc1I6J5VzTkonoQAAgAAHAIAAC6HQkBUBQJwAgEGSPE/yNFGUNE8URVN0XVE0XdfyPNX0TFNVPdFUVVNVbdlUVVmWPM80PdNUVc80VdVUVVk2VVWWRVXVbdN1ddt0Vd2Wbdv3XVsWdlFVbd1UXds3Vdf2Xdn2fVnWdWPyPFX1TNN1PdN0ZdV1bVt1XV33TFOWTdeVZdN1bduVZV13Zdn3NdN0XdNVZdl0Xdl2ZVe3XVn2fdN1hd+VZV9XZVkYdl33hVvXleV0Xd1XZVc3Vln2fVvXheHWdWGZPE9VPdN0Xc80XVd1XV9XXdfWNdOUZdN1bdlUXVl2Zdn3XVfWdc80Zdl0Xds2XVeWXVn2fVeWdd10XV9XZVn4VVf2dVnXleHWbeE3Xdf3VVn2hVeWdeHWdWG5dV0YPlX1fVN2heF0Zd/Xhd9Zbl04ltF1fWGVbeFYZVk5fuFYlt33lWV0XV9YbdkYVlkWhl/4neX2feN4dV0Zbt3nzLrvDMfvpPvK09VtY5l93VlmX3eO4Rg6v/Djqaqvm64rDKcsC7/t68az+76yjK7r+6osC78q28Kx677z/L6wLKPs+sJqy8Kw2rYx3L5uLL9wHMtr68ox675RtnV8X3gKw/N0dV15Zl3H9nV040c4fsoAAIABBwCAABPKQKEhKwKAOAEAjySJomRZoihZliiKpui6omi6rqRppqlpnmlammeapmmqsimarixpmmlanmaamqeZpmiarmuapqyKpinLpmrKsmmasuy6sm27rmzbomnKsmmasmyapiy7sqvbruzquqRZpql5nmlqnmeapmrKsmmarqt5nmp6nmiqniiqqmqqqq2qqixbnmeamuippieKqmqqpq2aqirLpqrasmmqtmyqqm27quz6sm3rummqsm2qpi2bqmrbruzqsizbui9pmmlqnmeamueZpmmasmyaqitbnqeaniiqquaJpmqqqiybpqrKlueZqieKquqJnmuaqirLpmraqmmatmyqqi2bpirLrm37vuvKsm6qqmybqmrrpmrKsmzLvu/Kqu6KpinLpqrasmmqsi3bsu/Lsqz7omnKsmmqsm2qqi7Lsm0bs2z7umiasm2qpi2bqirbsi37uizbuu/Krm+rqqzrsi37uu76rnDrujC8smz7qqz6uivbum/rMtv2fUTTlGVTNW3bVFVZdmXZ9mXb9n3RNG1bVVVbNk3VtmVZ9n1Ztm1hNE3ZNlVV1k3VtG1Zlm1htmXhdmXZt2Vb9nXXlXVf133j12Xd5rqy7cuyrfuqq/q27vvCcOuu8AoAABhwAAAIMKEMFBqyEgCIAgAAjGGMMQiNUs45B6FRyjnnIGTOQQghlcw5CCGUkjkHoZSUMucglJJSCKGUlFoLIZSUUmsFAAAUOAAABNigKbE4QKEhKwGAVAAAg+NYlueZomrasmNJnieKqqmqtu1IlueJommqqm1bnieKpqmqruvrmueJommqquvqumiapqmqruu6ui6aoqmqquu6sq6bpqqqriu7suzrpqqqquvKriz7wqq6rivLsm3rwrCqruvKsmzbtm/cuq7rvu/7wpGt67ou/MIxDEcBAOAJDgBABTasjnBSNBZYaMhKACADAIAwBiGDEEIGIYSQUkohpZQSAAAw4AAAEGBCGSg0ZEUAECcAABhDKaSUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJIKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKqaSUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKZVSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUgoAkIpwAJB6MKEMFBqyEgBIBQAAjFFKKcacgxAx5hhj0EkoKWLMOcYclJJS5RyEEFJpLbfKOQghpNRSbZlzUlqLMeYYM+ekpBRbzTmHUlKLseaaa+6ktFZrrjXnWlqrNdecc825tBZrrjnXnHPLMdecc8455xhzzjnnnHPOBQDgNDgAgB7YsDrCSdFYYKEhKwGAVAAAAhmlGHPOOegQUow55xyEECKFGHPOOQghVIw55xx0EEKoGHPMOQghhJA55xyEEEIIIXMOOugghBBCBx2EEEIIoZTOQQghhBBKKCGEEEIIIYQQOgghhBBCCCGEEEIIIYRSSgghhBBCCaGUUAAAYIEDAECADasjnBSNBRYashIAAAIAgByWoFLOhEGOQY8NQcpRMw1CTDnRmWJOajMVU5A5EJ10EhlqQdleMgsAAIAgACDABBAYICj4QgiIMQAAQYjMEAmFVbDAoAwaHOYBwANEhEQAkJigSLu4gC4DXNDFXQdCCEIQglgcQAEJODjhhife8IQbnKBTVOogAAAAAAAMAOABAOCgACIimquwuMDI0Njg6PAIAAAAAAAWAPgAADg+gIiI5iosLjAyNDY4OjwCAAAAAAAAAACAgIAAAAAAAEAAAACAgE9nZ1MABAEAAAAAAAAAXcXeFwIAAABq2npxAgEBAAo=","ogg",e)},params:[]}),n.addTask({type:"init midi",method:t,params:[]},function(){if(o.forEach(function(e){e()}),n.debug>=4){var e="sequencer ready, support for:";!0===n.ogg&&(e+=" ogg"),!0===n.mp3&&(e+=" mp3"),console.log(e)}s=!0},!1)}()}]);